<div id="pf8f" class="pf w0 h0" data-page-no="8f"><div class="pc pc8f w0 h0"><img class="bi x17 y17b8 w2 he8" alt="" src="bg8f.png"/><div class="t m0 x17 h7 y147 ff3 fs4 fc0 sc0 ls0 ws0">CHAPTER<span class="_ _2"> </span>11.<span class="_ _19"> </span>SOFTW<span class="_ _23"></span>ARE<span class="_ _2"> </span>INTERRUPTS<span class="_ _5"> </span>AND<span class="_ _2"> </span>EXCEPTIONS</div><div class="t m0 x12d h7 y2c7 ff5 fs4 fc0 sc0 ls0 ws0">mcause<span class="_ _2"> </span><span class="ff3">ﬁelds</span></div><div class="t m0 x6f h7 y2c6 ff3 fs4 fc0 sc0 ls0 ws0">Cause</div><div class="t m0 x46 h7 y2c8 ff3 fs4 fc0 sc0 ls0 ws0">INTERR<span class="_ _1"></span>UPT<span class="_ _68"> </span>EXCCODE</div><div class="t m0 xbe h7 y2c9 ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>0<span class="_ _df"> </span>User<span class="_ _2"> </span>soft<span class="_ _1"></span>w<span class="_ _1"></span>are<span class="_ _2"> </span>in<span class="_ _1"></span>terrupt</div><div class="t m0 xbe h7 y2cb ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>1<span class="_ _38"> </span>Supervisor<span class="_ _2"> </span>softw<span class="_ _8"></span>are<span class="_ _2"> </span>interrupt</div><div class="t m0 xbe h7 y2cd ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>2<span class="_ _5f"> </span>Reserv<span class="_ _1"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>future<span class="_ _2"> </span>standard<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y2cf ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>3<span class="_ _33"> </span>Machine<span class="_ _5"> </span>softw<span class="_ _8"></span>are<span class="_ _2"> </span>interrupt</div><div class="t m0 xbe h7 y17b9 ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>4<span class="_ _e0"> </span>User<span class="_ _2"> </span>timer<span class="_ _2"> </span>in<span class="_ _1"></span>terrupt</div><div class="t m0 xbe h7 y17ba ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>5<span class="_ _66"> </span>Sup<span class="_ _4"></span>ervisor<span class="_ _5"> </span>timer<span class="_ _2"> </span>interrupt</div><div class="t m0 xbe h7 y17bb ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>6<span class="_ _5f"> </span>Reserv<span class="_ _1"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>future<span class="_ _2"> </span>standard<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17bc ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>7<span class="_ _45"> </span>Machine<span class="_ _5"> </span>timer<span class="_ _2"> </span>interrupt</div><div class="t m0 xbe h7 y17bd ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>8<span class="_ _48"> </span>User<span class="_ _5"> </span>external<span class="_ _2"> </span>interrupt</div><div class="t m0 xbe h7 y17be ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _90"> </span>9<span class="_ _3f"> </span>Sup<span class="_ _4"></span>ervisor<span class="_ _2"> </span>external<span class="_ _2"> </span>in<span class="_ _8"></span>terrupt</div><div class="t m0 xbe h7 y17bf ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _e1"> </span>10<span class="_ _3e"> </span>Reserv<span class="_ _8"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>future<span class="_ _2"> </span>standard<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17c0 ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _e1"> </span>11<span class="_ _e2"> </span>Mac<span class="_ _1"></span>hine<span class="_ _2"> </span>external<span class="_ _2"> </span>in<span class="_ _1"></span>terrupt</div><div class="t m0 xbe h7 y17c1 ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _45"> </span>12-15<span class="_ _86"> </span>Reserv<span class="_ _8"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>future<span class="_ _2"> </span>standard<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17c2 ff3 fs4 fc0 sc0 ls0 ws0">1<span class="_ _46"> </span><span class="ff4">≥<span class="_ _2"> </span></span>16<span class="_ _e3"> </span>Reserv<span class="_ _1"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>platform<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17c3 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>0<span class="_ _e4"> </span>Instruction<span class="_ _2"> </span>address<span class="_ _2"> </span>misaligned</div><div class="t m0 xbe h7 y17c4 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>1<span class="_ _df"> </span>Instruction<span class="_ _2"> </span>access<span class="_ _2"> </span>fault</div><div class="t m0 xbe h7 y17c5 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>2<span class="_ _91"> </span>Illegal<span class="_ _2"> </span>instruction</div><div class="t m0 xbe h7 y109 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>3<span class="_ _e5"> </span>Breakp<span class="_ _4"></span>oin<span class="_ _8"></span>t</div><div class="t m0 xbe h7 y17c6 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>4<span class="_ _e6"> </span>Load<span class="_ _2"> </span>address<span class="_ _2"> </span>misaligned</div><div class="t m0 xbe h7 y17c7 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>5<span class="_ _e7"> </span>Load<span class="_ _2"> </span>access<span class="_ _2"> </span>fault</div><div class="t m0 xbe h7 y17c8 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>6<span class="_ _a0"> </span>Store/AMO<span class="_ _2"> </span>address<span class="_ _2"> </span>misaligned</div><div class="t m0 xbe h7 y17c9 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>7<span class="_ _8d"> </span>Store/AMO<span class="_ _5"> </span>access<span class="_ _2"> </span>fault</div><div class="t m0 xbe h7 y17ca ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>8<span class="_ _49"> </span>En<span class="_ _8"></span>vironment<span class="_ _5"> </span>call<span class="_ _2"> </span>from<span class="_ _2"> </span>U-mo<span class="_ _4"></span>de</div><div class="t m0 xbe h7 y17cb ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _90"> </span>9<span class="_ _a0"> </span>Environmen<span class="_ _8"></span>t<span class="_ _2"> </span>call<span class="_ _2"> </span>from<span class="_ _2"> </span>S-mo<span class="_ _4"></span>de</div><div class="t m0 xbe h7 y17cc ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _e1"> </span>10<span class="_ _e8"> </span>Reserv<span class="_ _1"></span>ed</div><div class="t m0 xbe h7 y17cd ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _e1"> </span>11<span class="_ _5f"> </span>Environmen<span class="_ _8"></span>t<span class="_ _2"> </span>call<span class="_ _2"> </span>from<span class="_ _2"> </span>M-mo<span class="_ _4"></span>de</div><div class="t m0 xbe h7 y17ce ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _e1"> </span>12<span class="_ _e9"> </span>Instruction<span class="_ _2"> </span>page<span class="_ _2"> </span>fault</div><div class="t m0 xbe h7 y17cf ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _e1"> </span>13<span class="_ _a6"> </span>Load<span class="_ _2"> </span>page<span class="_ _2"> </span>fault</div><div class="t m0 xbe h7 y17d0 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _e1"> </span>14<span class="_ _3e"> </span>Reserv<span class="_ _8"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>future<span class="_ _2"> </span>standard<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17d1 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _e1"> </span>15<span class="_ _42"> </span>Store/AMO<span class="_ _2"> </span>page<span class="_ _2"> </span>fault</div><div class="t m0 xbe h7 y17d2 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _45"> </span>16-23<span class="_ _86"> </span>Reserv<span class="_ _8"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>future<span class="_ _2"> </span>standard<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17d3 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _45"> </span>24-31<span class="_ _3f"> </span>Reserv<span class="_ _1"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>custom<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17d4 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _45"> </span>32-47<span class="_ _86"> </span>Reserv<span class="_ _8"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>future<span class="_ _2"> </span>standard<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17d5 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _45"> </span>48-63<span class="_ _3f"> </span>Reserv<span class="_ _1"></span>ed<span class="_ _2"> </span>for<span class="_ _2"> </span>custom<span class="_ _2"> </span>use</div><div class="t m0 xbe h7 y17d6 ff3 fs4 fc0 sc0 ls0 ws0">0<span class="_ _48"> </span><span class="ff4">≥</span>64<span class="_ _74"> </span>Reserved<span class="_ _5"> </span>for<span class="_ _2"> </span>future<span class="_ _2"> </span>standard<span class="_ _2"> </span>use</div><div class="t m0 x17 h7 y17d7 ff3 fs4 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>able 11.1:<span class="_ _a"> </span>Sources<span class="_ _5"> </span>of interrupts and<span class="_ _5"> </span>exceptions<span class="_ _5"> </span>and<span class="_ _5"> </span>their<span class="_ _5"> </span>co<span class="_ _4"></span>des on<span class="_ _5"> </span>the<span class="_ _5"> </span><span class="ff5">mcause<span class="_ _5"> </span></span>CSR.</div><div class="t m0 x17 hd y17d8 ff7 fs3 fc0 sc0 ls0 ws0">11.5<span class="_ _32"> </span>Protecting<span class="_ _31"> </span>RISC-V<span class="_ _31"> </span>systems</div><div class="t m0 x17 h7 y17d9 ff3 fs4 fc0 sc0 ls0 ws0">The following sections<span class="_ _5"> </span>discuss<span class="_ _5"> </span>how to use<span class="_ _5"> </span>the<span class="_ _5"> </span>RISC-V<span class="_ _5"> </span>privilege mo<span class="_ _4"></span>des and<span class="_ _5"> </span>the<span class="_ _5"> </span>excep-</div><div class="t m0 x17 h7 y17da ff3 fs4 fc0 sc0 ls0 ws0">tion<span class="_ _b"> </span>and<span class="_ _b"> </span>soft<span class="_ _1"></span>w<span class="_ _1"></span>are<span class="_ _b"> </span>interrupt<span class="_ _b"> </span>handling<span class="_ _b"> </span>mec<span class="_ _8"></span>hanisms<span class="_ _b"> </span>to<span class="_ _b"> </span>protect<span class="_ _b"> </span>the<span class="_ _b"> </span>system<span class="_ _b"> </span>from<span class="_ _b"> </span>faulty</div><div class="t m0 x17 h7 y17db ff3 fs4 fc0 sc0 ls0 ws0">or<span class="_ _2"> </span>malicious<span class="_ _2"> </span>user<span class="_ _2"> </span>soft<span class="_ _1"></span>w<span class="_ _1"></span>are.</div><div class="t m0 x17 ha y17dc ff7 fs6 fc0 sc0 ls0 ws0">11.5.1<span class="_ _e"> </span>Changing<span class="_ _a"> </span>the<span class="_ _a"> </span>privilege<span class="_ _a"> </span>mo<span class="_ _4"></span>de</div><div class="t m0 x17 h7 y41 ff3 fs4 fc0 sc0 ls0 ws0">RISC-V<span class="_ _3"> </span>CPUs<span class="_ _3"> </span>store<span class="_ _a"> </span>the<span class="_ _3"> </span>current<span class="_ _b"> </span>privilege<span class="_ _a"> </span>mo<span class="_ _4"></span>de<span class="_ _3"> </span>on<span class="_ _3"> </span>an<span class="_ _3"> </span>internal<span class="_ _3"> </span>storage<span class="_ _3"> </span>device<span class="_ _3"> </span>that</div><div class="t m0 x17 h7 y66b ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _b"> </span>not<span class="_ _2"> </span>directly<span class="_ _b"> </span>visible<span class="_ _b"> </span>to<span class="_ _2"> </span>softw<span class="_ _8"></span>are.<span class="_ _31"> </span>In<span class="_ _b"> </span>other<span class="_ _b"> </span>w<span class="_ _8"></span>ords,<span class="_ _b"> </span>the<span class="_ _b"> </span>soft<span class="_ _8"></span>ware<span class="_ _2"> </span>may<span class="_ _b"> </span>not<span class="_ _2"> </span>directly<span class="_ _b"> </span>in-</div><div class="t m0 x17 h7 y66c ff3 fs4 fc0 sc0 ls0 ws0">sp<span class="_ _4"></span>ect<span class="_ _3"> </span>or<span class="_ _3"> </span>mo<span class="_ _4"></span>dify<span class="_ _3"> </span>this<span class="_ _3"> </span>storage<span class="_ _3"> </span>device<span class="_ _a"> </span>to<span class="_ _3"> </span>identify<span class="_ _3"> </span>or<span class="_ _3"> </span>manipulate<span class="_ _3"> </span>the<span class="_ _3"> </span>current<span class="_ _3"> </span>privilege</div><div class="t m0 x17 h7 y66d ff3 fs4 fc0 sc0 ls0 ws0">mo<span class="_ _4"></span>de.<span class="_ _12"> </span>The<span class="_ _b"> </span>only<span class="_ _3"> </span>w<span class="_ _8"></span>ay<span class="_ _b"> </span>to<span class="_ _b"> </span>insp<span class="_ _4"></span>ect<span class="_ _b"> </span>the<span class="_ _3"> </span>curren<span class="_ _8"></span>t<span class="_ _3"> </span>privilege<span class="_ _b"> </span>mo<span class="_ _4"></span>de<span class="_ _b"> </span>is<span class="_ _b"> </span>by<span class="_ _b"> </span>generating<span class="_ _b"> </span>a<span class="_ _3"> </span>soft-</div><div class="t m0 x17 h7 y66e ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>are<span class="_ _b"> </span>in<span class="_ _8"></span>terrupt<span class="_ _b"> </span>or<span class="_ _b"> </span>exception,<span class="_ _2"> </span>which<span class="_ _2"> </span>copies<span class="_ _b"> </span>the<span class="_ _b"> </span>privilege<span class="_ _2"> </span>mo<span class="_ _4"></span>de<span class="_ _b"> </span>code<span class="_ _b"> </span>in<span class="_ _1"></span>to<span class="_ _b"> </span>the<span class="_ _2"> </span><span class="ff5">mstatus</span></div><div class="t m0 x17 h7 yd1 ff3 fs4 fc0 sc0 ls0 ws0">Mac<span class="_ _1"></span>hine Previous<span class="_ _5"> </span>Privilege ﬁeld<span class="_ _5"> </span>(<span class="ff5">mstatus</span>.<span class="ff5">MPP</span>). Also,<span class="_ _5"> </span>the<span class="_ _5"> </span>only wa<span class="_ _8"></span>y<span class="_ _5"> </span>to<span class="_ _5"> </span>set the<span class="_ _5"> </span>current</div><div class="t m0 x17 h7 yd2 ff3 fs4 fc0 sc0 ls0 ws0">privilege<span class="_ _2"> </span>mo<span class="_ _4"></span>de<span class="_ _2"> </span>is<span class="_ _b"> </span>to<span class="_ _2"> </span>mo<span class="_ _4"></span>dify<span class="_ _2"> </span>the<span class="_ _2"> </span>conten<span class="_ _8"></span>ts<span class="_ _b"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff5">mstatus<span class="_ _b"> </span></span>Mac<span class="_ _8"></span>hine<span class="_ _b"> </span>Previous<span class="_ _5"> </span>Privilege</div><div class="t m0 x17 h7 yd3 ff3 fs4 fc0 sc0 ls0 ws0">ﬁeld<span class="_ _3"> </span>(<span class="ff5">mstatus</span>.<span class="ff5">MPP</span>)<span class="_ _a"> </span>and<span class="_ _a"> </span>execute<span class="_ _3"> </span>the<span class="_ _a"> </span><span class="ff5">mret<span class="_ _a"> </span></span>instruction,<span class="_ _25"> </span>whic<span class="_ _1"></span>h<span class="_ _3"> </span>uses<span class="_ _a"> </span>the<span class="_ _a"> </span>v<span class="_ _8"></span>alue<span class="_ _3"> </span>in<span class="_ _a"> </span>the</div><div class="t m0 x17 h7 y48 ff5 fs4 fc0 sc0 ls0 ws0">mstatus<span class="ff3">.</span>MPP<span class="_ _2"> </span><span class="ff3">CSR<span class="_ _2"> </span>ﬁeld<span class="_ _2"> </span>to<span class="_ _2"> </span>set<span class="_ _2"> </span>the<span class="_ _2"> </span>curren<span class="_ _1"></span>t<span class="_ _2"> </span>privilege<span class="_ _2"> </span>mo<span class="_ _4"></span>de.</span></div><div class="t m0 x42 h7 yc ff5 fs4 fc0 sc0 ls0 ws0">http://riscv-<span class="_ _4"></span>programming.org<span class="_ _2"> </span><span class="ff3">(V<span class="_ _7"></span>ersion:<span class="_ _3"> </span>March<span class="_ _2"> </span>29,<span class="_ _2"> </span>2021)<span class="_ _64"> </span>130</span></div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",90.709,532.778,null]'><div class="d m1" style="border-style:none;position:absolute;left:480.740000px;bottom:287.039000px;width:22.056000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.478,null]'><div class="d m1" style="border-style:none;position:absolute;left:370.113000px;bottom:233.697000px;width:69.250000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",90.709,552.703,null]'><div class="d m1" style="border-style:none;position:absolute;left:173.795000px;bottom:163.574000px;width:23.440000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.478,null]'><div class="d m1" style="border-style:none;position:absolute;left:282.553000px;bottom:163.574000px;width:66.625000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.478,null]'><div class="d m1" style="border-style:none;position:absolute;left:466.737000px;bottom:139.664000px;width:38.826000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.478,null]'><div class="d m1" style="border-style:none;position:absolute;left:135.067000px;bottom:127.709000px;width:25.515000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.478,null]'><div class="d m1" style="border-style:none;position:absolute;left:332.733000px;bottom:127.709000px;width:66.304000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.478,null]'><div class="d m1" style="border-style:none;position:absolute;left:337.982000px;bottom:115.753000px;width:66.000000px;height:10.849000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.478,null]'><div class="d m1" style="border-style:none;position:absolute;left:135.067000px;bottom:91.843000px;width:65.841000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",90.709,532.778,null]'><div class="d m1" style="border-style:none;position:absolute;left:193.458000px;bottom:67.933000px;width:22.057000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.478,null]'><div class="d m1" style="border-style:none;position:absolute;left:317.964000px;bottom:67.933000px;width:65.670000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:187.121000px;bottom:36.395000px;width:148.940000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
