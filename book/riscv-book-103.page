<div id="pf67" class="pf w0 h0" data-page-no="67"><div class="pc pc67 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg67.png"/><div class="t m0 xf hd yed ff6 fs8 fc0 sc0 ls0 ws0">Chapter<span class="_ _1f"> </span>7</div><div class="t m0 xf ha yee ff6 fs5 fc0 sc0 ls0 ws0">Implemen<span class="_ _9"></span>ting<span class="_ _14"> </span>routines</div><div class="t m0 xf he yec4 ff6 fs3 fc0 sc0 ls0 ws0">7.1<span class="_ _37"> </span>The<span class="_ _4"> </span>program<span class="_ _4"> </span>memory<span class="_ _4"> </span>lay<span class="_ _9"></span>out</div><div class="t m0 xf h8 yec5 ff3 fs4 fc0 sc0 ls0 ws0">A<span class="_"> </span><span class="ff7">stored-program<span class="_"> </span></span>computer<span class="_"> </span>arc<span class="_ _27"></span>hitecture<span class="_ _38"> </span>is<span class="_ _6"> </span>a<span class="_"> </span>computer<span class="_ _38"> </span>architecture<span class="_"> </span>that<span class="_"> </span>stores<span class="_ _38"> </span>b<span class="_ _5"></span>oth<span class="_ _6"> </span>data<span class="_"> </span>and<span class="_"> </span>co<span class="_ _5"></span>de<span class="_ _6"> </span>on</div><div class="t m0 xf h8 yec6 ff3 fs4 fc0 sc0 ls0 ws0">memory<span class="_ _9"></span>.<span class="_ _34"> </span>A<span class="_ _6"> </span><span class="ff7">V<span class="_ _12"></span>on<span class="_ _3"> </span>Neumann<span class="_ _2"> </span>architecture<span class="_ _38"> </span><span class="ff3">is<span class="_ _6"> </span>a<span class="_"> </span>computer<span class="_ _6"> </span>architecture<span class="_"> </span>that<span class="_ _6"> </span>stores<span class="_ _6"> </span>b<span class="_ _5"></span>oth<span class="_"> </span>the<span class="_ _6"> </span>data<span class="_ _6"> </span>and<span class="_ _6"> </span>the</span></span></div><div class="t m0 xf h8 yec7 ff3 fs4 fc0 sc0 ls0 ws0">co<span class="_ _5"></span>de<span class="_ _6"> </span>at<span class="_ _2"> </span>the<span class="_ _2"> </span>same<span class="_ _2"> </span>address<span class="_ _2"> </span>space.<span class="_ _7"> </span>Most<span class="_ _2"> </span>mo<span class="_ _5"></span>dern<span class="_ _2"> </span>computer<span class="_ _2"> </span>architectures<span class="_ _6"> </span>are<span class="_ _2"> </span>V<span class="_ _9"></span>on<span class="_ _2"> </span>Neumann<span class="_ _2"> </span>architectures.</div><div class="t m0 xc h8 yec8 ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _35"> </span>7.1<span class="_ _a"> </span>shows<span class="_ _35"> </span>a<span class="_ _35"> </span>common<span class="_ _a"> </span>wa<span class="_ _27"></span>y<span class="_ _a"> </span>of<span class="_ _a"> </span>organizing<span class="_ _35"> </span>programs<span class="_ _a"> </span>on<span class="_ _a"> </span>the<span class="_ _35"> </span>memory<span class="_ _a"> </span>of<span class="_ _a"> </span>V<span class="_ _9"></span>on<span class="_ _a"> </span>Neumann<span class="_ _35"> </span>architectures.</div><div class="t m0 xf h8 yec9 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _b"> </span><span class="ff7">co<span class="_ _5"></span>de<span class="_ _24"> </span>space<span class="_ _24"> </span>is<span class="_ _24"> </span>a<span class="_ _24"> </span>memory<span class="_ _7"> </span>space<span class="_ _24"> </span>that<span class="_ _24"> </span>stores<span class="_ _24"> </span>the<span class="_ _24"> </span>program<span class="_ _24"> </span>co<span class="_ _5"></span>de<span class="_ _b"> </span></span>and<span class="_ _34"> </span>is<span class="_ _b"> </span>usually<span class="_ _34"> </span>placed<span class="_ _34"> </span>ﬁrst,</div><div class="t m0 xf h8 yeca ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _7"> </span>the<span class="_ _7"> </span>low<span class="_ _27"></span>est<span class="_ _7"> </span>addresses.<span class="_ _1f"> </span>The<span class="_ _7"> </span><span class="ff7">static<span class="_ _4"> </span>data<span class="_ _18"> </span>space<span class="_ _18"> </span>is<span class="_ _4"> </span>a<span class="_ _18"> </span>memory<span class="_ _4"> </span>space<span class="_ _18"> </span>that<span class="_ _18"> </span>stores<span class="_ _4"> </span>the<span class="_ _18"> </span>program</span></div><div class="t m0 xf h8 yecb ff7 fs4 fc0 sc0 ls0 ws0">static<span class="_ _3"> </span>data<span class="_"> </span><span class="ff3">(<span class="ff8">e.g.</span>,<span class="_ _38"> </span>global<span class="_ _2"> </span>v<span class="_ _27"></span>ariables)<span class="_ _6"> </span>and<span class="_ _6"> </span>is<span class="_ _6"> </span>placed<span class="_ _6"> </span>after<span class="_ _6"> </span>the<span class="_ _2"> </span>co<span class="_ _5"></span>de.<span class="_ _34"> </span>The<span class="_ _6"> </span><span class="ff7">heap<span class="_ _3"> </span>space<span class="_ _3"> </span>is<span class="_ _3"> </span>a<span class="_ _3"> </span>memory<span class="_ _3"> </span>space</span></span></div><div class="t m0 xf h8 y949 ff7 fs4 fc0 sc0 ls0 ws0">managed<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>memory<span class="_ _2"> </span>allo<span class="_ _22"></span>cation<span class="_"> </span>library</div><div class="t m0 x64 h11 yecc ffc fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x15 h8 y949 ff3 fs4 fc0 sc0 ls0 ws0">and<span class="_"> </span>is<span class="_ _6"> </span>allo<span class="_ _5"></span>cated<span class="_"> </span>after<span class="_ _38"> </span>the<span class="_ _6"> </span>static<span class="_"> </span>data.<span class="_ _7"> </span>The<span class="_ _38"> </span>heap<span class="_ _6"> </span>starts</div><div class="t m0 xf h8 y94a ff3 fs4 fc0 sc0 ls0 ws0">small<span class="_ _b"> </span>and,<span class="_ _b"> </span>whenever<span class="_ _3"> </span>the<span class="_ _b"> </span>memory<span class="_ _3"> </span>allo<span class="_ _5"></span>cation<span class="_ _b"> </span>library<span class="_ _b"> </span>needs<span class="_ _b"> </span>more<span class="_ _b"> </span>space,<span class="_ _b"> </span>it<span class="_ _b"> </span>inv<span class="_ _27"></span>okes<span class="_ _3"> </span>the<span class="_ _b"> </span>op<span class="_ _5"></span>erating<span class="_ _b"> </span>system</div><div class="t m0 xf h8 yecd ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _b"> </span>gro<span class="_ _1"></span>w<span class="_ _b"> </span>the<span class="_ _b"> </span>heap<span class="_ _b"> </span>area,<span class="_ _34"> </span>which<span class="_ _3"> </span>do<span class="_ _5"></span>es<span class="_ _b"> </span>it<span class="_ _b"> </span>by<span class="_ _3"> </span>increasing<span class="_ _b"> </span>the<span class="_ _34"> </span>“program<span class="_ _b"> </span>break”<span class="_ _b"> </span>address</div><div class="t m0 x48 h11 y94c ffc fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x16 h8 yecd ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _17"> </span>Finally<span class="_ _9"></span>,<span class="_ _b"> </span>the<span class="_ _34"> </span><span class="ff7">stac<span class="_ _1"></span>k</span></div><div class="t m0 xf h8 yece ff7 fs4 fc0 sc0 ls0 ws0">space<span class="_ _34"> </span>is<span class="_ _34"> </span>a<span class="_ _34"> </span>memory<span class="_ _7"> </span>space<span class="_ _34"> </span>that<span class="_ _34"> </span>stores<span class="_ _34"> </span>the<span class="_ _7"> </span>program<span class="_ _34"> </span>stack<span class="_ _2"> </span><span class="ff3">and<span class="_ _3"> </span>is<span class="_ _b"> </span>usually<span class="_ _3"> </span>placed<span class="_ _3"> </span>at<span class="_ _3"> </span>the<span class="_ _b"> </span>end<span class="_ _3"> </span>(high</span></div><div class="t m0 xf h8 yecf ff3 fs4 fc0 sc0 ls0 ws0">addresses)<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _6"> </span>memory<span class="_ _27"></span>.</div><div class="c x8e yed0 w16 h6e"><div class="t m0 x3c h6f yed1 ff87 fs38 fc0 sc0 ls0 ws0"><span class="fc2 sc0">0x0000</span></div><div class="t m2 x110 h70 yed2 ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">Addresses</span></div><div class="t m0 x12d h70 yed3 ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">Code</span></div><div class="t m0 x135 h70 yed4 ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">Static </span><span class="fc2 sc0">Data</span></div><div class="t m0 x12d h70 yed5 ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">Stack</span></div><div class="t m0 x12f h70 yed6 ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">Main </span><span class="fc2 sc0">Memory</span></div><div class="t m0 xbe h70 yed7 ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">T</span><span class="_ _9"></span><span class="fc2 sc0">op </span><span class="fc2 sc0">of </span></div><div class="t m0 xbe h70 yed8 ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">the </span><span class="fc2 sc0">stack</span></div><div class="t m0 x12d h70 yed9 ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">Heap</span></div><div class="t m0 xbe h70 yeda ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">Program </span></div><div class="t m0 xbe h70 yedb ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">break</span></div><div class="t m0 xf2 h70 yedc ff88 fs39 fc0 sc0 ls0 ws0"><span class="fc2 sc0">Free </span><span class="fc2 sc0">space</span></div></div><div class="t m0 x9d h8 yedd ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _2"> </span>7.1:<span class="_ _7"> </span>Common<span class="_ _2"> </span>program<span class="_ _6"> </span>mem<span class="_ _5"></span>ory<span class="_ _6"> </span>lay<span class="_ _27"></span>out.</div><div class="t m0 x2b h1d yede fff fsd fc0 sc0 ls0 ws0">1</div><div class="t m0 xc h1e yedf ff10 fse fc0 sc0 ls0 ws0">The<span class="_"> </span>memory<span class="_"> </span>allo<span class="_ _5"></span>cation<span class="_ _89"> </span>library<span class="_"> </span>allows<span class="_"> </span>the<span class="_"> </span>program<span class="_ _89"> </span>to<span class="_"> </span>dynamically<span class="_ _89"> </span>allo<span class="_ _5"></span>cate<span class="_"> </span>(and<span class="_"> </span>free)<span class="_ _89"> </span>data<span class="_"> </span>on<span class="_ _89"> </span>the<span class="_"> </span>heap.<span class="_ _b"> </span>Data<span class="_"> </span>allo<span class="_ _5"></span>cated</div><div class="t m0 xf h1e yee0 ff10 fse fc0 sc0 ls0 ws0">using<span class="_ _89"> </span>the<span class="_ _89"> </span><span class="ff28">malloc<span class="_ _38"> </span></span>routine,<span class="_ _89"> </span>for<span class="_ _38"> </span>example,<span class="_ _89"> </span>is<span class="_ _38"> </span>allo<span class="_ _5"></span>cated<span class="_ _89"> </span>into<span class="_"> </span>the<span class="_ _89"> </span>heap.<span class="_ _b"> </span>The<span class="_ _89"> </span>memory<span class="_ _89"> </span>allo<span class="_ _5"></span>cation<span class="_ _38"> </span>library<span class="_ _89"> </span>is<span class="_ _89"> </span>resp<span class="_ _5"></span>onsible<span class="_ _38"> </span>for<span class="_ _89"> </span>keeping</div><div class="t m0 xf h1e yee1 ff10 fse fc0 sc0 ls0 ws0">track<span class="_"> </span>of<span class="_ _38"> </span>which<span class="_ _38"> </span>addresses<span class="_ _38"> </span>within<span class="_ _38"> </span>the<span class="_ _38"> </span>heap<span class="_ _38"> </span>are<span class="_ _38"> </span>free<span class="_ _38"> </span>or<span class="_ _38"> </span>allo<span class="_ _5"></span>cated.</div><div class="t m0 x2b h1d yee2 fff fsd fc0 sc0 ls0 ws0">2</div><div class="t m0 xc h1e yee3 ff10 fse fc0 sc0 ls0 ws0">The<span class="_ _38"> </span>program<span class="_ _38"> </span>break<span class="_ _38"> </span>deﬁnes<span class="_ _38"> </span>the<span class="_ _38"> </span>end<span class="_ _38"> </span>of<span class="_ _38"> </span>the<span class="_ _38"> </span>heap.</div><div class="t m0 x14 h8 y33 ff3 fs4 fc0 sc0 ls0 ws0">90</div><a class="l" href="#pf67" data-dest-detail='[103,"XYZ",72,378.953,null]'><div class="d m1" style="border-style:none;position:absolute;left:116.291000px;bottom:480.129000px;width:14.723000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf67" data-dest-detail='[103,"XYZ",87.243,191.203,null]'><div class="d m1" style="border-style:none;position:absolute;left:283.323000px;bottom:432.308000px;width:6.462000px;height:12.040000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf67" data-dest-detail='[103,"XYZ",87.243,162.77,null]'><div class="d m1" style="border-style:none;position:absolute;left:428.966000px;bottom:408.398000px;width:6.462000px;height:12.039000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
