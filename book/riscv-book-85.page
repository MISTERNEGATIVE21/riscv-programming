<div id="pf55" class="pf w0 h0" data-page-no="55"><div class="pc pc55 w0 h0"><img class="bi x17 y181 we h20" alt="" src="bg55.png"/><div class="t m0 x17 h7 y147 ff3 fs4 fc0 sc0 ls0 ws0">CHAPTER<span class="_ _2"> </span>6.<span class="_ _19"> </span>THE<span class="_ _2"> </span>R<span class="_ _23"></span>V32I<span class="_ _2"> </span>ISA</div><div class="t m0 x17 h7 y1e ff3 fs4 fc0 sc0 ls0 ws0">op<span class="_ _4"></span>code<span class="_ _b"> </span>and<span class="_ _3"> </span>other<span class="_ _b"> </span>parameters<span class="_ _3"> </span>(suc<span class="_ _8"></span>h<span class="_ _3"> </span>as<span class="_ _b"> </span>registers)<span class="_ _3"> </span>inside<span class="_ _b"> </span>a<span class="_ _3"> </span>single<span class="_ _b"> </span>32-bit<span class="_ _b"> </span>long<span class="_ _3"> </span>instruc-</div><div class="t m0 x17 h7 yd4 ff3 fs4 fc0 sc0 ls0 ws0">tion.<span class="_ _83"> </span>T<span class="_ _7"></span>o<span class="_ _3"> </span>ov<span class="_ _8"></span>ercome<span class="_ _3"> </span>this<span class="_ _3"> </span>limitation,<span class="_ _a"> </span>direct<span class="_ _3"> </span>target<span class="_ _3"> </span>addresses<span class="_ _3"> </span>are<span class="_ _3"> </span>enco<span class="_ _4"></span>ded<span class="_ _b"> </span>as<span class="_ _3"> </span>an<span class="_ _3"> </span>oﬀset</div><div class="t m0 x17 h7 yd5 ff3 fs4 fc0 sc0 ls0 ws0">that<span class="_ _b"> </span>is<span class="_ _3"> </span>added<span class="_ _3"> </span>to<span class="_ _3"> </span>the<span class="_ _b"> </span>program<span class="_ _3"> </span>counter</div><div class="t m0 x84 h11 yece ffc fs7 fc0 sc0 ls0 ws0">15</div><div class="t m0 x19 h7 yd5 ff3 fs4 fc0 sc0 ls0 ws0">(PC)<span class="_ _b"> </span>when<span class="_ _3"> </span>the<span class="_ _3"> </span>instruction<span class="_ _3"> </span>is<span class="_ _b"> </span>executed.<span class="_ _83"> </span>In</div><div class="t m0 x17 h7 yfd ff3 fs4 fc0 sc0 ls0 ws0">R<span class="_ _23"></span>V32I,<span class="_ _5"> </span>the target<span class="_ _5"> </span>address of<span class="_ _5"> </span>conditional control-ﬂo<span class="_ _8"></span>w<span class="_ _5"> </span>instructions is<span class="_ _5"> </span>enco<span class="_ _4"></span>ded as 12-bit</div><div class="t m0 x17 h7 y28a ff3 fs4 fc0 sc0 ls0 ws0">signed oﬀsets.<span class="_ _3"> </span>Using a 12-bit oﬀset to enco<span class="_ _4"></span>de the target prev<span class="_ _8"></span>ents the instruction from</div><div class="t m0 x17 h7 y48a ff3 fs4 fc0 sc0 ls0 ws0">jumping<span class="_ _5"> </span>to<span class="_ _2"> </span>addresses<span class="_ _2"> </span>that<span class="_ _5"> </span>are<span class="_ _2"> </span>to<span class="_ _4"></span>o<span class="_ _5"> </span>far<span class="_ _2"> </span>aw<span class="_ _8"></span>ay<span class="_ _5"> </span>from<span class="_ _5"> </span>the<span class="_ _2"> </span>address<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _5"> </span>instruction<span class="_ _2"> </span>itself.</div><div class="t m0 x17 h7 y22 ff3 fs4 fc0 sc0 ls0 ws0">In<span class="_ _5"> </span>these cases,<span class="_ _2"> </span>the<span class="_ _5"> </span>programmer loads<span class="_ _5"> </span>the<span class="_ _5"> </span>target<span class="_ _5"> </span>address<span class="_ _5"> </span>into a<span class="_ _5"> </span>register<span class="_ _5"> </span>and,<span class="_ _2"> </span>then,<span class="_ _5"> </span>use</div><div class="t m0 x17 h7 y23 ff3 fs4 fc0 sc0 ls0 ws0">an<span class="_ _2"> </span>indirect<span class="_ _2"> </span>jump<span class="_ _2"> </span>instruction<span class="_ _2"> </span>to<span class="_ _2"> </span>jump<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>target<span class="_ _2"> </span>address.</div><div class="t m0 x17 ha yecf ff7 fs6 fc0 sc0 ls0 ws0">6.7.3<span class="_ _e"> </span>Unconditional<span class="_ _a"> </span>con<span class="_ _8"></span>trol-ﬂow<span class="_ _3"> </span>instructions</div><div class="t m0 x17 h7 yed0 ff6 fs4 fc0 sc0 ls0 ws0">Unconditional<span class="_ _3"> </span>control-ﬂo<span class="_ _8"></span>w<span class="_ _a"> </span>instructions<span class="_ _3"> </span>are<span class="_ _a"> </span>con<span class="_ _1"></span>trol-ﬂo<span class="_ _1"></span>w<span class="_ _3"> </span>instructions<span class="_ _a"> </span>that</div><div class="t m0 x17 h7 yed1 ff6 fs4 fc0 sc0 ls0 ws0">alw<span class="_ _8"></span>ays<span class="_ _3"> </span>c<span class="_ _8"></span>hange<span class="_ _3"> </span>the<span class="_ _a"> </span>execution<span class="_ _3"> </span>ﬂow<span class="_ _b"> </span>to<span class="_ _3"> </span>a<span class="_ _a"> </span>giv<span class="_ _8"></span>en<span class="_ _a"> </span>target<span class="ff3">.<span class="_ _31"> </span>F<span class="_ _7"></span>or<span class="_ _b"> </span>example,<span class="_ _b"> </span>the<span class="_ _b"> </span>“<span class="ff5">j<span class="_ _9"> </span>L</span>”</span></div><div class="t m0 x17 h7 yed2 ff3 fs4 fc0 sc0 ls0 ws0">instruction is<span class="_ _5"> </span>a<span class="_ _5"> </span>control-ﬂo<span class="_ _8"></span>w<span class="_ _5"> </span>instruction<span class="_ _5"> </span>that<span class="_ _5"> </span>alwa<span class="_ _8"></span>ys<span class="_ _5"> </span>jumps<span class="_ _5"> </span>to<span class="_ _5"> </span>lab<span class="_ _4"></span>el <span class="ff5">L</span>.<span class="_ _5"> </span>In<span class="_ _5"> </span>the<span class="_ _5"> </span>following</div><div class="t m0 x17 h7 yed3 ff3 fs4 fc0 sc0 ls0 ws0">co<span class="_ _4"></span>de,<span class="_ _30"> </span>the<span class="_ _2f"> </span><span class="ff5">j<span class="_ _30"> </span></span>instruction<span class="_ _2f"> </span>(line<span class="_ _30"> </span>2)<span class="_ _2f"> </span>jumps<span class="_ _30"> </span>to<span class="_ _2f"> </span>label<span class="_ _2f"> </span>,<span class="_ _2f"> </span>hence,<span class="_ _2f"> </span>after<span class="_ _30"> </span>executing<span class="_ _2f"> </span>the<span class="_ _30"> </span><span class="ff5">j<span class="_ _2f"> </span></span>instruction,</div><div class="t m0 x17 h7 yed4 ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _2"> </span>pro<span class="_ _4"></span>cessor<span class="_ _5"> </span>executes<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff5">sub<span class="_ _2"> </span></span>instruction<span class="_ _2"> </span>(line<span class="_ _2"> </span>7).</div><div class="t m0 xd5 h8 yed5 ff24 fs12 fc0 sc0 ls0 ws0">1<span class="_ _16"> </span><span class="ff5 fs4">div<span class="_ _31"> </span>a0,<span class="_ _31"> </span>a1,<span class="_ _9"> </span>a2</span></div><div class="t m0 xd5 h8 yed6 ff24 fs12 fc0 sc0 ls0 ws0">2<span class="_ _16"> </span><span class="ff5 fs4">j<span class="_ _3b"> </span>FOO</span></div><div class="t m0 xd5 h8 yed7 ff24 fs12 fc0 sc0 ls0 ws0">3<span class="_ _16"> </span><span class="ff5 fs4">add<span class="_ _31"> </span>a0,<span class="_ _31"> </span>a0,<span class="_ _9"> </span>a1</span></div><div class="t m0 xd5 h8 yed8 ff24 fs12 fc0 sc0 ls0 ws0">4<span class="_ _16"> </span><span class="ff5 fs4">mul<span class="_ _31"> </span>a0,<span class="_ _31"> </span>a1,<span class="_ _9"> </span>a2</span></div><div class="t m0 xd5 h38 yed9 ff24 fs12 fc0 sc0 ls0 ws0">5</div><div class="t m0 xd5 h8 yeda ff24 fs12 fc0 sc0 ls0 ws0">6<span class="_ _16"> </span><span class="ff5 fs4">FOO:</span></div><div class="t m0 xd5 h8 yedb ff24 fs12 fc0 sc0 ls0 ws0">7<span class="_ _16"> </span><span class="ff5 fs4">sub<span class="_ _31"> </span>a0,<span class="_ _31"> </span>a1,<span class="_ _9"> </span>a2</span></div><div class="t m0 xd5 h8 yedc ff24 fs12 fc0 sc0 ls0 ws0">8<span class="_ _16"> </span><span class="ff5 fs4">#<span class="_ _31"> </span>...</span></div><div class="t m0 x13 h7 yedd ff6 fs4 fc0 sc0 ls0 ws0">NOTE:<span class="_ _11"> </span><span class="ff3">In<span class="_ _3"> </span>the<span class="_ _3"> </span>RISC-V<span class="_ _3"> </span>ISA<span class="_ _a"> </span>manual<span class="_ _3"> </span>[4],<span class="_ _a"> </span>W<span class="_ _7"></span>aterman<span class="_ _a"> </span>and<span class="_ _3"> </span>Asanovi<span class="_ _8"></span>´<span class="_ _77"></span>c<span class="_ _a"> </span>use<span class="_ _3"> </span>the</span></div><div class="t m0 x13 h7 yede ff3 fs4 fc0 sc0 ls0 ws0">term<span class="_ _2f"> </span>“unconditional<span class="_ _2f"> </span>jumps”<span class="_ _2f"> </span>to<span class="_ _30"> </span>refer to<span class="_ _2f"> </span>unconditional<span class="_ _2f"> </span>con<span class="_ _8"></span>trol-ﬂow<span class="_ _30"> </span>instructions.</div><div class="t m0 x13 h7 ycb1 ff3 fs4 fc0 sc0 ls0 ws0">There are sev<span class="_ _8"></span>eral unconditional control-ﬂo<span class="_ _8"></span>w instructions in the R<span class="_ _23"></span>V32I . T<span class="_ _7"></span>able 6.11</div><div class="t m0 x17 h7 ycb3 ff3 fs4 fc0 sc0 ls0 ws0">sho<span class="_ _1"></span>ws<span class="_ _2"> </span>the<span class="_ _2"> </span>R<span class="_ _23"></span>V32I<span class="_ _2"> </span>unconditional<span class="_ _2"> </span>control-ﬂo<span class="_ _8"></span>w<span class="_ _2"> </span>instructions<span class="_ _2"> </span>and<span class="_ _2"> </span>pseudo-instructions.</div><div class="t m0 x1f h7 yedf ff3 fs4 fc0 sc0 ls0 ws0">Instruction<span class="_ _bf"> </span>Description</div><div class="t m0 x1f h8 yee0 ff5 fs4 fc0 sc0 ls0 ws0">j<span class="_ _9"> </span>lab</div><div class="t m0 xe4 h7 yee1 ff3 fs4 fc0 sc0 ls0 ws0">Jumps<span class="_ _9"> </span>to<span class="_ _31"> </span>address<span class="_ _9"> </span>indicated<span class="_ _31"> </span>by<span class="_ _25"> </span>symbol<span class="_ _31"> </span><span class="ff5">sym<span class="_ _9"> </span></span>(pseudo-</div><div class="t m0 xe4 h7 yee2 ff3 fs4 fc0 sc0 ls0 ws0">instruction).</div><div class="t m0 x1f h8 yee3 ff5 fs4 fc0 sc0 ls0 ws0">jr<span class="_ _9"> </span>rs1</div><div class="t m0 xe4 h7 yee4 ff3 fs4 fc0 sc0 ls0 ws0">Jumps<span class="_ _3"> </span>to<span class="_ _3"> </span>the<span class="_ _3"> </span>address<span class="_ _3"> </span>stored<span class="_ _a"> </span>on<span class="_ _3"> </span>register<span class="_ _3"> </span><span class="ff5">rs1<span class="_ _3"> </span></span>(pseudo-</div><div class="t m0 xe4 h7 yee5 ff3 fs4 fc0 sc0 ls0 ws0">instruction).</div><div class="t m0 x1f h8 yee6 ff5 fs4 fc0 sc0 ls0 ws0">jal<span class="_ _9"> </span>lab</div><div class="t m0 xe4 h7 yee7 ff3 fs4 fc0 sc0 ls0 ws0">Stores the return<span class="_ _2f"> </span>address (PC+4) on<span class="_ _2f"> </span>the return register</div><div class="t m0 xe4 h7 yee8 ff3 fs4 fc0 sc0 ls0 ws0">(<span class="ff5">ra</span>),<span class="_ _2"> </span>then<span class="_ _2"> </span>jumps<span class="_ _2"> </span>to<span class="_ _2"> </span>lab<span class="_ _4"></span>el<span class="_ _5"> </span><span class="ff5">lab<span class="_ _2"> </span></span>(pseudo-instruction).</div><div class="t m0 x1f h8 yee9 ff5 fs4 fc0 sc0 ls0 ws0">jal<span class="_ _9"> </span>rd,<span class="_ _31"> </span>lab</div><div class="t m0 xe4 h7 yeea ff3 fs4 fc0 sc0 ls0 ws0">Stores<span class="_ _b"> </span>the<span class="_ _b"> </span>return<span class="_ _2"> </span>address<span class="_ _b"> </span>(PC+4)<span class="_ _b"> </span>on<span class="_ _b"> </span>register<span class="_ _b"> </span><span class="ff5">rd</span>,<span class="_ _b"> </span>then</div><div class="t m0 xe4 h7 yeeb ff3 fs4 fc0 sc0 ls0 ws0">jumps<span class="_ _2"> </span>to<span class="_ _2"> </span>lab<span class="_ _4"></span>el<span class="_ _5"> </span><span class="ff5">lab</span>.</div><div class="t m0 x1f h8 yeec ff5 fs4 fc0 sc0 ls0 ws0">jarl<span class="_ _9"> </span>rd,<span class="_ _31"> </span>rs1,<span class="_ _31"> </span>imm</div><div class="t m0 xe4 h7 yeed ff3 fs4 fc0 sc0 ls0 ws0">Stores<span class="_ _b"> </span>the<span class="_ _b"> </span>return<span class="_ _2"> </span>address<span class="_ _b"> </span>(PC+4)<span class="_ _b"> </span>on<span class="_ _b"> </span>register<span class="_ _b"> </span><span class="ff5">rd</span>,<span class="_ _b"> </span>then</div><div class="t m0 xe4 h7 yeec ff3 fs4 fc0 sc0 ls0 ws0">jumps<span class="_ _5"> </span>to<span class="_ _2"> </span>the<span class="_ _5"> </span>address<span class="_ _2"> </span>calculated<span class="_ _5"> </span>by<span class="_ _5"> </span>adding<span class="_ _5"> </span>the<span class="_ _2"> </span>immedi-</div><div class="t m0 xe4 h7 yeee ff3 fs4 fc0 sc0 ls0 ws0">ate<span class="_ _2"> </span>v<span class="_ _8"></span>alue<span class="_ _2"> </span><span class="ff5">imm<span class="_ _2"> </span></span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>v<span class="_ _8"></span>alue<span class="_ _2"> </span>on<span class="_ _2"> </span>register<span class="_ _2"> </span><span class="ff5">rs1</span>.</div><div class="t m0 x1f h8 yeef ff5 fs4 fc0 sc0 ls0 ws0">ret</div><div class="t m0 xe4 h7 yef0 ff3 fs4 fc0 sc0 ls0 ws0">Jumps<span class="_ _5"> </span>to<span class="_ _5"> </span>the<span class="_ _5"> </span>address<span class="_ _5"> </span>stored<span class="_ _5"> </span>on<span class="_ _2"> </span>the return<span class="_ _2"> </span>register<span class="_ _5"> </span>(<span class="ff5">ra</span>)</div><div class="t m0 xe4 h7 yef1 ff3 fs4 fc0 sc0 ls0 ws0">(pseudo-instruction).</div><div class="t m0 x56 h7 yef2 ff3 fs4 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>able<span class="_ _2"> </span>6.11:<span class="_ _3"> </span>R<span class="_ _7"></span>V32I<span class="_ _2"> </span>unconditional<span class="_ _2"> </span>con<span class="_ _8"></span>trol-ﬂow<span class="_ _2"> </span>instructions</div><div class="t m0 x13 h7 yef3 ff3 fs4 fc0 sc0 ls0 ws0">Instruction<span class="_ _2"> </span>“<span class="ff5">j<span class="_ _31"> </span>lab</span>”<span class="_ _2"> </span>jumps<span class="_ _2"> </span>to<span class="_ _b"> </span>label<span class="_ _2"> </span><span class="ff5">lab<span class="_ _b"> </span></span>while<span class="_ _5"> </span>instruction<span class="_ _b"> </span>“<span class="ff5">jr<span class="_ _9"> </span>rs1</span>”<span class="_ _2"> </span>jumps<span class="_ _b"> </span>to<span class="_ _5"> </span>the</div><div class="t m0 x17 h7 yef4 ff3 fs4 fc0 sc0 ls0 ws0">address<span class="_ _2"> </span>stored<span class="_ _2"> </span>on<span class="_ _2"> </span>register<span class="_ _2"> </span><span class="ff5">rs1</span>.</div><div class="t m0 x17 h7 yef5 ff6 fs4 fc0 sc0 ls0 ws0">Jump<span class="_ _b"> </span>and<span class="_ _b"> </span>Link</div><div class="t m0 x17 h7 yef6 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _b"> </span>jump<span class="_ _3"> </span>and<span class="_ _b"> </span>link<span class="_ _b"> </span>instruction<span class="_ _3"> </span>(<span class="ff5">jal<span class="_ _9"> </span>rd,<span class="_ _31"> </span>lab</span>)<span class="_ _b"> </span>s<span class="_ _4"></span>tores<span class="_ _b"> </span>the<span class="_ _b"> </span>address<span class="_ _b"> </span>of<span class="_ _3"> </span>the<span class="_ _b"> </span>subsequent</div><div class="t m0 x17 h7 yef7 ff3 fs4 fc0 sc0 ls0 ws0">instruction<span class="_ _3"> </span>(<span class="ff8">i.e.</span>,<span class="_ _3"> </span>PC+4)<span class="_ _3"> </span>in<span class="_ _b"> </span>register<span class="_ _3"> </span><span class="ff5">rd<span class="_ _3"> </span></span>and<span class="_ _b"> </span>then<span class="_ _3"> </span>jumps<span class="_ _3"> </span>to<span class="_ _3"> </span>label<span class="_ _3"> </span><span class="ff5">lab</span>.<span class="_ _83"> </span>This<span class="_ _3"> </span>process,</div><div class="t m0 x7c h1e y208 ff12 fse fc0 sc0 ls0 ws0">15</div><div class="t m0 x13 h1f y209 ff13 fsf fc0 sc0 ls0 ws0">The<span class="_ _36"> </span>program coun<span class="_ _8"></span>ter<span class="_ _30"> </span>con<span class="_ _8"></span>tains<span class="_ _30"> </span>the<span class="_ _36"> </span>address<span class="_ _30"> </span>of<span class="_ _36"> </span>the<span class="_ _30"> </span>curren<span class="_ _8"></span>tly<span class="_ _30"> </span>executing<span class="_ _36"> </span>instruction.<span class="_ _2"> </span>When<span class="_ _30"> </span>executing</div><div class="t m0 x17 h1f y48 ff13 fsf fc0 sc0 ls0 ws0">a<span class="_ _37"> </span>control-ﬂo<span class="_ _8"></span>w<span class="_ _37"> </span>instruction<span class="_ _37"> </span>it<span class="_ _5"> </span>contains<span class="_ _2f"> </span>the<span class="_ _37"> </span>address<span class="_ _37"> </span>of<span class="_ _5"> </span>the<span class="_ _37"> </span>said<span class="_ _37"> </span>instruction.</div><div class="t m0 x42 h7 yc ff5 fs4 fc0 sc0 ls0 ws0">http://riscv-<span class="_ _4"></span>programming.org<span class="_ _2"> </span><span class="ff3">(V<span class="_ _7"></span>ersion:<span class="_ _3"> </span>March<span class="_ _2"> </span>29,<span class="_ _2"> </span>2021)<span class="_ _85"> </span>72</span></div><a class="l" href="#pf55" data-dest-detail='[85,"XYZ",151.306,89.795,null]'><div class="d m1" style="border-style:none;position:absolute;left:302.145000px;bottom:733.664000px;width:10.433000px;height:12.593000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf92" data-dest-detail='[146,"XYZ",90.709,546.583,null]'><div class="d m1" style="border-style:none;position:absolute;left:327.215000px;bottom:442.088000px;width:6.974000px;height:8.413000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",136.063,113.65,null]'><div class="d m1" style="border-style:none;position:absolute;left:453.532000px;bottom:403.968000px;width:1.992000px;height:8.911000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf55" data-dest-detail='[85,"XYZ",136.063,386.369,null]'><div class="d m1" style="border-style:none;position:absolute;left:485.859000px;bottom:403.968000px;width:19.704000px;height:8.911000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",136.063,146.437,null]'><div class="d m1" style="border-style:none;position:absolute;left:461.426000px;bottom:244.756000px;width:37.415000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",136.063,146.437,null]'><div class="d m1" style="border-style:none;position:absolute;left:257.323000px;bottom:231.151000px;width:41.013000px;height:12.498000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:187.121000px;bottom:36.395000px;width:148.940000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
