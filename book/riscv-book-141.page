<div id="pf8d" class="pf w0 h0" data-page-no="8d"><div class="pc pc8d w0 h0"><div class="t m0 x18 hc y1756 ff6 fs8 fc0 sc0 ls0 ws0">Chapter<span class="_ _22"> </span>11</div><div class="t m0 x18 h9 y1757 ff6 fs5 fc0 sc0 ls0 ws0">Soft<span class="_ _7"></span>w<span class="_ _7"></span>are<span class="_ _18"> </span>In<span class="_ _7"></span>terrupts<span class="_ _27"> </span>and</div><div class="t m0 x18 h9 y1758 ff6 fs5 fc0 sc0 ls0 ws0">Exceptions</div><div class="t m0 x18 h7 y1759 ff3 fs4 fc0 sc0 ls0 ws0">As<span class="_ _5"> </span>discussed<span class="_ _5"> </span>in<span class="_ _5"> </span>Section<span class="_ _5"> </span>5,<span class="_ _5"> </span>many computer<span class="_ _5"> </span>systems<span class="_ _5"> </span>are<span class="_ _5"> </span>organized<span class="_ _5"> </span>so<span class="_ _5"> </span>that<span class="_ _5"> </span>the<span class="_ _5"> </span>softw<span class="_ _8"></span>are</div><div class="t m0 x18 h7 y175a ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _a"> </span>divided<span class="_ _3"> </span>in<span class="_ _1"></span>to<span class="_ _a"> </span>user<span class="_ _3"> </span>and<span class="_ _a"> </span>system<span class="_ _3"> </span>softw<span class="_ _8"></span>are.<span class="_ _10"> </span>The<span class="_ _a"> </span>system<span class="_ _3"> </span>softw<span class="_ _8"></span>are<span class="_ _a"> </span>(<span class="ff8">e.g.</span>,<span class="_ _3"> </span>the<span class="_ _3"> </span>op<span class="_ _4"></span>erating</div><div class="t m0 x18 h7 y175b ff3 fs4 fc0 sc0 ls0 ws0">system<span class="_ _5"> </span>kernel and<span class="_ _2"> </span>device<span class="_ _5"> </span>drivers)<span class="_ _5"> </span>is<span class="_ _5"> </span>the<span class="_ _2"> </span>soft<span class="_ _1"></span>w<span class="_ _1"></span>are<span class="_ _5"> </span>resp<span class="_ _4"></span>onsible<span class="_ _5"> </span>for<span class="_ _5"> </span>protecting<span class="_ _2"> </span>and<span class="_ _5"> </span>man-</div><div class="t m0 x18 h7 y175c ff3 fs4 fc0 sc0 ls0 ws0">aging<span class="_ _2"> </span>the<span class="_ _2"> </span>whole<span class="_ _d"> </span>system,<span class="_ _2"> </span>including<span class="_ _2"> </span>interacting<span class="_ _2"> </span>with<span class="_ _2"> </span>p<span class="_ _4"></span>eripherals<span class="_ _5"> </span>to<span class="_ _d"> </span>p<span class="_ _4"></span>erform<span class="_ _5"> </span>input<span class="_ _d"> </span>and</div><div class="t m0 x18 h7 y175d ff3 fs4 fc0 sc0 ls0 ws0">output<span class="_ _a"> </span>op<span class="_ _4"></span>erations<span class="_ _a"> </span>and<span class="_ _a"> </span>loading<span class="_ _a"> </span>and<span class="_ _3"> </span>sc<span class="_ _8"></span>heduling<span class="_ _3"> </span>user<span class="_ _a"> </span>applications<span class="_ _a"> </span>for<span class="_ _3"> </span>execution.<span class="_ _2d"> </span>The</div><div class="t m0 x18 h7 y175e ff3 fs4 fc0 sc0 ls0 ws0">user<span class="_ _3"> </span>soft<span class="_ _1"></span>w<span class="_ _1"></span>are<span class="_ _3"> </span>is<span class="_ _3"> </span>usually<span class="_ _3"> </span>limited<span class="_ _3"> </span>to<span class="_ _3"> </span>p<span class="_ _4"></span>erforming<span class="_ _a"> </span>op<span class="_ _4"></span>erations<span class="_ _3"> </span>with<span class="_ _3"> </span>data<span class="_ _3"> </span>that<span class="_ _3"> </span>is<span class="_ _3"> </span>lo<span class="_ _4"></span>cated</div><div class="t m0 x18 h7 y175f ff3 fs4 fc0 sc0 ls0 ws0">on<span class="_ _d"> </span>registers<span class="_ _d"> </span>and<span class="_ _a"> </span>the<span class="_ _d"> </span>main<span class="_ _a"> </span>memory<span class="_ _7"></span>.<span class="_ _1f"> </span>Whenever<span class="_ _2"> </span>the<span class="_ _a"> </span>user<span class="_ _d"> </span>softw<span class="_ _8"></span>are<span class="_ _d"> </span>needs<span class="_ _a"> </span>to<span class="_ _d"> </span>p<span class="_ _4"></span>erform<span class="_ _d"> </span>a</div><div class="t m0 x18 h7 y1760 ff3 fs4 fc0 sc0 ls0 ws0">pro<span class="_ _4"></span>cedure<span class="_ _d"> </span>that<span class="_ _a"> </span>requires<span class="_ _a"> </span>interacting<span class="_ _a"> </span>with<span class="_ _a"> </span>other<span class="_ _a"> </span>parts<span class="_ _a"> </span>of<span class="_ _3"> </span>the<span class="_ _a"> </span>system,<span class="_ _a"> </span>such<span class="_ _a"> </span>as<span class="_ _a"> </span>reading</div><div class="t m0 x18 h7 y1761 ff3 fs4 fc0 sc0 ls0 ws0">data from a<span class="_ _13"> </span>ﬁle or sho<span class="_ _8"></span>wing information on the computer<span class="_ _13"> </span>displa<span class="_ _8"></span>y<span class="_ _7"></span>,<span class="_ _5"> </span>it in<span class="_ _8"></span>vok<span class="_ _8"></span>es the system</div><div class="t m0 x18 h7 y1762 ff3 fs4 fc0 sc0 ls0 ws0">soft<span class="_ _1"></span>w<span class="_ _1"></span>are<span class="_ _2"> </span>to<span class="_ _2"> </span>p<span class="_ _4"></span>erform<span class="_ _5"> </span>the<span class="_ _2"> </span>pro<span class="_ _4"></span>cedure<span class="_ _5"> </span>on<span class="_ _2"> </span>its<span class="_ _2"> </span>b<span class="_ _4"></span>ehalf.</div><div class="t m0 xd h7 y1763 ff3 fs4 fc0 sc0 ls0 ws0">This<span class="_ _3"> </span>chapter<span class="_ _3"> </span>discusses<span class="_ _c"> </span>the<span class="_ _c"> </span>hardware<span class="_ _3"> </span>mechanisms<span class="_ _3"> </span>that<span class="_ _c"> </span>protect<span class="_ _c"> </span>the<span class="_ _3"> </span>system<span class="_ _c"> </span>from</div><div class="t m0 x18 h7 y1764 ff3 fs4 fc0 sc0 ls0 ws0">fault<span class="_ _1"></span>y<span class="_ _2"> </span>or<span class="_ _2"> </span>malicious<span class="_ _2"> </span>user<span class="_ _2"> </span>programs<span class="_ _2"> </span>and<span class="_ _2"> </span>ho<span class="_ _1"></span>w<span class="_ _2"> </span>to<span class="_ _2"> </span>program<span class="_ _2"> </span>these<span class="_ _2"> </span>mec<span class="_ _1"></span>hanisms.</div><div class="t m0 x18 hd y1765 ff6 fs3 fc0 sc0 ls0 ws0">11.1<span class="_ _36"> </span>Privilege<span class="_ _e"> </span>Lev<span class="_ _8"></span>els</div><div class="t m0 x18 h7 y1766 ff3 fs4 fc0 sc0 ls0 ws0">The Instruction Set Arc<span class="_ _8"></span>hitecture deﬁnes the set of resources that the soft<span class="_ _8"></span>ware can use</div><div class="t m0 x18 h7 y1767 ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _5"> </span>p<span class="_ _4"></span>erform<span class="_ _5"> </span>the<span class="_ _2"> </span>in<span class="_ _1"></span>tended<span class="_ _5"> </span>computation.<span class="_ _c"> </span>F<span class="_ _7"></span>or<span class="_ _5"> </span>example,<span class="_ _2"> </span>it<span class="_ _2"> </span>deﬁnes<span class="_ _5"> </span>the<span class="_ _2"> </span>set<span class="_ _5"> </span>of<span class="_ _2"> </span>instructions,</div><div class="t m0 x18 h7 y1768 ff3 fs4 fc0 sc0 ls0 ws0">their<span class="_ _2"> </span>b<span class="_ _4"></span>eha<span class="_ _8"></span>vior,<span class="_ _2"> </span>and<span class="_ _2"> </span>op<span class="_ _4"></span>erands,<span class="_ _5"> </span>including<span class="_ _2"> </span>the<span class="_ _2"> </span>set<span class="_ _2"> </span>of<span class="_ _2"> </span>registers.</div><div class="t m0 xd h7 y1769 ff3 fs4 fc0 sc0 ls0 ws0">The <span class="ff7">privilege<span class="_ _2"> </span>level<span class="_ _13"> </span></span>deﬁnes<span class="_ _5"> </span>which ISA resources (registers,<span class="_ _5"> </span>instructions,<span class="_ _5"> </span><span class="ff8">etc.</span>)<span class="_ _3"> </span>are</div><div class="t m0 x18 h7 y176a ff3 fs4 fc0 sc0 ls0 ws0">accessible<span class="_ _d"> </span>by<span class="_ _2"> </span>the<span class="_ _a"> </span>softw<span class="_ _8"></span>are.<span class="_ _1f"> </span>They<span class="_ _d"> </span>can<span class="_ _d"> </span>b<span class="_ _4"></span>e<span class="_ _d"> </span>used<span class="_ _d"> </span>to<span class="_ _a"> </span>restrict<span class="_ _d"> </span>the<span class="_ _a"> </span>soft<span class="_ _1"></span>w<span class="_ _1"></span>are<span class="_ _d"> </span>execution<span class="_ _d"> </span>and</div><div class="t m0 x18 h7 y176b ff3 fs4 fc0 sc0 ls0 ws0">protect the<span class="_ _5"> </span>system<span class="_ _5"> </span>from softw<span class="_ _8"></span>are<span class="_ _5"> </span>that<span class="_ _5"> </span>attempts to<span class="_ _5"> </span>p<span class="_ _4"></span>erform op<span class="_ _4"></span>erations not p<span class="_ _4"></span>ermitted.</div><div class="t m0 x18 h7 y176c ff3 fs4 fc0 sc0 ls0 ws0">F<span class="_ _7"></span>or<span class="_ _13"> </span>example, the<span class="_ _12"> </span>system can<span class="_ _13"> </span>b<span class="_ _4"></span>e<span class="_ _12"> </span>conﬁgured to<span class="_ _12"> </span>execute user<span class="_ _12"> </span>applications with<span class="_ _13"> </span>restricted</div><div class="t m0 x18 h7 y176d ff3 fs4 fc0 sc0 ls0 ws0">privilege lev<span class="_ _8"></span>els to prev<span class="_ _8"></span>ent them from<span class="_ _12"> </span>directly interacting with<span class="_ _12"> </span>p<span class="_ _4"></span>eripherals or accessing</div><div class="t m0 x18 h7 y176e ff3 fs4 fc0 sc0 ls0 ws0">sp<span class="_ _4"></span>ecial<span class="_ _3"> </span>micropro<span class="_ _4"></span>cessor<span class="_ _3"> </span>registers.<span class="_ _22"> </span>The<span class="_ _c"> </span>RISC-V<span class="_ _c"> </span>Instruction<span class="_ _3"> </span>Set<span class="_ _c"> </span>Architecture<span class="_ _3"> </span>deﬁnes</div><div class="t m0 x18 h7 y176f ff3 fs4 fc0 sc0 ls0 ws0">three<span class="_ _2"> </span>privilege<span class="_ _2"> </span>lev<span class="_ _1"></span>els:</div><div class="t m0 xd h7 y1770 ff4 fs4 fc0 sc0 ls0 ws0">•<span class="_ _f"> </span><span class="ff3">U:<span class="_ _2"> </span>User/Application;</span></div><div class="t m0 xd h7 y1771 ff4 fs4 fc0 sc0 ls0 ws0">•<span class="_ _f"> </span><span class="ff3">S:<span class="_ _2"> </span>Sup<span class="_ _4"></span>ervisor;<span class="_ _2"> </span>and</span></div><div class="t m0 xd h7 y1772 ff4 fs4 fc0 sc0 ls0 ws0">•<span class="_ _f"> </span><span class="ff3">M:<span class="_ _2"> </span>Machine</span></div><div class="t m0 xd h7 y1773 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _5"> </span><span class="ff7">Mac<span class="_ _8"></span>hine <span class="ff3">privilege<span class="_ _5"> </span>level has<span class="_ _5"> </span>the<span class="_ _5"> </span>highest<span class="_ _5"> </span>privileges,<span class="_ _5"> </span>allowing full<span class="_ _5"> </span>access<span class="_ _5"> </span>to<span class="_ _5"> </span>the</span></span></div><div class="t m0 x18 h7 y1774 ff3 fs4 fc0 sc0 ls0 ws0">hardw<span class="_ _1"></span>are.<span class="_ _3"> </span>The<span class="_ _2"> </span><span class="ff7">Sup<span class="_ _4"></span>ervisor </span>privilege<span class="_ _2"> </span>lev<span class="_ _1"></span>el<span class="_ _5"> </span>has<span class="_ _2"> </span>the<span class="_ _2"> </span>second-highest<span class="_ _2"> </span>privileges,<span class="_ _2"> </span>and<span class="_ _5"> </span>the</div><div class="t m0 x18 h7 y1775 ff7 fs4 fc0 sc0 ls0 ws0">User/Application <span class="ff3">privilege<span class="_ _2"> </span>level<span class="_ _5"> </span>has<span class="_ _2"> </span>the<span class="_ _2"> </span>least<span class="_ _2"> </span>privileges.</span></div><div class="t m0 xd h7 y681 ff3 fs4 fc0 sc0 ls0 ws0">A<span class="_ _3"> </span>RISC-V<span class="_ _3"> </span>hardware<span class="_ _3"> </span>platform<span class="_ _3"> </span>may<span class="_ _3"> </span>implemen<span class="_ _8"></span>t<span class="_ _c"> </span>a<span class="_ _3"> </span>subset<span class="_ _3"> </span>or<span class="_ _c"> </span>all<span class="_ _3"> </span>of<span class="_ _3"> </span>these<span class="_ _c"> </span>privilege</div><div class="t m0 x18 h7 y682 ff3 fs4 fc0 sc0 ls0 ws0">lev<span class="_ _1"></span>els.<span class="_ _24"> </span>F<span class="_ _2c"></span>or<span class="_ _f"> </span>example,<span class="_ _11"> </span>when<span class="_ _f"> </span>implementing<span class="_ _c"> </span>a<span class="_ _c"> </span>hardware<span class="_ _c"> </span>platform<span class="_ _f"> </span>for<span class="_ _f"> </span>a<span class="_ _c"> </span>compact<span class="_ _f"> </span>and</div><div class="t m0 x18 h7 y683 ff3 fs4 fc0 sc0 ls0 ws0">straigh<span class="_ _1"></span>tforw<span class="_ _1"></span>ard<span class="_ _2"> </span>em<span class="_ _1"></span>b<span class="_ _4"></span>edded<span class="_ _5"> </span>system,<span class="_ _2"> </span>only<span class="_ _2"> </span>the<span class="_ _2"> </span>Machine<span class="_ _5"> </span>privilege<span class="_ _2"> </span>level<span class="_ _5"> </span>may<span class="_ _2"> </span>be<span class="_ _d"> </span>required.</div><div class="t m0 x18 h7 yea ff3 fs4 fc0 sc0 ls0 ws0">On<span class="_ _a"> </span>the<span class="_ _3"> </span>other<span class="_ _3"> </span>hand,<span class="_ _3"> </span>when<span class="_ _3"> </span>implementing<span class="_ _a"> </span>a<span class="_ _3"> </span>hardw<span class="_ _8"></span>are<span class="_ _3"> </span>platform<span class="_ _3"> </span>for<span class="_ _3"> </span>a<span class="_ _a"> </span>system<span class="_ _3"> </span>that<span class="_ _3"> </span>re-</div><div class="t m0 x18 h7 yeb ff3 fs4 fc0 sc0 ls0 ws0">lies<span class="_ _d"> </span>on<span class="_ _d"> </span>an<span class="_ _d"> </span>op<span class="_ _4"></span>erating<span class="_ _2"> </span>system<span class="_ _d"> </span>to<span class="_ _d"> </span>manage<span class="_ _d"> </span>applications<span class="_ _d"> </span>(<span class="ff8">e.g.</span>,<span class="_ _d"> </span>a<span class="_ _d"> </span>computer<span class="_ _d"> </span>desktop),<span class="_ _d"> </span>it<span class="_ _d"> </span>is</div><div class="t m0 x18 h7 yec ff3 fs4 fc0 sc0 ls0 ws0">usually<span class="_ _a"> </span>useful<span class="_ _3"> </span>to<span class="_ _a"> </span>include<span class="_ _a"> </span>all<span class="_ _3"> </span>three<span class="_ _a"> </span>privilege<span class="_ _3"> </span>lev<span class="_ _1"></span>els<span class="_ _a"> </span>to<span class="_ _3"> </span>facilitate<span class="_ _a"> </span>the<span class="_ _3"> </span>operating<span class="_ _3"> </span>system</div><div class="t m0 x18 h7 y61 ff3 fs4 fc0 sc0 ls0 ws0">implemen<span class="_ _1"></span>tation.</div><div class="t m0 xa3 h7 yc ff3 fs4 fc0 sc0 ls0 ws0">127</div><a class="l" href="#pf42" data-dest-detail='[66,"XYZ",136.063,771.024,null]'><div class="d m1" style="border-style:none;position:absolute;left:193.088000px;bottom:551.592000px;width:6.973000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,113.65,null]'><div class="d m1" style="border-style:none;position:absolute;left:109.608000px;bottom:366.413000px;width:123.559000px;height:8.911000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",136.063,179.306,null]'><div class="d m1" style="border-style:none;position:absolute;left:124.708000px;bottom:327.954000px;width:70.824000px;height:11.955000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",136.063,179.306,null]'><div class="d m1" style="border-style:none;position:absolute;left:89.712000px;bottom:280.687000px;width:64.795000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,113.65,null]'><div class="d m1" style="border-style:none;position:absolute;left:299.459000px;bottom:268.732000px;width:126.935000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",136.063,179.306,null]'><div class="d m1" style="border-style:none;position:absolute;left:115.200000px;bottom:256.777000px;width:65.449000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",136.063,179.306,null]'><div class="d m1" style="border-style:none;position:absolute;left:170.240000px;bottom:175.632000px;width:61.220000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",136.063,179.306,null]'><div class="d m1" style="border-style:none;position:absolute;left:214.311000px;bottom:163.677000px;width:61.452000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",136.063,179.306,null]'><div class="d m1" style="border-style:none;position:absolute;left:421.382000px;bottom:139.664000px;width:38.827000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",136.063,179.306,null]'><div class="d m1" style="border-style:none;position:absolute;left:89.712000px;bottom:127.709000px;width:25.294000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",136.063,179.306,null]'><div class="d m1" style="border-style:none;position:absolute;left:321.658000px;bottom:115.753000px;width:61.530000px;height:10.849000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
