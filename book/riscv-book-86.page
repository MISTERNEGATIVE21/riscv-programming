<div id="pf56" class="pf w0 h0" data-page-no="56"><div class="pc pc56 w0 h0"><img class="bi x13 y194 we h20" alt="" src="bg56.png"/><div class="t m0 x13 h7 y15a ff3 fs4 fc0 sc0 ls0 ws0">CHAPTER<span class="_ _2"> </span>6.<span class="_ _22"> </span>THE<span class="_ _2"> </span>R<span class="_ _2c"></span>V32I<span class="_ _2"> </span>ISA</div><div class="t m0 x13 h7 y38 ff3 fs4 fc0 sc0 ls0 ws0">op<span class="_ _4"></span>code<span class="_ _a"> </span>and<span class="_ _3"> </span>other<span class="_ _a"> </span>parameters<span class="_ _a"> </span>(such<span class="_ _d"> </span>as<span class="_ _3"> </span>registers)<span class="_ _a"> </span>inside<span class="_ _a"> </span>a<span class="_ _3"> </span>single<span class="_ _a"> </span>32-bit<span class="_ _a"> </span>long<span class="_ _a"> </span>instruc-</div><div class="t m0 x13 h7 yed ff3 fs4 fc0 sc0 ls0 ws0">tion.<span class="_ _b"> </span>T<span class="_ _7"></span>o<span class="_ _3"> </span>ov<span class="_ _8"></span>ercome<span class="_ _3"> </span>this<span class="_ _3"> </span>limitation,<span class="_ _3"> </span>direct<span class="_ _3"> </span>target<span class="_ _3"> </span>addresses<span class="_ _3"> </span>are<span class="_ _3"> </span>enco<span class="_ _4"></span>ded<span class="_ _a"> </span>as<span class="_ _3"> </span>an<span class="_ _3"> </span>oﬀset</div><div class="t m0 x13 h7 yee ff3 fs4 fc0 sc0 ls0 ws0">that<span class="_ _a"> </span>is<span class="_ _3"> </span>added<span class="_ _a"> </span>to<span class="_ _3"> </span>the<span class="_ _3"> </span>program<span class="_ _a"> </span>counter</div><div class="t m0 x85 h11 yee0 ffc fs7 fc0 sc0 ls0 ws0">15</div><div class="t m0 x1a h7 yee ff3 fs4 fc0 sc0 ls0 ws0">(PC)<span class="_ _a"> </span>when<span class="_ _3"> </span>the<span class="_ _a"> </span>instruction<span class="_ _3"> </span>is<span class="_ _3"> </span>executed.<span class="_ _10"> </span>In</div><div class="t m0 x13 h7 y116 ff3 fs4 fc0 sc0 ls0 ws0">R<span class="_ _2c"></span>V32I, the<span class="_ _5"> </span>target address<span class="_ _5"> </span>of conditional<span class="_ _5"> </span>control-ﬂo<span class="_ _8"></span>w instructions<span class="_ _5"> </span>is enco<span class="_ _4"></span>ded as<span class="_ _5"> </span>12-bit</div><div class="t m0 x13 h7 y29d ff3 fs4 fc0 sc0 ls0 ws0">signed oﬀsets.<span class="_ _3"> </span>Using a 12-bit oﬀset to enco<span class="_ _4"></span>de the target prev<span class="_ _8"></span>ents the instruction from</div><div class="t m0 x13 h7 y49d ff3 fs4 fc0 sc0 ls0 ws0">jumping<span class="_ _5"> </span>to<span class="_ _2"> </span>addresses<span class="_ _2"> </span>that<span class="_ _5"> </span>are<span class="_ _2"> </span>to<span class="_ _4"></span>o<span class="_ _5"> </span>far<span class="_ _2"> </span>aw<span class="_ _8"></span>ay<span class="_ _5"> </span>from<span class="_ _5"> </span>the<span class="_ _2"> </span>address<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _5"> </span>instruction<span class="_ _2"> </span>itself.</div><div class="t m0 x13 h7 y49e ff3 fs4 fc0 sc0 ls0 ws0">In<span class="_ _5"> </span>these cases,<span class="_ _2"> </span>the<span class="_ _5"> </span>programmer loads<span class="_ _5"> </span>the<span class="_ _5"> </span>target<span class="_ _5"> </span>address<span class="_ _5"> </span>into a<span class="_ _5"> </span>register<span class="_ _5"> </span>and,<span class="_ _2"> </span>then,<span class="_ _5"> </span>use</div><div class="t m0 x13 h7 y49f ff3 fs4 fc0 sc0 ls0 ws0">an<span class="_ _2"> </span>indirect<span class="_ _2"> </span>jump<span class="_ _2"> </span>instruction<span class="_ _2"> </span>to<span class="_ _2"> </span>jump<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>target<span class="_ _2"> </span>address.</div><div class="t m0 x13 ha yee1 ff6 fs6 fc0 sc0 ls0 ws0">6.7.3<span class="_ _17"> </span>Unconditional<span class="_ _c"> </span>con<span class="_ _8"></span>trol-ﬂow<span class="_ _3"> </span>instructions</div><div class="t m0 x13 h7 yee2 ff7 fs4 fc0 sc0 ls0 ws0">Unconditional<span class="_ _3"> </span>control-ﬂo<span class="_ _8"></span>w<span class="_ _c"> </span>instructions<span class="_ _3"> </span>are<span class="_ _c"> </span>con<span class="_ _1"></span>trol-ﬂo<span class="_ _8"></span>w<span class="_ _c"> </span>instructions<span class="_ _c"> </span>that</div><div class="t m0 x13 h7 yee3 ff7 fs4 fc0 sc0 ls0 ws0">alw<span class="_ _8"></span>ays<span class="_ _3"> </span>c<span class="_ _8"></span>hange<span class="_ _3"> </span>the<span class="_ _c"> </span>execution<span class="_ _3"> </span>ﬂo<span class="_ _1"></span>w<span class="_ _3"> </span>to<span class="_ _3"> </span>a<span class="_ _3"> </span>given<span class="_ _a"> </span>target<span class="ff3">.<span class="_ _1f"> </span>F<span class="_ _7"></span>or<span class="_ _d"> </span>example,<span class="_ _a"> </span>the<span class="_ _d"> </span>“<span class="ff5">j<span class="_ _e"> </span>L</span>”</span></div><div class="t m0 x13 h7 yee4 ff3 fs4 fc0 sc0 ls0 ws0">instruction is<span class="_ _5"> </span>a<span class="_ _5"> </span>control-ﬂo<span class="_ _8"></span>w<span class="_ _5"> </span>instruction<span class="_ _5"> </span>that<span class="_ _5"> </span>alwa<span class="_ _8"></span>ys<span class="_ _5"> </span>jumps<span class="_ _5"> </span>to<span class="_ _5"> </span>lab<span class="_ _4"></span>el <span class="ff5">L</span>.<span class="_ _5"> </span>In<span class="_ _5"> </span>the<span class="_ _5"> </span>following</div><div class="t m0 x13 h7 yee5 ff3 fs4 fc0 sc0 ls0 ws0">co<span class="_ _4"></span>de,<span class="_ _12"> </span>the<span class="_ _12"> </span><span class="ff5">j<span class="_ _13"> </span></span>instruction<span class="_ _12"> </span>(line<span class="_ _13"> </span>2)<span class="_ _12"> </span>jumps<span class="_ _12"> </span>to label<span class="_ _12"> </span>, hence,<span class="_ _12"> </span>after executing<span class="_ _12"> </span>the<span class="_ _12"> </span><span class="ff5">j<span class="_ _12"> </span></span>instruction,</div><div class="t m0 x13 h7 yee6 ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _2"> </span>pro<span class="_ _4"></span>cessor<span class="_ _5"> </span>executes<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff5">sub<span class="_ _2"> </span></span>instruction<span class="_ _2"> </span>(line<span class="_ _2"> </span>7).</div><div class="t m0 xd5 h8 yee7 ff24 fs12 fc0 sc0 ls0 ws0">1<span class="_ _1f"> </span><span class="ff5 fs4">div<span class="_ _e"> </span>a0,<span class="_ _11"> </span>a1,<span class="_ _e"> </span>a2</span></div><div class="t m0 xd5 h8 yee8 ff24 fs12 fc0 sc0 ls0 ws0">2<span class="_ _1f"> </span><span class="ff5 fs4">j<span class="_ _3f"> </span>FOO</span></div><div class="t m0 xd5 h8 yee9 ff24 fs12 fc0 sc0 ls0 ws0">3<span class="_ _1f"> </span><span class="ff5 fs4">add<span class="_ _e"> </span>a0,<span class="_ _11"> </span>a0,<span class="_ _e"> </span>a1</span></div><div class="t m0 xd5 h8 yeea ff24 fs12 fc0 sc0 ls0 ws0">4<span class="_ _1f"> </span><span class="ff5 fs4">mul<span class="_ _e"> </span>a0,<span class="_ _11"> </span>a1,<span class="_ _e"> </span>a2</span></div><div class="t m0 xd5 h38 yeeb ff24 fs12 fc0 sc0 ls0 ws0">5</div><div class="t m0 xd5 h8 yeec ff24 fs12 fc0 sc0 ls0 ws0">6<span class="_ _1f"> </span><span class="ff5 fs4">FOO:</span></div><div class="t m0 xd5 h8 yeed ff24 fs12 fc0 sc0 ls0 ws0">7<span class="_ _1f"> </span><span class="ff5 fs4">sub<span class="_ _e"> </span>a0,<span class="_ _11"> </span>a1,<span class="_ _e"> </span>a2</span></div><div class="t m0 xd5 h8 yeee ff24 fs12 fc0 sc0 ls0 ws0">8<span class="_ _1f"> </span><span class="ff5 fs4">#<span class="_ _e"> </span>...</span></div><div class="t m0 x14 h7 yeef ff7 fs4 fc0 sc0 ls0 ws0">NOTE:<span class="_ _1a"> </span><span class="ff3">In<span class="_ _a"> </span>the<span class="_ _c"> </span>RISC-V<span class="_ _3"> </span>ISA<span class="_ _c"> </span>manual<span class="_ _3"> </span>[4],<span class="_ _c"> </span>W<span class="_ _7"></span>aterman<span class="_ _3"> </span>and<span class="_ _c"> </span>Asanovi<span class="_ _8"></span>´<span class="_ _7b"></span>c<span class="_ _c"> </span>use<span class="_ _3"> </span>the</span></div><div class="t m0 x14 h7 yef0 ff3 fs4 fc0 sc0 ls0 ws0">term<span class="_ _13"> </span>“unconditional<span class="_ _13"> </span>jumps”<span class="_ _12"> </span>to refer<span class="_ _12"> </span>to unconditional<span class="_ _12"> </span>control-ﬂo<span class="_ _8"></span>w instructions.</div><div class="t m0 x14 h7 ycc3 ff3 fs4 fc0 sc0 ls0 ws0">There are sev<span class="_ _8"></span>eral unconditional control-ﬂo<span class="_ _8"></span>w instructions in the R<span class="_ _2c"></span>V32I . T<span class="_ _7"></span>able 6.11</div><div class="t m0 x13 h7 ycc5 ff3 fs4 fc0 sc0 ls0 ws0">sho<span class="_ _1"></span>ws<span class="_ _2"> </span>the<span class="_ _2"> </span>R<span class="_ _2c"></span>V32I<span class="_ _2"> </span>unconditional<span class="_ _2"> </span>con<span class="_ _1"></span>trol-ﬂo<span class="_ _1"></span>w<span class="_ _2"> </span>instructions<span class="_ _2"> </span>and<span class="_ _2"> </span>pseudo-instructions.</div><div class="t m0 x20 h7 yef1 ff3 fs4 fc0 sc0 ls0 ws0">Instruction<span class="_ _be"> </span>Description</div><div class="t m0 x20 h8 yef2 ff5 fs4 fc0 sc0 ls0 ws0">j<span class="_ _11"> </span>lab</div><div class="t m0 xe5 h7 yef3 ff3 fs4 fc0 sc0 ls0 ws0">Jumps<span class="_ _11"> </span>to<span class="_ _11"> </span>address<span class="_ _e"> </span>indicated<span class="_ _11"> </span>by<span class="_ _11"> </span>sym<span class="_ _1"></span>b<span class="_ _4"></span>ol<span class="_ _f"> </span><span class="ff5">sym<span class="_ _e"> </span></span>(pseudo-</div><div class="t m0 xe5 h7 yef4 ff3 fs4 fc0 sc0 ls0 ws0">instruction).</div><div class="t m0 x20 h8 yef5 ff5 fs4 fc0 sc0 ls0 ws0">jr<span class="_ _11"> </span>rs1</div><div class="t m0 xe5 h7 yef6 ff3 fs4 fc0 sc0 ls0 ws0">Jumps<span class="_ _3"> </span>to<span class="_ _3"> </span>the<span class="_ _3"> </span>address<span class="_ _3"> </span>stored<span class="_ _c"> </span>on<span class="_ _3"> </span>register<span class="_ _3"> </span><span class="ff5">rs1<span class="_ _3"> </span></span>(pseudo-</div><div class="t m0 xe5 h7 yef7 ff3 fs4 fc0 sc0 ls0 ws0">instruction).</div><div class="t m0 x20 h8 yef8 ff5 fs4 fc0 sc0 ls0 ws0">jal<span class="_ _11"> </span>lab</div><div class="t m0 xe5 h7 yef9 ff3 fs4 fc0 sc0 ls0 ws0">Stores the return<span class="_ _13"> </span>address (PC+4) on<span class="_ _13"> </span>the return register</div><div class="t m0 xe5 h7 yefa ff3 fs4 fc0 sc0 ls0 ws0">(<span class="ff5">ra</span>),<span class="_ _2"> </span>then<span class="_ _2"> </span>jumps<span class="_ _2"> </span>to<span class="_ _2"> </span>lab<span class="_ _4"></span>el<span class="_ _5"> </span><span class="ff5">lab<span class="_ _2"> </span></span>(pseudo-instruction).</div><div class="t m0 x20 h8 yefb ff5 fs4 fc0 sc0 ls0 ws0">jal<span class="_ _11"> </span>rd,<span class="_ _e"> </span>lab</div><div class="t m0 xe5 h7 yefc ff3 fs4 fc0 sc0 ls0 ws0">Stores<span class="_ _d"> </span>the<span class="_ _d"> </span>return<span class="_ _a"> </span>address<span class="_ _d"> </span>(PC+4)<span class="_ _a"> </span>on<span class="_ _d"> </span>register<span class="_ _d"> </span><span class="ff5">rd</span>,<span class="_ _a"> </span>then</div><div class="t m0 xe5 h7 yefd ff3 fs4 fc0 sc0 ls0 ws0">jumps<span class="_ _2"> </span>to<span class="_ _2"> </span>lab<span class="_ _4"></span>el<span class="_ _5"> </span><span class="ff5">lab</span>.</div><div class="t m0 x20 h8 yefe ff5 fs4 fc0 sc0 ls0 ws0">jarl<span class="_ _11"> </span>rd,<span class="_ _e"> </span>rs1,<span class="_ _e"> </span>imm</div><div class="t m0 xe5 h7 yeff ff3 fs4 fc0 sc0 ls0 ws0">Stores<span class="_ _d"> </span>the<span class="_ _d"> </span>return<span class="_ _a"> </span>address<span class="_ _d"> </span>(PC+4)<span class="_ _a"> </span>on<span class="_ _d"> </span>register<span class="_ _d"> </span><span class="ff5">rd</span>,<span class="_ _a"> </span>then</div><div class="t m0 xe5 h7 yefe ff3 fs4 fc0 sc0 ls0 ws0">jumps<span class="_ _5"> </span>to<span class="_ _2"> </span>the<span class="_ _5"> </span>address<span class="_ _2"> </span>calculated<span class="_ _5"> </span>by<span class="_ _5"> </span>adding<span class="_ _5"> </span>the<span class="_ _2"> </span>immedi-</div><div class="t m0 xe5 h7 yf00 ff3 fs4 fc0 sc0 ls0 ws0">ate<span class="_ _2"> </span>v<span class="_ _8"></span>alue<span class="_ _2"> </span><span class="ff5">imm<span class="_ _2"> </span></span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>v<span class="_ _8"></span>alue<span class="_ _2"> </span>on<span class="_ _2"> </span>register<span class="_ _2"> </span><span class="ff5">rs1</span>.</div><div class="t m0 x20 h8 yf01 ff5 fs4 fc0 sc0 ls0 ws0">ret</div><div class="t m0 xe5 h7 yf02 ff3 fs4 fc0 sc0 ls0 ws0">Jumps<span class="_ _5"> </span>to<span class="_ _5"> </span>the<span class="_ _5"> </span>address<span class="_ _5"> </span>stored<span class="_ _5"> </span>on<span class="_ _2"> </span>the return<span class="_ _2"> </span>register<span class="_ _5"> </span>(<span class="ff5">ra</span>)</div><div class="t m0 xe5 h7 yf03 ff3 fs4 fc0 sc0 ls0 ws0">(pseudo-instruction).</div><div class="t m0 x57 h7 yf04 ff3 fs4 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>able<span class="_ _2"> </span>6.11:<span class="_ _3"> </span>R<span class="_ _2c"></span>V32I<span class="_ _2"> </span>unconditional<span class="_ _2"> </span>control-ﬂo<span class="_ _8"></span>w<span class="_ _2"> </span>instructions</div><div class="t m0 x14 h7 yf05 ff3 fs4 fc0 sc0 ls0 ws0">Instruction<span class="_ _2"> </span>“<span class="ff5">j<span class="_ _e"> </span>lab</span>”<span class="_ _2"> </span>jumps<span class="_ _2"> </span>to<span class="_ _d"> </span>lab<span class="_ _4"></span>el<span class="_ _2"> </span><span class="ff5">lab<span class="_ _2"> </span></span>while<span class="_ _2"> </span>instruction<span class="_ _d"> </span>“<span class="ff5">jr<span class="_ _11"> </span>rs1</span>”<span class="_ _2"> </span>jumps<span class="_ _d"> </span>to<span class="_ _2"> </span>the</div><div class="t m0 x13 h7 yf06 ff3 fs4 fc0 sc0 ls0 ws0">address<span class="_ _2"> </span>stored<span class="_ _2"> </span>on<span class="_ _2"> </span>register<span class="_ _2"> </span><span class="ff5">rs1</span>.</div><div class="t m0 x13 h7 yf07 ff7 fs4 fc0 sc0 ls0 ws0">Jump<span class="_ _d"> </span>and<span class="_ _a"> </span>Link</div><div class="t m0 x13 h7 yf08 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _a"> </span>jump<span class="_ _a"> </span>and<span class="_ _a"> </span>link<span class="_ _3"> </span>instruction<span class="_ _a"> </span>(<span class="ff5">jal<span class="_ _11"> </span>rd,<span class="_ _e"> </span>lab</span>)<span class="_ _a"> </span>stores<span class="_ _3"> </span>the<span class="_ _a"> </span>address<span class="_ _a"> </span>of<span class="_ _a"> </span>the<span class="_ _a"> </span>subsequent</div><div class="t m0 x13 h7 yf09 ff3 fs4 fc0 sc0 ls0 ws0">instruction<span class="_ _a"> </span>(<span class="ff8">i.e.</span>,<span class="_ _c"> </span>PC+4)<span class="_ _a"> </span>in<span class="_ _3"> </span>register<span class="_ _3"> </span><span class="ff5">rd<span class="_ _a"> </span></span>and<span class="_ _3"> </span>then<span class="_ _3"> </span>jumps<span class="_ _a"> </span>to<span class="_ _3"> </span>lab<span class="_ _4"></span>el<span class="_ _a"> </span><span class="ff5">lab</span>.<span class="_ _10"> </span>This<span class="_ _3"> </span>pro<span class="_ _4"></span>cess,</div><div class="t m0 x7d h1e y21b ff12 fse fc0 sc0 ls0 ws0">15</div><div class="t m0 x14 h1f y21c ff13 fsf fc0 sc0 ls0 ws0">The<span class="_ _3a"> </span>program coun<span class="_ _8"></span>ter<span class="_ _12"> </span>con<span class="_ _8"></span>tains<span class="_ _12"> </span>the<span class="_ _3a"> </span>address<span class="_ _3a"> </span>of<span class="_ _12"> </span>the<span class="_ _3a"> </span>currently<span class="_ _3a"> </span>executing<span class="_ _12"> </span>instruction.<span class="_ _5"> </span>When executing</div><div class="t m0 x13 h1f y61 ff13 fsf fc0 sc0 ls0 ws0">a<span class="_ _38"> </span>control-ﬂo<span class="_ _8"></span>w<span class="_ _38"> </span>instruction<span class="_ _5"> </span>it<span class="_ _38"> </span>contains<span class="_ _13"> </span>the<span class="_ _38"> </span>address<span class="_ _5"> </span>of<span class="_ _38"> </span>the<span class="_ _38"> </span>said<span class="_ _38"> </span>instruction.</div><div class="t m0 x43 h7 yc ff5 fs4 fc0 sc0 ls0 ws0">http://riscv-<span class="_ _4"></span>programming.org<span class="_ _2"> </span><span class="ff3">(V<span class="_ _7"></span>ersion:<span class="_ _c"> </span>August<span class="_ _5"> </span>21,<span class="_ _d"> </span>2021)<span class="_ _6f"> </span>72</span></div><a class="l" href="#pf56" data-dest-detail='[86,"XYZ",151.306,89.795,null]'><div class="d m1" style="border-style:none;position:absolute;left:302.145000px;bottom:733.664000px;width:10.433000px;height:12.593000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf93" data-dest-detail='[147,"XYZ",90.709,546.583,null]'><div class="d m1" style="border-style:none;position:absolute;left:327.215000px;bottom:442.088000px;width:6.974000px;height:8.413000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,113.65,null]'><div class="d m1" style="border-style:none;position:absolute;left:453.532000px;bottom:403.968000px;width:1.992000px;height:8.911000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf56" data-dest-detail='[86,"XYZ",136.063,386.369,null]'><div class="d m1" style="border-style:none;position:absolute;left:485.859000px;bottom:403.968000px;width:19.704000px;height:8.911000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.437,null]'><div class="d m1" style="border-style:none;position:absolute;left:461.426000px;bottom:244.756000px;width:37.415000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",90.709,146.437,null]'><div class="d m1" style="border-style:none;position:absolute;left:257.323000px;bottom:231.151000px;width:41.013000px;height:12.498000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:185.308000px;bottom:36.395000px;width:148.940000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
