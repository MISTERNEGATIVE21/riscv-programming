<div id="pf39" class="pf w0 h0" data-page-no="39"><div class="pc pc39 w0 h0"><img class="bi x17 ya7a wb h80" alt="" src="bg39.png"/><div class="t m0 x17 h7 y147 ff3 fs4 fc0 sc0 ls0 ws0">CHAPTER<span class="_ _2"> </span>4.<span class="_ _19"> </span>ASSEMBL<span class="_ _7"></span>Y<span class="_ _2"> </span>LANGUAGE</div><div class="c x56 ya7b w19 h7b"><div class="t m0 x11b h7c ya7c ff4a fs31 fc0 sc0 ls0 ws0">Machine instruction</div><div class="t m0 xd8 h7e ya7d ff4b fs31 fc0 sc0 ls0 ws0">0x00008067</div><div class="t m0 x25 h7c ya40 ff4a fs31 fc0 sc0 ls0 ws0">Contents<span class="_ _0"> </span>Address</div><div class="t m0 x101 h7e ya6d ff4c fs31 fc0 sc0 ls0 ws0">00010011</div><div class="t m0 x7c h7f ya6e ff4c fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya41 ff4d fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 x101 h7e ya6f ff4c fs31 fc0 sc0 ls0 ws0">00000101</div><div class="t m0 x7c h7f ya70 ff4c fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya42 ff4d fs31 fc0 sc0 ls0 ws0">001</div><div class="t m0 x101 h7e ya71 ff4c fs31 fc0 sc0 ls0 ws0">10100101</div><div class="t m0 x7c h7f ya72 ff4c fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya43 ff4d fs31 fc0 sc0 ls0 ws0">002</div><div class="t m0 x101 h7e ya73 ff4c fs31 fc0 sc0 ls0 ws0">00000010</div><div class="t m0 x7c h7f ya74 ff4c fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya44 ff4d fs31 fc0 sc0 ls0 ws0">003</div><div class="t m0 x101 h7e ya7e ff4c fs31 fc2 sc0 ls0 ws0">01100111</div><div class="t m0 x7c h7f ya7f ff4c fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya45 ff4d fs31 fc0 sc0 ls0 ws0">004</div><div class="t m0 x101 h7e ya80 ff4c fs31 fc2 sc0 ls0 ws0">10000000</div><div class="t m0 x7c h7f ya81 ff4c fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya46 ff4d fs31 fc0 sc0 ls0 ws0">005</div><div class="t m0 x101 h7e ya82 ff4c fs31 fc2 sc0 ls0 ws0">00000000</div><div class="t m0 x7c h7f ya83 ff4c fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya47 ff4d fs31 fc0 sc0 ls0 ws0">006</div><div class="t m0 x101 h7e ya84 ff4c fs31 fc2 sc0 ls0 ws0">00000000</div><div class="t m0 x7c h7f ya85 ff4c fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya48 ff4d fs31 fc0 sc0 ls0 ws0">007</div><div class="t m0 xf h7d ya49 ff4d fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x25 h7c ya4a ff4a fs31 fc0 sc0 ls0 ws0">Location </div><div class="t m0 x25 h7c ya4b ff4a fs31 fc0 sc0 ls0 ws0">counter:</div><div class="t m0 xf h7d ya4a ff4d fs31 fc0 sc0 ls0 ws0">004</div><div class="t m0 xf h7d ya4b ff4e fs31 fc2 sc0 ls0 ws0">008</div><div class="t m0 x26 h7c ya4d ff4b fs31 fc0 sc0 ls0 ws0">.text<span class="ff4a"> section</span></div><div class="t m0 xf6 h7c ya4e ff4a fs31 fc0 sc0 ls0 ws0">Symbol table</div><div class="t m0 xfd h7e ya60 ff4b fs31 fc0 sc0 ls0 ws0">sum42<span class="_ _93"> </span>000</div><div class="t m0 xf8 h7d ya4f ff4d fs31 fc0 sc0 ls0 ws0">sum42:</div><div class="t m0 xf8 h7d ya50 ff4d fs31 fc0 sc0 ls0 ws0">  addi a0, a0, 42 </div><div class="t m0 xf8 h7d ya51 ff4e fs31 fc0 sc0 ls0 ws0">  <span class="fc2">ret</span></div><div class="t m0 x11a h7c ya52 ff4a fs31 fc0 sc0 ls0 ws0">Input file</div><div class="t m0 x49 h7c ya86 ff4a fs31 fc1 sc0 ls0 ws0">1</div><div class="t m0 x4b h7c ya87 ff4a fs31 fc1 sc0 ls0 ws0">2</div><div class="t m0 xa h7c ya78 ff4a fs31 fc1 sc0 ls0 ws0">3</div><div class="t m0 x56 h7c ya40 ff4a fs31 fc0 sc0 ls0 ws0">Contents<span class="_ _0"> </span>Address</div><div class="t m0 xe1 h7d ya41 ff4d fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 xe1 h7d ya42 ff4d fs31 fc0 sc0 ls0 ws0">001</div><div class="t m0 xe1 h7d ya43 ff4d fs31 fc0 sc0 ls0 ws0">002</div><div class="t m0 xe1 h7d ya44 ff4d fs31 fc0 sc0 ls0 ws0">003</div><div class="t m0 xe1 h7d ya45 ff4d fs31 fc0 sc0 ls0 ws0">004</div><div class="t m0 xe1 h7d ya46 ff4d fs31 fc0 sc0 ls0 ws0">005</div><div class="t m0 xe1 h7d ya47 ff4d fs31 fc0 sc0 ls0 ws0">006</div><div class="t m0 xe1 h7d ya48 ff4d fs31 fc0 sc0 ls0 ws0">007</div><div class="t m0 xe1 h7d ya49 ff4d fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x56 h7c ya4a ff4a fs31 fc0 sc0 ls0 ws0">Location </div><div class="t m0 x47 h7c ya4b ff4a fs31 fc0 sc0 ls0 ws0">counter:</div><div class="t m0 xe1 h7d ya4c ff4d fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 x47 h7c ya4d ff4b fs31 fc0 sc0 ls0 ws0">.data<span class="ff4a"> section</span></div><div class="t m0 xa h7d ya53 ff4d fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x26 h7c ya54 ff4a fs31 fc0 sc0 ls0 ws0">Active section</div></div><div class="t m0 x11 h7 ya88 ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _2"> </span>4.4:<span class="_ _3"> </span>Pro<span class="_ _4"></span>cessing<span class="_ _2"> </span>the<span class="_ _2"> </span>last<span class="_ _2"> </span>assembly<span class="_ _5"> </span>instruction.</div><div class="t m0 x13 h7 ya89 ff3 fs4 fc0 sc0 ls0 ws0">Once<span class="_ _2f"> </span>all<span class="_ _30"> </span>elements<span class="_ _30"> </span>from the<span class="_ _30"> </span>input<span class="_ _2f"> </span>ﬁle<span class="_ _30"> </span>are processed, the<span class="_ _30"> </span>assembler<span class="_ _30"> </span>stores<span class="_ _2f"> </span>the<span class="_ _30"> </span>section</div><div class="t m0 x17 h7 ya8a ff3 fs4 fc0 sc0 ls0 ws0">con<span class="_ _1"></span>ten<span class="_ _1"></span>ts,<span class="_ _a"> </span>the<span class="_ _a"> </span>sym<span class="_ _1"></span>b<span class="_ _4"></span>ol<span class="_ _3"> </span>table,<span class="_ _a"> </span>and<span class="_ _3"> </span>other<span class="_ _a"> </span>relev<span class="_ _8"></span>ant<span class="_ _3"> </span>information<span class="_ _3"> </span>(such<span class="_ _3"> </span>as<span class="_ _3"> </span>the<span class="_ _a"> </span>relo<span class="_ _4"></span>cation</div><div class="t m0 x17 h7 ya8b ff3 fs4 fc0 sc0 ls0 ws0">records),<span class="_ _2"> </span>on<span class="_ _2"> </span>the<span class="_ _2"> </span>ob<span class="_ _4"></span>ject<span class="_ _2"> </span>ﬁle.</div><div class="t m0 x17 hd ya8c ff7 fs3 fc0 sc0 ls0 ws0">4.7<span class="_ _32"> </span>Assem<span class="_ _8"></span>bly<span class="_ _31"> </span>directives</div><div class="t m0 x17 h7 ya8d ff3 fs4 fc0 sc0 ls0 ws0">Assem<span class="_ _1"></span>bly<span class="_ _b"> </span>directiv<span class="_ _8"></span>es<span class="_ _b"> </span>are<span class="_ _b"> </span>commands<span class="_ _b"> </span>used<span class="_ _b"> </span>to<span class="_ _2"> </span>control<span class="_ _b"> </span>the<span class="_ _2"> </span>assembler.<span class="_ _16"> </span>F<span class="_ _7"></span>or<span class="_ _b"> </span>example,<span class="_ _b"> </span>the</div><div class="t m0 x17 h7 ya8e ff5 fs4 fc0 sc0 ls0 ws0">.section<span class="_ _9"> </span>.data<span class="_ _2"> </span><span class="ff3">directive<span class="_ _5"> </span>instructs<span class="_ _2"> </span>the<span class="_ _2"> </span>assembler<span class="_ _5"> </span>to<span class="_ _2"> </span>turn<span class="_ _2"> </span>the<span class="_ _2"> </span></span>.data<span class="_ _2"> </span><span class="ff3">section<span class="_ _2"> </span>into<span class="_ _5"> </span>the</span></div><div class="t m0 x17 h7 ya8f ff3 fs4 fc0 sc0 ls0 ws0">activ<span class="_ _1"></span>e section,<span class="_ _2f"> </span>and<span class="_ _2f"> </span>the <span class="ff5">.word<span class="_ _9"> </span>10<span class="_ _2f"> </span></span>directiv<span class="_ _1"></span>e instructs<span class="_ _30"> </span>the assem<span class="_ _8"></span>bler to assem<span class="_ _8"></span>ble a<span class="_ _30"> </span>32-bit</div><div class="t m0 x17 h7 ya90 ff3 fs4 fc0 sc0 ls0 ws0">v<span class="_ _8"></span>alue<span class="_ _2"> </span>(10)<span class="_ _2"> </span>and<span class="_ _2"> </span>add<span class="_ _2"> </span>it<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>activ<span class="_ _1"></span>e<span class="_ _2"> </span>section.</div><div class="t m0 x13 h7 ya91 ff3 fs4 fc0 sc0 ls0 ws0">Assem<span class="_ _1"></span>bly<span class="_ _3"> </span>directives<span class="_ _3"> </span>are<span class="_ _a"> </span>usually<span class="_ _3"> </span>enco<span class="_ _4"></span>ded<span class="_ _3"> </span>as<span class="_ _a"> </span>a<span class="_ _3"> </span>string<span class="_ _a"> </span>that<span class="_ _a"> </span>contains<span class="_ _3"> </span>the<span class="_ _3"> </span>directive</div><div class="t m0 x17 h7 ya92 ff3 fs4 fc0 sc0 ls0 ws0">name<span class="_ _3"> </span>and<span class="_ _3"> </span>its<span class="_ _3"> </span>arguments.<span class="_ _15"> </span>On<span class="_ _a"> </span>GNU<span class="_ _3"> </span>assemblers,<span class="_ _3"> </span>directive<span class="_ _3"> </span>names<span class="_ _3"> </span>con<span class="_ _1"></span>tain<span class="_ _3"> </span>a<span class="_ _3"> </span>dot<span class="_ _3"> </span>(‘.’)</div><div class="t m0 x17 h7 ya93 ff3 fs4 fc0 sc0 ls0 ws0">preﬁx.<span class="_ _3"> </span>The<span class="_ _2"> </span>next<span class="_ _2"> </span>sections<span class="_ _2"> </span>discuss<span class="_ _5"> </span>some<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>most<span class="_ _5"> </span>common<span class="_ _2"> </span>directives<span class="_ _5"> </span>used<span class="_ _2"> </span>to<span class="_ _5"> </span>imple-</div><div class="t m0 x17 h7 ya94 ff3 fs4 fc0 sc0 ls0 ws0">men<span class="_ _1"></span>t<span class="_ _2"> </span>assem<span class="_ _1"></span>bly<span class="_ _2"> </span>programs.</div><div class="t m0 x17 ha ya95 ff7 fs6 fc0 sc0 ls0 ws0">4.7.1<span class="_ _e"> </span>Adding<span class="_ _a"> </span>v<span class="_ _7"></span>alues<span class="_ _a"> </span>to<span class="_ _a"> </span>the<span class="_ _a"> </span>program</div><div class="t m0 x17 h7 ya96 ff3 fs4 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>able<span class="_ _b"> </span>4.1<span class="_ _b"> </span>contains<span class="_ _b"> </span>a<span class="_ _b"> </span>list<span class="_ _b"> </span>of<span class="_ _b"> </span>assem<span class="_ _1"></span>bly<span class="_ _b"> </span>directiv<span class="_ _1"></span>es<span class="_ _b"> </span>that<span class="_ _b"> </span>can<span class="_ _b"> </span>b<span class="_ _4"></span>e<span class="_ _b"> </span>used<span class="_ _b"> </span>to<span class="_ _b"> </span>add<span class="_ _b"> </span>v<span class="_ _8"></span>alues<span class="_ _b"> </span>to<span class="_ _b"> </span>a</div><div class="t m0 x17 h7 ya97 ff3 fs4 fc0 sc0 ls0 ws0">program.</div><div class="t m0 x1f h7 ya98 ff3 fs4 fc0 sc0 ls0 ws0">Directiv<span class="_ _1"></span>e<span class="_ _1c"> </span>Arguments<span class="_ _94"> </span>Description</div><div class="t m0 xe h7 ya99 ff5 fs4 fc0 sc0 ls0 ws0">.byte<span class="_ _1c"> </span><span class="ff3">expression<span class="_ _2"> </span>[,<span class="_ _2"> </span>expression]*<span class="_ _18"> </span>Emit<span class="_ _3"> </span>one<span class="_ _b"> </span>or<span class="_ _3"> </span>more<span class="_ _b"> </span>8-bit<span class="_ _3"> </span>comma<span class="_ _b"> </span>separated</span></div><div class="t m0 x19 h7 ya9a ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>ords</div><div class="t m0 xe h7 ya9b ff5 fs4 fc0 sc0 ls0 ws0">.half<span class="_ _1c"> </span><span class="ff3">expression<span class="_ _2"> </span>[,<span class="_ _2"> </span>expression]*<span class="_ _18"> </span>Emit<span class="_ _2"> </span>one<span class="_ _5"> </span>or<span class="_ _2"> </span>more<span class="_ _5"> </span>16-bit<span class="_ _2"> </span>comma<span class="_ _5"> </span>separated</span></div><div class="t m0 x19 h7 ya9c ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>ords</div><div class="t m0 xe h7 ya9d ff5 fs4 fc0 sc0 ls0 ws0">.word<span class="_ _1c"> </span><span class="ff3">expression<span class="_ _2"> </span>[,<span class="_ _2"> </span>expression]*<span class="_ _18"> </span>Emit<span class="_ _2"> </span>one<span class="_ _5"> </span>or<span class="_ _2"> </span>more<span class="_ _5"> </span>32-bit<span class="_ _2"> </span>comma<span class="_ _5"> </span>separated</span></div><div class="t m0 x19 h7 ya9e ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>ords</div><div class="t m0 x45 h7 ya9f ff5 fs4 fc0 sc0 ls0 ws0">.dword<span class="_ _1c"> </span><span class="ff3">expression<span class="_ _2"> </span>[,<span class="_ _2"> </span>expression]*<span class="_ _18"> </span>Emit<span class="_ _2"> </span>one<span class="_ _5"> </span>or<span class="_ _2"> </span>more<span class="_ _5"> </span>64-bit<span class="_ _2"> </span>comma<span class="_ _5"> </span>separated</span></div><div class="t m0 x19 h7 yaa0 ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>ords</div><div class="t m0 x126 h7 yaa1 ff5 fs4 fc0 sc0 ls0 ws0">.string<span class="_ _1c"> </span><span class="ff3">string<span class="_ _95"> </span>Emit<span class="_ _2"> </span>NULL<span class="_ _2"> </span>terminated<span class="_ _2"> </span>string</span></div><div class="t m0 x45 h7 yaa2 ff5 fs4 fc0 sc0 ls0 ws0">.asciz<span class="_ _1c"> </span><span class="ff3">string<span class="_ _95"> </span>Emit<span class="_ _31"> </span>NULL<span class="_ _16"> </span>terminated<span class="_ _31"> </span>string<span class="_ _16"> </span>(alias<span class="_ _31"> </span>for</span></div><div class="t m0 x19 h7 yaa3 ff3 fs4 fc0 sc0 ls0 ws0">.string)</div><div class="t m0 x45 h7 yaa4 ff5 fs4 fc0 sc0 ls0 ws0">.ascii<span class="_ _1c"> </span><span class="ff3">string<span class="_ _95"> </span>Emit<span class="_ _2"> </span>string<span class="_ _2"> </span>without<span class="_ _2"> </span>NULL<span class="_ _2"> </span>c<span class="_ _1"></span>haracter</span></div><div class="t m0 x7e h7 yaa5 ff3 fs4 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>able<span class="_ _2"> </span>4.1:<span class="_ _3"> </span>List<span class="_ _2"> </span>of<span class="_ _2"> </span>assembly<span class="_ _2"> </span>directiv<span class="_ _8"></span>es<span class="_ _2"> </span>that<span class="_ _2"> </span>can<span class="_ _2"> </span>b<span class="_ _4"></span>e<span class="_ _2"> </span>used<span class="_ _2"> </span>to<span class="_ _2"> </span>add<span class="_ _2"> </span>v<span class="_ _8"></span>alues<span class="_ _2"> </span>to<span class="_ _2"> </span>a<span class="_ _2"> </span>program.</div><div class="t m0 x13 h7 yd1 ff3 fs4 fc0 sc0 ls0 ws0">All<span class="_ _b"> </span>directives<span class="_ _b"> </span>on<span class="_ _b"> </span>T<span class="_ _7"></span>able<span class="_ _3"> </span>4.1<span class="_ _b"> </span>add<span class="_ _b"> </span>v<span class="_ _8"></span>alues<span class="_ _3"> </span>to<span class="_ _b"> </span>the<span class="_ _b"> </span>active<span class="_ _b"> </span>section.<span class="_ _26"> </span>The<span class="_ _b"> </span><span class="ff5">.byte</span>,<span class="_ _3"> </span><span class="ff5">.half</span>,</div><div class="t m0 x17 h7 yd2 ff5 fs4 fc0 sc0 ls0 ws0">.word<span class="ff3">,<span class="_ _a"> </span>and<span class="_ _3"> </span></span>.dword<span class="_ _3"> </span><span class="ff3">directives<span class="_ _3"> </span>add<span class="_ _3"> </span>one<span class="_ _3"> </span>or<span class="_ _3"> </span>more<span class="_ _3"> </span>v<span class="_ _8"></span>alues<span class="_ _a"> </span>to<span class="_ _3"> </span>the<span class="_ _3"> </span>active<span class="_ _3"> </span>section.<span class="_ _15"> </span>Their</span></div><div class="t m0 x17 h7 yd3 ff3 fs4 fc0 sc0 ls0 ws0">argumen<span class="_ _1"></span>ts<span class="_ _30"> </span>may<span class="_ _30"> </span>b<span class="_ _4"></span>e<span class="_ _30"> </span>expressed<span class="_ _30"> </span>as immediate<span class="_ _30"> </span>v<span class="_ _7"></span>alues, as<span class="_ _30"> </span>discussed<span class="_ _2f"> </span>in<span class="_ _30"> </span>Section<span class="_ _2f"> </span>4.3,<span class="_ _2f"> </span>sym<span class="_ _8"></span>b<span class="_ _4"></span>ols,</div><div class="t m0 x17 h7 y48 ff3 fs4 fc0 sc0 ls0 ws0">whic<span class="_ _1"></span>h<span class="_ _2"> </span>are<span class="_ _2"> </span>replaced<span class="_ _2"> </span>by<span class="_ _2"> </span>their<span class="_ _2"> </span>v<span class="_ _8"></span>alue<span class="_ _2"> </span>during<span class="_ _2"> </span>the<span class="_ _2"> </span>assembling<span class="_ _2"> </span>and<span class="_ _2"> </span>linking<span class="_ _2"> </span>pro<span class="_ _4"></span>cesses,<span class="_ _2"> </span>or<span class="_ _2"> </span>by</div><div class="t m0 x42 h7 yc ff5 fs4 fc0 sc0 ls0 ws0">http://riscv-<span class="_ _4"></span>programming.org<span class="_ _2"> </span><span class="ff3">(V<span class="_ _7"></span>ersion:<span class="_ _3"> </span>March<span class="_ _2"> </span>29,<span class="_ _2"> </span>2021)<span class="_ _85"> </span>44</span></div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",90.709,590.644,null]'><div class="d m1" style="border-style:none;position:absolute;left:491.394000px;bottom:442.487000px;width:14.169000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",136.063,318.242,null]'><div class="d m1" style="border-style:none;position:absolute;left:163.002000px;bottom:335.425000px;width:14.722000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",136.063,318.242,null]'><div class="d m1" style="border-style:none;position:absolute;left:254.467000px;bottom:103.521000px;width:14.722000px;height:11.125000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf35" data-dest-detail='[53,"XYZ",136.063,490.805,null]'><div class="d m1" style="border-style:none;position:absolute;left:448.080000px;bottom:79.888000px;width:14.722000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:187.121000px;bottom:36.395000px;width:148.940000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
