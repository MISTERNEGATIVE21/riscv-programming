<div id="pf76" class="pf w0 h0" data-page-no="76"><div class="pc pc76 w0 h0"><img class="bi x15 y13f0 w2 hb4" alt="" src="bg76.png"/><div class="t m0 x15 h7 y147 ff3 fs4 fc0 sc0 ls0 ws0">8.10.<span class="_ _19"> </span>EXAMPLES</div><div class="t m0 x15 h7 y1e ff3 fs4 fc0 sc0 ls0 ws0">n<span class="_ _1"></span>um<span class="_ _1"></span>b<span class="_ _4"></span>er<span class="_ _5"> </span>of<span class="_ _b"> </span>b<span class="_ _8"></span>ytes<span class="_ _2"> </span>that<span class="_ _b"> </span>m<span class="_ _8"></span>ust<span class="_ _2"> </span>b<span class="_ _4"></span>e<span class="_ _2"> </span>written<span class="_ _2"> </span>(<span class="ff5">nbyte</span>).<span class="_ _9"> </span>Also,<span class="_ _2"> </span>it<span class="_ _b"> </span>returns<span class="_ _5"> </span>the<span class="_ _b"> </span>n<span class="_ _8"></span>umber<span class="_ _2"> </span>of<span class="_ _b"> </span>b<span class="_ _8"></span>ytes</div><div class="t m0 x15 h7 yd4 ff3 fs4 fc0 sc0 ls0 ws0">written<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>Ô¨Åle.</div><div class="t m0 xd h7 yd5 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _2"> </span>following<span class="_ _5"> </span>assembly<span class="_ _2"> </span>code<span class="_ _b"> </span>sho<span class="_ _8"></span>ws<span class="_ _2"> </span>a<span class="_ _2"> </span>p<span class="_ _4"></span>ossible<span class="_ _2"> </span>implementation<span class="_ _5"> </span>for<span class="_ _2"> </span>the<span class="_ _b"> </span><span class="ff5">write<span class="_ _5"> </span></span>rou-</div><div class="t m0 x15 h7 yfd ff3 fs4 fc0 sc0 ls0 ws0">tine.<span class="_ _12"> </span>This<span class="_ _b"> </span>routine<span class="_ _b"> </span>receives<span class="_ _b"> </span>parameters<span class="_ _b"> </span><span class="ff5">fildes</span>,<span class="_ _b"> </span><span class="ff5">buf</span>,<span class="_ _3"> </span>and<span class="_ _b"> </span><span class="ff5">nbyte<span class="_ _b"> </span></span>on<span class="_ _b"> </span>registers<span class="_ _3"> </span><span class="ff5">a0</span>,<span class="_ _b"> </span><span class="ff5">a1</span>,</div><div class="t m0 x15 h7 y28a ff3 fs4 fc0 sc0 ls0 ws0">and <span class="ff5">a2</span>,<span class="_ _2"> </span>respectively<span class="_ _7"></span>.<span class="_ _3"> </span>These<span class="_ _5"> </span>parameters<span class="_ _5"> </span>are the<span class="_ _5"> </span>same<span class="_ _5"> </span>parameters<span class="_ _5"> </span>that<span class="_ _5"> </span>must b<span class="_ _4"></span>e passed</div><div class="t m0 x15 h7 y48a ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _2"> </span>the<span class="_ _5"> </span>syscall<span class="_ _2"> </span>and<span class="_ _2"> </span>are<span class="_ _2"> </span>already<span class="_ _2"> </span>placed<span class="_ _2"> </span>on<span class="_ _2"> </span>the<span class="_ _5"> </span>correct<span class="_ _2"> </span>registers,<span class="_ _2"> </span>hence,<span class="_ _2"> </span>there<span class="_ _2"> </span>is<span class="_ _2"> </span>no<span class="_ _2"> </span>need</div><div class="t m0 x15 h7 y22 ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _2"> </span>adjust<span class="_ _2"> </span>the<span class="_ _2"> </span>parameters<span class="_ _2"> </span>when<span class="_ _2"> </span>in<span class="_ _1"></span>v<span class="_ _1"></span>oking<span class="_ _2"> </span>the<span class="_ _2"> </span>system<span class="_ _2"> </span>call<span class="_ _2"> </span>on<span class="_ _2"> </span>line<span class="_ _2"> </span>5.</div><div class="t m0 x111 h8 yf64 ff24 fs12 fc0 sc0 ls0 ws0">1<span class="_ _16"> </span><span class="ff5 fs4">write:</span></div><div class="t m0 x111 h8 yf65 ff24 fs12 fc0 sc0 ls0 ws0">2<span class="_ _32"> </span><span class="ff5 fs4">addi<span class="_ _9"> </span>sp,<span class="_ _31"> </span>sp,<span class="_ _31"> </span>-16<span class="_ _82"> </span>#<span class="_ _31"> </span>Allocates<span class="_ _31"> </span>the<span class="_ _9"> </span>stack<span class="_ _31"> </span>frame</span></div><div class="t m0 x111 h8 yf66 ff24 fs12 fc0 sc0 ls0 ws0">3<span class="_ _32"> </span><span class="ff5 fs4">sw<span class="_ _3b"> </span>ra,<span class="_ _31"> </span>12(sp)<span class="_ _3b"> </span>#<span class="_ _9"> </span>Saves<span class="_ _31"> </span>the<span class="_ _31"> </span>return<span class="_ _31"> </span>address</span></div><div class="t m0 x111 h8 yf67 ff24 fs12 fc0 sc0 ls0 ws0">4<span class="_ _32"> </span><span class="ff5 fs4">li<span class="_ _3b"> </span>a7,<span class="_ _31"> </span>64<span class="_ _60"> </span>#<span class="_ _31"> </span>Sets<span class="_ _31"> </span>the<span class="_ _31"> </span>syscall<span class="_ _31"> </span>code<span class="_ _9"> </span>(64<span class="_ _31"> </span>=<span class="_ _31"> </span>write)</span></div><div class="t m0 x111 h8 yf68 ff24 fs12 fc0 sc0 ls0 ws0">5<span class="_ _32"> </span><span class="ff5 fs4">ecall<span class="_ _91"> </span>#<span class="_ _31"> </span>Invokes<span class="_ _31"> </span>the<span class="_ _9"> </span>operating<span class="_ _31"> </span>system</span></div><div class="t m0 x111 h8 y13f1 ff24 fs12 fc0 sc0 ls0 ws0">6<span class="_ _32"> </span><span class="ff5 fs4">lw<span class="_ _3b"> </span>ra,<span class="_ _31"> </span>12(sp)<span class="_ _3b"> </span>#<span class="_ _9"> </span>Restores<span class="_ _31"> </span>the<span class="_ _31"> </span>return<span class="_ _31"> </span>address</span></div><div class="t m0 x111 h8 y13f2 ff24 fs12 fc0 sc0 ls0 ws0">7<span class="_ _32"> </span><span class="ff5 fs4">addi<span class="_ _9"> </span>sp,<span class="_ _31"> </span>sp,<span class="_ _31"> </span>16<span class="_ _3b"> </span>#<span class="_ _31"> </span>Deallocates<span class="_ _31"> </span>the<span class="_ _31"> </span>stack<span class="_ _9"> </span>frame</span></div><div class="t m0 x111 h8 y13f3 ff24 fs12 fc0 sc0 ls0 ws0">8<span class="_ _32"> </span><span class="ff5 fs4">ret<span class="_ _8e"> </span>#<span class="_ _9"> </span>Returns</span></div><div class="t m0 x1f h7 yc ff5 fs4 fc0 sc0 ls0 ws0">http://riscv-<span class="_ _4"></span>programming.org<span class="_ _2"> </span><span class="ff3">(V<span class="_ _7"></span>ersion:<span class="_ _a"> </span>Marc<span class="_ _8"></span>h<span class="_ _2"> </span>29,<span class="_ _2"> </span>2021)<span class="_ _9c"> </span>105</span></div><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:141.766000px;bottom:36.395000px;width:148.940000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
