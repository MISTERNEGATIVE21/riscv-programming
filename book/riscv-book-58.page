<div id="pf3a" class="pf w0 h0" data-page-no="3a"><div class="pc pc3a w0 h0"><img class="bi x13 ya8c wb h80" alt="" src="bg3a.png"/><div class="t m0 x13 h7 y15a ff3 fs4 fc0 sc0 ls0 ws0">CHAPTER<span class="_ _2"> </span>4.<span class="_ _22"> </span>ASSEMBL<span class="_ _7"></span>Y<span class="_ _2"> </span>LANGUAGE</div><div class="c x57 ya8d w19 h7b"><div class="t m0 x11c h7c ya8e ff4a fs31 fc0 sc0 ls0 ws0">Machine instruction</div><div class="t m0 xd8 h7e ya8f ff4b fs31 fc0 sc0 ls0 ws0">0x00008067</div><div class="t m0 x26 h7c ya52 ff4a fs31 fc0 sc0 ls0 ws0">Contents<span class="_ _0"> </span>Address</div><div class="t m0 x103 h7e ya7f ff4c fs31 fc0 sc0 ls0 ws0">00010011</div><div class="t m0 x7d h7f ya80 ff4c fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya53 ff4d fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 x103 h7e ya81 ff4c fs31 fc0 sc0 ls0 ws0">00000101</div><div class="t m0 x7d h7f ya82 ff4c fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya54 ff4d fs31 fc0 sc0 ls0 ws0">001</div><div class="t m0 x103 h7e ya83 ff4c fs31 fc0 sc0 ls0 ws0">10100101</div><div class="t m0 x7d h7f ya84 ff4c fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya55 ff4d fs31 fc0 sc0 ls0 ws0">002</div><div class="t m0 x103 h7e ya85 ff4c fs31 fc0 sc0 ls0 ws0">00000010</div><div class="t m0 x7d h7f ya86 ff4c fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya56 ff4d fs31 fc0 sc0 ls0 ws0">003</div><div class="t m0 x103 h7e ya90 ff4c fs31 fc2 sc0 ls0 ws0">01100111</div><div class="t m0 x7d h7f ya91 ff4c fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya57 ff4d fs31 fc0 sc0 ls0 ws0">004</div><div class="t m0 x103 h7e ya92 ff4c fs31 fc2 sc0 ls0 ws0">10000000</div><div class="t m0 x7d h7f ya93 ff4c fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya58 ff4d fs31 fc0 sc0 ls0 ws0">005</div><div class="t m0 x103 h7e ya94 ff4c fs31 fc2 sc0 ls0 ws0">00000000</div><div class="t m0 x7d h7f ya95 ff4c fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya59 ff4d fs31 fc0 sc0 ls0 ws0">006</div><div class="t m0 x103 h7e ya96 ff4c fs31 fc2 sc0 ls0 ws0">00000000</div><div class="t m0 x7d h7f ya97 ff4c fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xf h7d ya5a ff4d fs31 fc0 sc0 ls0 ws0">007</div><div class="t m0 xf h7d ya5b ff4d fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x26 h7c ya5c ff4a fs31 fc0 sc0 ls0 ws0">Location </div><div class="t m0 x26 h7c ya5d ff4a fs31 fc0 sc0 ls0 ws0">counter:</div><div class="t m0 xf h7d ya5c ff4d fs31 fc0 sc0 ls0 ws0">004</div><div class="t m0 xf h7d ya5d ff4e fs31 fc2 sc0 ls0 ws0">008</div><div class="t m0 x27 h7c ya5f ff4b fs31 fc0 sc0 ls0 ws0">.text<span class="ff4a"> section</span></div><div class="t m0 xf7 h7c ya60 ff4a fs31 fc0 sc0 ls0 ws0">Symbol table</div><div class="t m0 xff h7e ya72 ff4b fs31 fc0 sc0 ls0 ws0">sum42<span class="_ _95"> </span>000</div><div class="t m0 xf9 h7d ya61 ff4d fs31 fc0 sc0 ls0 ws0">sum42:</div><div class="t m0 xf9 h7d ya62 ff4d fs31 fc0 sc0 ls0 ws0">  addi a0, a0, 42 </div><div class="t m0 xf9 h7d ya63 ff4e fs31 fc0 sc0 ls0 ws0">  <span class="fc2">ret</span></div><div class="t m0 x11b h7c ya64 ff4a fs31 fc0 sc0 ls0 ws0">Input file</div><div class="t m0 x4a h7c ya98 ff4a fs31 fc1 sc0 ls0 ws0">1</div><div class="t m0 x4c h7c ya99 ff4a fs31 fc1 sc0 ls0 ws0">2</div><div class="t m0 xa h7c ya8a ff4a fs31 fc1 sc0 ls0 ws0">3</div><div class="t m0 x57 h7c ya52 ff4a fs31 fc0 sc0 ls0 ws0">Contents<span class="_ _0"> </span>Address</div><div class="t m0 xe2 h7d ya53 ff4d fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 xe2 h7d ya54 ff4d fs31 fc0 sc0 ls0 ws0">001</div><div class="t m0 xe2 h7d ya55 ff4d fs31 fc0 sc0 ls0 ws0">002</div><div class="t m0 xe2 h7d ya56 ff4d fs31 fc0 sc0 ls0 ws0">003</div><div class="t m0 xe2 h7d ya57 ff4d fs31 fc0 sc0 ls0 ws0">004</div><div class="t m0 xe2 h7d ya58 ff4d fs31 fc0 sc0 ls0 ws0">005</div><div class="t m0 xe2 h7d ya59 ff4d fs31 fc0 sc0 ls0 ws0">006</div><div class="t m0 xe2 h7d ya5a ff4d fs31 fc0 sc0 ls0 ws0">007</div><div class="t m0 xe2 h7d ya5b ff4d fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x57 h7c ya5c ff4a fs31 fc0 sc0 ls0 ws0">Location </div><div class="t m0 x48 h7c ya5d ff4a fs31 fc0 sc0 ls0 ws0">counter:</div><div class="t m0 xe2 h7d ya5e ff4d fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 x48 h7c ya5f ff4b fs31 fc0 sc0 ls0 ws0">.data<span class="ff4a"> section</span></div><div class="t m0 xa h7d ya65 ff4d fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x27 h7c ya66 ff4a fs31 fc0 sc0 ls0 ws0">Active section</div></div><div class="t m0 x11 h7 ya9a ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _2"> </span>4.4:<span class="_ _3"> </span>Pro<span class="_ _4"></span>cessing<span class="_ _2"> </span>the<span class="_ _2"> </span>last<span class="_ _2"> </span>assembly<span class="_ _5"> </span>instruction.</div><div class="t m0 x14 h7 ya9b ff3 fs4 fc0 sc0 ls0 ws0">Once<span class="_ _12"> </span>all elemen<span class="_ _8"></span>ts from<span class="_ _12"> </span>the<span class="_ _12"> </span>input ﬁle<span class="_ _12"> </span>are<span class="_ _12"> </span>pro<span class="_ _4"></span>cessed, the<span class="_ _12"> </span>assem<span class="_ _1"></span>bler<span class="_ _12"> </span>stores the<span class="_ _12"> </span>section</div><div class="t m0 x13 h7 ya9c ff3 fs4 fc0 sc0 ls0 ws0">con<span class="_ _1"></span>ten<span class="_ _1"></span>ts,<span class="_ _c"> </span>the<span class="_ _c"> </span>sym<span class="_ _8"></span>b<span class="_ _4"></span>ol<span class="_ _3"> </span>table,<span class="_ _f"> </span>and<span class="_ _3"> </span>other<span class="_ _c"> </span>relev<span class="_ _8"></span>ant<span class="_ _a"> </span>information<span class="_ _c"> </span>(such<span class="_ _3"> </span>as<span class="_ _3"> </span>the<span class="_ _3"> </span>relo<span class="_ _4"></span>cation</div><div class="t m0 x13 h7 ya9d ff3 fs4 fc0 sc0 ls0 ws0">records),<span class="_ _2"> </span>on<span class="_ _2"> </span>the<span class="_ _2"> </span>ob<span class="_ _4"></span>ject<span class="_ _2"> </span>ﬁle.</div><div class="t m0 x13 hd ya9e ff6 fs3 fc0 sc0 ls0 ws0">4.7<span class="_ _36"> </span>Assem<span class="_ _8"></span>bly<span class="_ _e"> </span>directives</div><div class="t m0 x13 h7 ya9f ff3 fs4 fc0 sc0 ls0 ws0">Assem<span class="_ _1"></span>bly<span class="_ _d"> </span>directives<span class="_ _2"> </span>are<span class="_ _a"> </span>commands<span class="_ _d"> </span>used<span class="_ _a"> </span>to<span class="_ _d"> </span>control<span class="_ _d"> </span>the<span class="_ _d"> </span>assembler.<span class="_ _e"> </span>F<span class="_ _7"></span>or<span class="_ _a"> </span>example,<span class="_ _d"> </span>the</div><div class="t m0 x13 h7 yaa0 ff5 fs4 fc0 sc0 ls0 ws0">.section<span class="_ _11"> </span>.data<span class="_ _2"> </span><span class="ff3">directive<span class="_ _5"> </span>instructs<span class="_ _2"> </span>the<span class="_ _2"> </span>assembler<span class="_ _5"> </span>to<span class="_ _2"> </span>turn<span class="_ _2"> </span>the<span class="_ _2"> </span></span>.data<span class="_ _2"> </span><span class="ff3">section<span class="_ _2"> </span>in<span class="_ _1"></span>to<span class="_ _2"> </span>the</span></div><div class="t m0 x13 h7 yaa1 ff3 fs4 fc0 sc0 ls0 ws0">activ<span class="_ _1"></span>e section,<span class="_ _13"> </span>and<span class="_ _13"> </span>the <span class="ff5">.word<span class="_ _11"> </span>10<span class="_ _13"> </span></span>directiv<span class="_ _1"></span>e instructs<span class="_ _12"> </span>the assem<span class="_ _8"></span>bler to<span class="_ _13"> </span>assem<span class="_ _1"></span>ble<span class="_ _13"> </span>a 32-bit</div><div class="t m0 x13 h7 yaa2 ff3 fs4 fc0 sc0 ls0 ws0">v<span class="_ _8"></span>alue<span class="_ _2"> </span>(10)<span class="_ _2"> </span>and<span class="_ _2"> </span>add<span class="_ _2"> </span>it<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>activ<span class="_ _1"></span>e<span class="_ _2"> </span>section.</div><div class="t m0 x14 h7 yaa3 ff3 fs4 fc0 sc0 ls0 ws0">Assem<span class="_ _1"></span>bly<span class="_ _3"> </span>directives<span class="_ _3"> </span>are<span class="_ _c"> </span>usually<span class="_ _3"> </span>enco<span class="_ _4"></span>ded<span class="_ _3"> </span>as<span class="_ _c"> </span>a<span class="_ _3"> </span>string<span class="_ _c"> </span>that<span class="_ _c"> </span>con<span class="_ _8"></span>tains<span class="_ _c"> </span>the<span class="_ _c"> </span>directiv<span class="_ _1"></span>e</div><div class="t m0 x13 h7 yaa4 ff3 fs4 fc0 sc0 ls0 ws0">name<span class="_ _3"> </span>and<span class="_ _3"> </span>its<span class="_ _3"> </span>arguments.<span class="_ _0"> </span>On<span class="_ _a"> </span>GNU<span class="_ _c"> </span>assem<span class="_ _1"></span>blers,<span class="_ _c"> </span>directive<span class="_ _a"> </span>names<span class="_ _3"> </span>contain<span class="_ _3"> </span>a<span class="_ _3"> </span>dot<span class="_ _3"> </span>(‘.’)</div><div class="t m0 x13 h7 yaa5 ff3 fs4 fc0 sc0 ls0 ws0">preﬁx.<span class="_ _3"> </span>The<span class="_ _2"> </span>next<span class="_ _2"> </span>sections<span class="_ _2"> </span>discuss<span class="_ _5"> </span>some<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>most<span class="_ _5"> </span>common<span class="_ _2"> </span>directives<span class="_ _5"> </span>used<span class="_ _2"> </span>to<span class="_ _5"> </span>imple-</div><div class="t m0 x13 h7 yaa6 ff3 fs4 fc0 sc0 ls0 ws0">men<span class="_ _1"></span>t<span class="_ _2"> </span>assem<span class="_ _1"></span>bly<span class="_ _2"> </span>programs.</div><div class="t m0 x13 ha yaa7 ff6 fs6 fc0 sc0 ls0 ws0">4.7.1<span class="_ _17"> </span>Adding<span class="_ _c"> </span>v<span class="_ _7"></span>alues<span class="_ _c"> </span>to<span class="_ _c"> </span>the<span class="_ _c"> </span>program</div><div class="t m0 x13 h7 yaa8 ff3 fs4 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>able<span class="_ _d"> </span>4.1<span class="_ _a"> </span>contains<span class="_ _d"> </span>a<span class="_ _a"> </span>list<span class="_ _a"> </span>of<span class="_ _a"> </span>assembly<span class="_ _d"> </span>directives<span class="_ _d"> </span>that<span class="_ _a"> </span>can<span class="_ _a"> </span>b<span class="_ _4"></span>e<span class="_ _d"> </span>used<span class="_ _a"> </span>to<span class="_ _a"> </span>add<span class="_ _a"> </span>v<span class="_ _8"></span>alues<span class="_ _d"> </span>to<span class="_ _a"> </span>a</div><div class="t m0 x13 h7 yaa9 ff3 fs4 fc0 sc0 ls0 ws0">program.</div><div class="t m0 x20 h7 yaaa ff3 fs4 fc0 sc0 ls0 ws0">Directiv<span class="_ _1"></span>e<span class="_ _21"> </span>Arguments<span class="_ _96"> </span>Description</div><div class="t m0 xe h7 yaab ff5 fs4 fc0 sc0 ls0 ws0">.byte<span class="_ _21"> </span><span class="ff3">expression<span class="_ _2"> </span>[,<span class="_ _2"> </span>expression]*<span class="_ _21"> </span>Emit<span class="_ _a"> </span>one<span class="_ _3"> </span>or<span class="_ _a"> </span>more<span class="_ _a"> </span>8-bit<span class="_ _3"> </span>comma<span class="_ _a"> </span>separated</span></div><div class="t m0 x1a h7 yaac ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>ords</div><div class="t m0 xe h7 yaad ff5 fs4 fc0 sc0 ls0 ws0">.half<span class="_ _21"> </span><span class="ff3">expression<span class="_ _2"> </span>[,<span class="_ _2"> </span>expression]*<span class="_ _21"> </span>Emit<span class="_ _5"> </span>one<span class="_ _2"> </span>or<span class="_ _5"> </span>more<span class="_ _2"> </span>16-bit<span class="_ _5"> </span>comma<span class="_ _2"> </span>separated</span></div><div class="t m0 x1a h7 yaae ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>ords</div><div class="t m0 xe h7 yaaf ff5 fs4 fc0 sc0 ls0 ws0">.word<span class="_ _21"> </span><span class="ff3">expression<span class="_ _2"> </span>[,<span class="_ _2"> </span>expression]*<span class="_ _21"> </span>Emit<span class="_ _5"> </span>one<span class="_ _2"> </span>or<span class="_ _5"> </span>more<span class="_ _2"> </span>32-bit<span class="_ _5"> </span>comma<span class="_ _2"> </span>separated</span></div><div class="t m0 x1a h7 yab0 ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>ords</div><div class="t m0 x46 h7 yab1 ff5 fs4 fc0 sc0 ls0 ws0">.dword<span class="_ _21"> </span><span class="ff3">expression<span class="_ _2"> </span>[,<span class="_ _2"> </span>expression]*<span class="_ _21"> </span>Emit<span class="_ _5"> </span>one<span class="_ _2"> </span>or<span class="_ _5"> </span>more<span class="_ _2"> </span>64-bit<span class="_ _5"> </span>comma<span class="_ _2"> </span>separated</span></div><div class="t m0 x1a h7 yab2 ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>ords</div><div class="t m0 x127 h7 yab3 ff5 fs4 fc0 sc0 ls0 ws0">.string<span class="_ _21"> </span><span class="ff3">string<span class="_ _97"> </span>Emit<span class="_ _2"> </span>NULL<span class="_ _2"> </span>terminated<span class="_ _2"> </span>string</span></div><div class="t m0 x46 h7 yab4 ff5 fs4 fc0 sc0 ls0 ws0">.asciz<span class="_ _21"> </span><span class="ff3">string<span class="_ _97"> </span>Emit<span class="_ _e"> </span>NULL<span class="_ _1f"> </span>terminated<span class="_ _e"> </span>string<span class="_ _1f"> </span>(alias<span class="_ _e"> </span>for</span></div><div class="t m0 x1a h7 yab5 ff3 fs4 fc0 sc0 ls0 ws0">.string)</div><div class="t m0 x46 h7 yab6 ff5 fs4 fc0 sc0 ls0 ws0">.ascii<span class="_ _21"> </span><span class="ff3">string<span class="_ _97"> </span>Emit<span class="_ _2"> </span>string<span class="_ _2"> </span>without<span class="_ _2"> </span>NULL<span class="_ _2"> </span>c<span class="_ _1"></span>haracter</span></div><div class="t m0 x7f h7 yab7 ff3 fs4 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>able<span class="_ _2"> </span>4.1:<span class="_ _3"> </span>List<span class="_ _2"> </span>of<span class="_ _2"> </span>assembly<span class="_ _2"> </span>directiv<span class="_ _8"></span>es<span class="_ _2"> </span>that<span class="_ _2"> </span>can<span class="_ _2"> </span>b<span class="_ _4"></span>e<span class="_ _2"> </span>used<span class="_ _2"> </span>to<span class="_ _2"> </span>add<span class="_ _2"> </span>v<span class="_ _8"></span>alues<span class="_ _2"> </span>to<span class="_ _2"> </span>a<span class="_ _2"> </span>program.</div><div class="t m0 x14 h7 yea ff3 fs4 fc0 sc0 ls0 ws0">All<span class="_ _a"> </span>directives<span class="_ _d"> </span>on<span class="_ _a"> </span>T<span class="_ _7"></span>able<span class="_ _3"> </span>4.1<span class="_ _a"> </span>add<span class="_ _a"> </span>v<span class="_ _8"></span>alues<span class="_ _a"> </span>to<span class="_ _a"> </span>the<span class="_ _3"> </span>activ<span class="_ _1"></span>e<span class="_ _a"> </span>section.<span class="_ _2d"> </span>The<span class="_ _a"> </span><span class="ff5">.byte</span>,<span class="_ _3"> </span><span class="ff5">.half</span>,</div><div class="t m0 x13 h7 yeb ff5 fs4 fc0 sc0 ls0 ws0">.word<span class="ff3">,<span class="_ _c"> </span>and<span class="_ _3"> </span></span>.dword<span class="_ _3"> </span><span class="ff3">directives<span class="_ _a"> </span>add<span class="_ _c"> </span>one<span class="_ _3"> </span>or<span class="_ _3"> </span>more<span class="_ _3"> </span>v<span class="_ _8"></span>alues<span class="_ _c"> </span>to<span class="_ _3"> </span>the<span class="_ _3"> </span>active<span class="_ _a"> </span>section.<span class="_ _0"> </span>Their</span></div><div class="t m0 x13 h7 yec ff3 fs4 fc0 sc0 ls0 ws0">argumen<span class="_ _1"></span>ts<span class="_ _12"> </span>may<span class="_ _12"> </span>b<span class="_ _4"></span>e<span class="_ _12"> </span>expressed<span class="_ _12"> </span>as<span class="_ _12"> </span>immediate<span class="_ _13"> </span>v<span class="_ _7"></span>alues, as<span class="_ _12"> </span>discussed<span class="_ _12"> </span>in Section<span class="_ _12"> </span>4.3,<span class="_ _12"> </span>s<span class="_ _4"></span>ym<span class="_ _8"></span>b<span class="_ _4"></span>ols,</div><div class="t m0 x13 h7 y61 ff3 fs4 fc0 sc0 ls0 ws0">whic<span class="_ _1"></span>h<span class="_ _2"> </span>are<span class="_ _2"> </span>replaced<span class="_ _2"> </span>by<span class="_ _2"> </span>their<span class="_ _2"> </span>v<span class="_ _8"></span>alue<span class="_ _2"> </span>during<span class="_ _2"> </span>the<span class="_ _2"> </span>assembling<span class="_ _2"> </span>and<span class="_ _2"> </span>linking<span class="_ _2"> </span>pro<span class="_ _4"></span>cesses,<span class="_ _2"> </span>or<span class="_ _2"> </span>by</div><div class="t m0 x43 h7 yc ff5 fs4 fc0 sc0 ls0 ws0">http://riscv-<span class="_ _4"></span>programming.org<span class="_ _2"> </span><span class="ff3">(V<span class="_ _7"></span>ersion:<span class="_ _c"> </span>August<span class="_ _5"> </span>21,<span class="_ _d"> </span>2021)<span class="_ _6f"> </span>44</span></div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",136.063,590.644,null]'><div class="d m1" style="border-style:none;position:absolute;left:491.394000px;bottom:442.487000px;width:14.169000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3a" data-dest-detail='[58,"XYZ",136.063,318.242,null]'><div class="d m1" style="border-style:none;position:absolute;left:163.002000px;bottom:335.425000px;width:14.722000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3a" data-dest-detail='[58,"XYZ",136.063,318.242,null]'><div class="d m1" style="border-style:none;position:absolute;left:254.467000px;bottom:103.521000px;width:14.722000px;height:11.125000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf36" data-dest-detail='[54,"XYZ",136.063,490.805,null]'><div class="d m1" style="border-style:none;position:absolute;left:448.080000px;bottom:79.888000px;width:14.722000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:185.308000px;bottom:36.395000px;width:148.940000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
