<div id="pf3c" class="pf w0 h0" data-page-no="3c"><div class="pc pc3c w0 h0"><img class="bi x15 yae2 we h81" alt="" src="bg3c.png"/><div class="t m0 x15 h7 y147 ff3 fs4 fc0 sc0 ls0 ws0">4.7.<span class="_ _19"> </span>ASSEMBL<span class="_ _7"></span>Y<span class="_ _2"> </span>DIRECTIVES</div><div class="c x45 ya7b w19 h7b"><div class="t m0 x25 h7c ya40 ff5d fs31 fc0 sc0 ls0 ws0">Contents<span class="_ _0"> </span>Address</div><div class="t m0 xf h7d ya41 ff5e fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 xf h7d ya42 ff5e fs31 fc0 sc0 ls0 ws0">001</div><div class="t m0 xf h7d ya43 ff5e fs31 fc0 sc0 ls0 ws0">002</div><div class="t m0 xf h7d ya44 ff5e fs31 fc0 sc0 ls0 ws0">003</div><div class="t m0 xf h7d ya45 ff5e fs31 fc0 sc0 ls0 ws0">004</div><div class="t m0 xf h7d ya46 ff5e fs31 fc0 sc0 ls0 ws0">005</div><div class="t m0 xf h7d ya47 ff5e fs31 fc0 sc0 ls0 ws0">006</div><div class="t m0 xf h7d ya48 ff5e fs31 fc0 sc0 ls0 ws0">007</div><div class="t m0 xf h7d ya49 ff5e fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x25 h7c ya4a ff5d fs31 fc0 sc0 ls0 ws0">Location </div><div class="t m0 x25 h7c ya4b ff5d fs31 fc0 sc0 ls0 ws0">counter:</div><div class="t m0 xf h7d ya4c ff5e fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 x26 h7c ya4d ff5f fs31 fc0 sc0 ls0 ws0">.text<span class="ff5d"> section</span></div><div class="t m0 xf6 h7c ya4e ff5d fs31 fc0 sc0 ls0 ws0">Symbol table</div><div class="t m0 xf6 h7e ya60 ff5f fs31 fc0 sc0 ls0 ws0">msg<span class="_ _13"> </span>000</div><div class="t m0 x121 h7e yae3 ff5f fs31 fc0 sc0 ls0 ws0">x<span class="_ _96"> </span>005</div><div class="t m0 xf8 h7d yabc ff5e fs31 fc0 sc0 ls0 ws0">.section .data</div><div class="t m0 xf8 h7d yabd ff5e fs31 fc0 sc0 ls0 ws0">msg: .ascii &quot;hello&quot;</div><div class="t m0 xf8 h7d yabe ff5e fs31 fc0 sc0 ls0 ws0">x:   <span class="ff60 fc2">.word 10</span></div><div class="t m0 x11a h7c ya52 ff5d fs31 fc0 sc0 ls0 ws0">Input file</div><div class="t m0 xa h7d ya53 ff5e fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x56 h7c ya40 ff5d fs31 fc0 sc0 ls0 ws0">Contents<span class="_ _0"> </span>Address</div><div class="t m0 x54 h7e ya6d ff5f fs31 fc0 sc0 ls0 ws0">01101000</div><div class="t m0 x2a h7f ya6e ff5f fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya41 ff5e fs31 fc0 sc0 ls0 ws0">000</div><div class="t m0 x54 h7e ya6f ff5f fs31 fc0 sc0 ls0 ws0">01100101</div><div class="t m0 x2a h7f ya70 ff5f fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya42 ff5e fs31 fc0 sc0 ls0 ws0">001</div><div class="t m0 x54 h7e ya71 ff5f fs31 fc0 sc0 ls0 ws0">01101100</div><div class="t m0 x2a h7f ya72 ff5f fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya43 ff5e fs31 fc0 sc0 ls0 ws0">002</div><div class="t m0 x54 h7e ya73 ff5f fs31 fc0 sc0 ls0 ws0">01101100</div><div class="t m0 x2a h7f ya74 ff5f fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya44 ff5e fs31 fc0 sc0 ls0 ws0">003</div><div class="t m0 x54 h7e ya7e ff5f fs31 fc0 sc0 ls0 ws0">01101111</div><div class="t m0 x2a h7f ya7f ff5f fs32 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya45 ff5e fs31 fc0 sc0 ls0 ws0">004</div><div class="t m0 x54 h7e ya80 ff61 fs31 fc2 sc0 ls0 ws0">00001010</div><div class="t m0 x2a h7f ya81 ff61 fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya46 ff5e fs31 fc0 sc0 ls0 ws0">005</div><div class="t m0 x54 h7e ya82 ff61 fs31 fc2 sc0 ls0 ws0">00000000</div><div class="t m0 x2a h7f ya83 ff61 fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya47 ff5e fs31 fc0 sc0 ls0 ws0">006</div><div class="t m0 x54 h7e ya84 ff61 fs31 fc2 sc0 ls0 ws0">00000000</div><div class="t m0 x2a h7f ya85 ff61 fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya48 ff5e fs31 fc0 sc0 ls0 ws0">007</div><div class="t m0 x54 h7e yae4 ff61 fs31 fc2 sc0 ls0 ws0">00000000</div><div class="t m0 x2a h7f yae5 ff61 fs32 fc2 sc0 ls0 ws0">2</div><div class="t m0 xe1 h7d ya49 ff5e fs31 fc0 sc0 ls0 ws0">...</div><div class="t m0 x56 h7c ya4a ff5d fs31 fc0 sc0 ls0 ws0">Location </div><div class="t m0 x47 h7c ya4b ff5d fs31 fc0 sc0 ls0 ws0">counter:</div><div class="t m0 xe1 h7d ya4a ff5e fs31 fc0 sc0 ls0 ws0">005</div><div class="t m0 xe1 h7d ya4b ff60 fs31 fc2 sc0 ls0 ws0">009</div><div class="t m0 x47 h7c ya4d ff5f fs31 fc0 sc0 ls0 ws0">.data<span class="ff5d"> section</span></div><div class="t m0 x47 h7c ya54 ff5d fs31 fc0 sc0 ls0 ws0">Active section</div><div class="t m0 xca h7c yacf ff5d fs31 fc0 sc0 ls0 ws0">32 bit value (10</div><div class="t m0 x27 h82 yae6 ff5d fs32 fc0 sc0 ls0 ws0">10</div><div class="t m0 x2f h7c yacf ff5d fs31 fc0 sc0 ls0 ws0">)</div><div class="t m0 xce h7e yad0 ff5f fs31 fc0 sc0 ls0 ws0">0x0000000a</div><div class="t m0 x23 h7c yae7 ff5d fs31 fc1 sc0 ls0 ws0">1</div><div class="t m0 x4b h7c yae8 ff5d fs31 fc1 sc0 ls0 ws0">2</div><div class="t m0 x6a h7c yad3 ff5d fs31 fc1 sc0 ls0 ws0">3</div></div><div class="t m0 x102 h7 ya88 ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _2"> </span>4.8:<span class="_ _3"> </span>Pro<span class="_ _4"></span>cessing<span class="_ _2"> </span>the<span class="_ _2"> </span>“<span class="ff5">.word<span class="_ _31"> </span>10</span>”<span class="_ _2"> </span>directiv<span class="_ _8"></span>e<span class="_ _4"></span>.</div><div class="t m0 x15 h7 yae9 ff3 fs4 fc0 sc0 ls0 ws0">section.<span class="_ _16"> </span>T<span class="_ _7"></span>o<span class="_ _b"> </span>instruct<span class="_ _2"> </span>the<span class="_ _b"> </span>assembler<span class="_ _2"> </span>to<span class="_ _b"> </span>add<span class="_ _b"> </span>the<span class="_ _b"> </span>assem<span class="_ _8"></span>bled<span class="_ _b"> </span>information<span class="_ _b"> </span>in<span class="_ _8"></span>to<span class="_ _b"> </span>other<span class="_ _b"> </span>sec-</div><div class="t m0 x15 h7 yaea ff3 fs4 fc0 sc0 ls0 ws0">tions,<span class="_ _3"> </span>the<span class="_ _b"> </span>programmer<span class="_ _3"> </span>(or<span class="_ _3"> </span>the<span class="_ _b"> </span>compiler)<span class="_ _3"> </span>ma<span class="_ _8"></span>y<span class="_ _3"> </span>use<span class="_ _3"> </span>the<span class="_ _b"> </span><span class="ff5">.section<span class="_ _31"> </span>secname<span class="_ _3"> </span></span>directiv<span class="_ _8"></span>e.</div><div class="t m0 x15 h7 yaeb ff3 fs4 fc0 sc0 ls0 ws0">As<span class="_ _2"> </span>discussed<span class="_ _b"> </span>in<span class="_ _2"> </span>Section<span class="_ _b"> </span>4.6,<span class="_ _2"> </span>when<span class="_ _b"> </span>assem<span class="_ _8"></span>bling<span class="_ _b"> </span>a<span class="_ _2"> </span>program,<span class="_ _b"> </span>the<span class="_ _2"> </span>assem<span class="_ _1"></span>bler<span class="_ _2"> </span>enco<span class="_ _4"></span>des<span class="_ _2"> </span>and</div><div class="t m0 x15 h7 yaec ff3 fs4 fc0 sc0 ls0 ws0">adds<span class="_ _5"> </span>each assembly element to<span class="_ _5"> </span>the<span class="_ _5"> </span>active section.<span class="_ _a"> </span>The<span class="_ _5"> </span>“<span class="ff5">.section<span class="_ _31"> </span>secname</span>”<span class="_ _5"> </span>changes</div><div class="t m0 x15 h7 yaed ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _2"> </span>active<span class="_ _5"> </span>section<span class="_ _b"> </span>to<span class="_ _2"> </span><span class="ff5">secname</span>,<span class="_ _2"> </span>hence,<span class="_ _2"> </span>all<span class="_ _b"> </span>the<span class="_ _2"> </span>information<span class="_ _2"> </span>pro<span class="_ _4"></span>cessed<span class="_ _2"> </span>b<span class="_ _1"></span>y<span class="_ _2"> </span>the<span class="_ _2"> </span>assembler</div><div class="t m0 x15 h7 yaee ff3 fs4 fc0 sc0 ls0 ws0">after<span class="_ _2"> </span>this<span class="_ _2"> </span>directiv<span class="_ _1"></span>e<span class="_ _2"> </span>is<span class="_ _2"> </span>added<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff5">secname<span class="_ _2"> </span></span>section.</div><div class="t m0 xd h7 yaef ff3 fs4 fc0 sc0 ls0 ws0">Program<span class="_ _2"> </span>instructions<span class="_ _b"> </span>are<span class="_ _2"> </span>exp<span class="_ _4"></span>ected<span class="_ _2"> </span>to<span class="_ _b"> </span>be<span class="_ _2"> </span>placed<span class="_ _b"> </span>on<span class="_ _2"> </span>the<span class="_ _b"> </span><span class="ff5">.text<span class="_ _2"> </span></span>section,<span class="_ _b"> </span>while<span class="_ _2"> </span>con-</div><div class="t m0 x15 h7 yaf0 ff3 fs4 fc0 sc0 ls0 ws0">stan<span class="_ _1"></span>ts,<span class="_ _2"> </span><span class="ff8">i.e.</span>,<span class="_ _b"> </span>read-only<span class="_ _2"> </span>data,<span class="_ _2"> </span>must<span class="_ _2"> </span>b<span class="_ _4"></span>e<span class="_ _2"> </span>placed<span class="_ _2"> </span>on<span class="_ _2"> </span>the<span class="_ _b"> </span><span class="ff5">.rodata<span class="_ _2"> </span></span>section.<span class="_ _25"> </span>Also,<span class="_ _b"> </span>initialized</div><div class="t m0 x15 h7 yaf1 ff3 fs4 fc0 sc0 ls0 ws0">global<span class="_ _30"> </span>v<span class="_ _8"></span>ariables m<span class="_ _8"></span>ust<span class="_ _30"> </span>b<span class="_ _4"></span>e<span class="_ _30"> </span>placed on<span class="_ _30"> </span>the<span class="_ _30"> </span><span class="ff5">.data<span class="_ _2f"> </span></span>section,<span class="_ _2f"> </span>and<span class="_ _30"> </span>uninitialized glob<span class="_ _1"></span>al<span class="_ _30"> </span>v<span class="_ _8"></span>ariables</div><div class="t m0 x15 h7 yaf2 ff3 fs4 fc0 sc0 ls0 ws0">should<span class="_ _2"> </span>b<span class="_ _4"></span>e<span class="_ _5"> </span>placed<span class="_ _2"> </span>on<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff5">.bss<span class="_ _2"> </span></span>section.</div><div class="t m0 xd h7 yaf3 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _3"> </span>follo<span class="_ _1"></span>wing<span class="_ _3"> </span>assem<span class="_ _1"></span>bly<span class="_ _3"> </span>co<span class="_ _4"></span>de<span class="_ _b"> </span>shows<span class="_ _b"> </span>how<span class="_ _3"> </span>the<span class="_ _3"> </span><span class="ff5">.section<span class="_ _3"> </span></span>directiv<span class="_ _8"></span>e<span class="_ _3"> </span>can<span class="_ _3"> </span>b<span class="_ _4"></span>e<span class="_ _3"> </span>used<span class="_ _3"> </span>to</div><div class="t m0 x15 h7 yaf4 ff3 fs4 fc0 sc0 ls0 ws0">add<span class="_ _2"> </span>the<span class="_ _b"> </span>program<span class="_ _5"> </span>instructions<span class="_ _b"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff5">.text<span class="_ _b"> </span></span>section<span class="_ _2"> </span>and<span class="_ _2"> </span>the<span class="_ _2"> </span>program<span class="_ _b"> </span>v<span class="_ _7"></span>ariables<span class="_ _b"> </span>to<span class="_ _5"> </span>the</div><div class="t m0 x15 h7 yaf5 ff5 fs4 fc0 sc0 ls0 ws0">.data<span class="_ _2"> </span><span class="ff3">and<span class="_ _2"> </span></span>.rodata<span class="_ _2"> </span><span class="ff3">sections.</span></div><div class="t m0 x111 h8 yaf6 ff24 fs12 fc0 sc0 ls0 ws0">1<span class="_ _16"> </span><span class="ff5 fs4">.section<span class="_ _31"> </span>.text</span></div><div class="t m0 x111 h8 yaf7 ff24 fs12 fc0 sc0 ls0 ws0">2<span class="_ _16"> </span><span class="ff5 fs4">set_x:</span></div><div class="t m0 x111 h8 yaf8 ff24 fs12 fc0 sc0 ls0 ws0">3<span class="_ _32"> </span><span class="ff5 fs4">la<span class="_ _9"> </span>t1,<span class="_ _31"> </span>x</span></div><div class="t m0 x111 h8 yaf9 ff24 fs12 fc0 sc0 ls0 ws0">4<span class="_ _32"> </span><span class="ff5 fs4">sw<span class="_ _9"> </span>a0,<span class="_ _31"> </span>(t1)</span></div><div class="t m0 x111 h8 yafa ff24 fs12 fc0 sc0 ls0 ws0">5<span class="_ _32"> </span><span class="ff5 fs4">ret</span></div><div class="t m0 x111 h8 yafb ff24 fs12 fc0 sc0 ls0 ws0">6<span class="_ _16"> </span><span class="ff5 fs4">get_msg:</span></div><div class="t m0 x111 h8 yafc ff24 fs12 fc0 sc0 ls0 ws0">7<span class="_ _32"> </span><span class="ff5 fs4">la<span class="_ _9"> </span>a0,<span class="_ _31"> </span>msg</span></div><div class="t m0 x111 h8 yafd ff24 fs12 fc0 sc0 ls0 ws0">8<span class="_ _32"> </span><span class="ff5 fs4">ret</span></div><div class="t m0 x111 h8 yafe ff24 fs12 fc0 sc0 ls0 ws0">9<span class="_ _16"> </span><span class="ff5 fs4">.section<span class="_ _31"> </span>.data</span></div><div class="t m0 x11d h8 yaff ff24 fs12 fc0 sc0 ls0 ws0">10<span class="_ _16"> </span><span class="ff5 fs4">x:<span class="_ _31"> </span>.word<span class="_ _31"> </span>10</span></div><div class="t m0 x11d h8 yb00 ff24 fs12 fc0 sc0 ls0 ws0">11<span class="_ _16"> </span><span class="ff5 fs4">.section<span class="_ _31"> </span>.rodata</span></div><div class="t m0 x11d h8 yb01 ff24 fs12 fc0 sc0 ls0 ws0">12<span class="_ _16"> </span><span class="ff5 fs4">msg:<span class="_ _31"> </span>.string<span class="_ _31"> </span>&quot;Assembly<span class="_ _9"> </span>rocks!&quot;</span></div><div class="t m0 xd h7 yb02 ff6 fs4 fc0 sc0 ls0 ws0">NOTE:<span class="_ _11"> </span><span class="ff3">The<span class="_ _a"> </span>R<span class="_ _23"></span>V32I<span class="_ _25"> </span>GNU<span class="_ _25"> </span>assembler<span class="_ _a"> </span>also<span class="_ _25"> </span>contains<span class="_ _a"> </span>the<span class="_ _a"> </span>“<span class="ff5">.text</span>”,<span class="_ _31"> </span>“<span class="ff5">.data</span>”,</span></div><div class="t m0 xd h7 yb03 ff3 fs4 fc0 sc0 ls0 ws0">and<span class="_ _25"> </span>“<span class="ff5">.bss</span>”<span class="_ _25"> </span>directiv<span class="_ _1"></span>es,<span class="_ _9"> </span>which<span class="_ _a"> </span>are<span class="_ _25"> </span>aliases<span class="_ _25"> </span>to<span class="_ _25"> </span>“<span class="ff5">.section<span class="_ _31"> </span>.text</span>”,<span class="_ _9"> </span>“<span class="ff5">.section</span></div><div class="t m0 xd h7 yb04 ff5 fs4 fc0 sc0 ls0 ws0">.data<span class="ff3">”,<span class="_ _2"> </span>and<span class="_ _2"> </span>the<span class="_ _2"> </span>“</span>.section<span class="_ _9"> </span>.bss<span class="ff3">”<span class="_ _2"> </span>directives,<span class="_ _2"> </span>respectively<span class="_ _7"></span>.</span></div><div class="t m0 x15 ha yb05 ff7 fs6 fc0 sc0 ls0 ws0">4.7.3<span class="_ _e"> </span>Allo<span class="_ _4"></span>cating<span class="_ _3"> </span>v<span class="_ _8"></span>ariables<span class="_ _a"> </span>on<span class="_ _a"> </span>the<span class="_ _a"> </span><span class="ff2">.bss<span class="_ _a"> </span></span>section</div><div class="t m0 x15 h7 yd1 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _30"> </span><span class="ff5">.bss<span class="_ _30"> </span></span>section<span class="_ _30"> </span>is<span class="_ _2f"> </span>dedicated<span class="_ _30"> </span>for<span class="_ _30"> </span>storing<span class="_ _30"> </span>uninitialized<span class="_ _2f"> </span>global<span class="_ _30"> </span>v<span class="_ _8"></span>ariables.<span class="_ _3"> </span>These<span class="_ _30"> </span>v<span class="_ _7"></span>ariables</div><div class="t m0 x15 h7 yd2 ff3 fs4 fc0 sc0 ls0 ws0">need<span class="_ _5"> </span>to<span class="_ _2"> </span>b<span class="_ _4"></span>e<span class="_ _5"> </span>allo<span class="_ _4"></span>cated<span class="_ _5"> </span>on<span class="_ _5"> </span>memory<span class="_ _7"></span>,<span class="_ _2"> </span>but<span class="_ _2"> </span>they<span class="_ _5"> </span>do<span class="_ _2"> </span>not<span class="_ _5"> </span>need<span class="_ _2"> </span>to<span class="_ _2"> </span>b<span class="_ _4"></span>e initialized<span class="_ _2"> </span>by<span class="_ _5"> </span>the<span class="_ _5"> </span>loader</div><div class="t m0 x15 h7 yd3 ff3 fs4 fc0 sc0 ls0 ws0">when<span class="_ _2"> </span>a<span class="_ _2"> </span>program<span class="_ _b"> </span>is<span class="_ _5"> </span>executed.<span class="_ _25"> </span>As<span class="_ _2"> </span>a<span class="_ _b"> </span>consequence,<span class="_ _5"> </span>their<span class="_ _b"> </span>initial<span class="_ _5"> </span>v<span class="_ _8"></span>alue<span class="_ _b"> </span>do<span class="_ _5"> </span>not<span class="_ _b"> </span>need<span class="_ _5"> </span>to<span class="_ _b"> </span>be</div><div class="t m0 x15 h7 y48 ff3 fs4 fc0 sc0 ls0 ws0">stored<span class="_ _2"> </span>on<span class="_ _2"> </span>executable<span class="_ _2"> </span>nor<span class="_ _2"> </span>ob<span class="_ _4"></span>ject<span class="_ _2"> </span>ﬁles.</div><div class="t m0 x1f h7 yc ff5 fs4 fc0 sc0 ls0 ws0">http://riscv-<span class="_ _4"></span>programming.org<span class="_ _2"> </span><span class="ff3">(V<span class="_ _7"></span>ersion:<span class="_ _a"> </span>Marc<span class="_ _8"></span>h<span class="_ _2"> </span>29,<span class="_ _2"> </span>2021)<span class="_ _4e"> </span>47</span></div><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",136.063,538.311,null]'><div class="d m1" style="border-style:none;position:absolute;left:195.105000px;bottom:520.976000px;width:14.723000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:141.766000px;bottom:36.395000px;width:148.940000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
