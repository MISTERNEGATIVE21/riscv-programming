<div id="pf77" class="pf w0 h0" data-page-no="77"><div class="pc pc77 w0 h0"><img class="bi x18 y1402 w2 hb3" alt="" src="bg77.png"/><div class="t m0 x18 h7 y15a ff3 fs4 fc0 sc0 ls0 ws0">8.10.<span class="_ _22"> </span>EXAMPLES</div><div class="t m0 x18 h7 y38 ff3 fs4 fc0 sc0 ls0 ws0">n<span class="_ _1"></span>um<span class="_ _1"></span>b<span class="_ _4"></span>er<span class="_ _5"> </span>of<span class="_ _d"> </span>bytes<span class="_ _5"> </span>that<span class="_ _d"> </span>m<span class="_ _1"></span>ust<span class="_ _2"> </span>b<span class="_ _4"></span>e<span class="_ _2"> </span>written<span class="_ _2"> </span>(<span class="ff5">nbyte</span>).<span class="_ _f"> </span>Also,<span class="_ _d"> </span>it<span class="_ _2"> </span>returns<span class="_ _2"> </span>the<span class="_ _d"> </span>num<span class="_ _8"></span>b<span class="_ _4"></span>er<span class="_ _2"> </span>of<span class="_ _2"> </span>bytes</div><div class="t m0 x18 h7 yed ff3 fs4 fc0 sc0 ls0 ws0">written<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>Ô¨Åle.</div><div class="t m0 xd h7 yee ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _2"> </span>following<span class="_ _5"> </span>assembly<span class="_ _2"> </span>code<span class="_ _d"> </span>sho<span class="_ _1"></span>ws<span class="_ _2"> </span>a<span class="_ _2"> </span>p<span class="_ _4"></span>ossible<span class="_ _2"> </span>implemen<span class="_ _1"></span>tation<span class="_ _2"> </span>for<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff5">write<span class="_ _d"> </span></span>rou-</div><div class="t m0 x18 h7 y116 ff3 fs4 fc0 sc0 ls0 ws0">tine.<span class="_ _1b"> </span>This<span class="_ _a"> </span>routine<span class="_ _a"> </span>receiv<span class="_ _1"></span>es<span class="_ _a"> </span>parameters<span class="_ _a"> </span><span class="ff5">fildes</span>,<span class="_ _a"> </span><span class="ff5">buf</span>,<span class="_ _3"> </span>and<span class="_ _d"> </span><span class="ff5">nbyte<span class="_ _a"> </span></span>on<span class="_ _a"> </span>registers<span class="_ _a"> </span><span class="ff5">a0</span>,<span class="_ _3"> </span><span class="ff5">a1</span>,</div><div class="t m0 x18 h7 y29d ff3 fs4 fc0 sc0 ls0 ws0">and <span class="ff5">a2</span>,<span class="_ _2"> </span>respectively<span class="_ _2c"></span>.<span class="_ _c"> </span>These<span class="_ _5"> </span>parameters are<span class="_ _5"> </span>the<span class="_ _5"> </span>same<span class="_ _5"> </span>parameters<span class="_ _5"> </span>that<span class="_ _5"> </span>must b<span class="_ _4"></span>e passed</div><div class="t m0 x18 h7 y49d ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _2"> </span>the<span class="_ _5"> </span>syscall<span class="_ _2"> </span>and<span class="_ _2"> </span>are<span class="_ _2"> </span>already<span class="_ _2"> </span>placed<span class="_ _2"> </span>on<span class="_ _2"> </span>the<span class="_ _5"> </span>correct<span class="_ _2"> </span>registers,<span class="_ _2"> </span>hence,<span class="_ _2"> </span>there<span class="_ _2"> </span>is<span class="_ _2"> </span>no<span class="_ _2"> </span>need</div><div class="t m0 x18 h7 y49e ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _2"> </span>adjust<span class="_ _2"> </span>the<span class="_ _2"> </span>parameters<span class="_ _2"> </span>when<span class="_ _2"> </span>in<span class="_ _1"></span>v<span class="_ _1"></span>oking<span class="_ _2"> </span>the<span class="_ _2"> </span>system<span class="_ _2"> </span>call<span class="_ _2"> </span>on<span class="_ _2"> </span>line<span class="_ _2"> </span>5.</div><div class="t m0 x112 h8 yf76 ff24 fs12 fc0 sc0 ls0 ws0">1<span class="_ _1f"> </span><span class="ff5 fs4">write:</span></div><div class="t m0 x112 h8 yf77 ff24 fs12 fc0 sc0 ls0 ws0">2<span class="_ _36"> </span><span class="ff5 fs4">addi<span class="_ _11"> </span>sp,<span class="_ _e"> </span>sp,<span class="_ _e"> </span>-16<span class="_ _85"> </span>#<span class="_ _e"> </span>Allocates<span class="_ _11"> </span>the<span class="_ _e"> </span>stack<span class="_ _e"> </span>frame</span></div><div class="t m0 x112 h8 yf78 ff24 fs12 fc0 sc0 ls0 ws0">3<span class="_ _36"> </span><span class="ff5 fs4">sw<span class="_ _3f"> </span>ra,<span class="_ _11"> </span>12(sp)<span class="_ _3f"> </span>#<span class="_ _e"> </span>Saves<span class="_ _e"> </span>the<span class="_ _e"> </span>return<span class="_ _11"> </span>address</span></div><div class="t m0 x112 h8 yf79 ff24 fs12 fc0 sc0 ls0 ws0">4<span class="_ _36"> </span><span class="ff5 fs4">li<span class="_ _3f"> </span>a7,<span class="_ _11"> </span>64<span class="_ _c4"> </span>#<span class="_ _e"> </span>Sets<span class="_ _e"> </span>the<span class="_ _e"> </span>syscall<span class="_ _11"> </span>code<span class="_ _e"> </span>(64<span class="_ _e"> </span>=<span class="_ _e"> </span>write)</span></div><div class="t m0 x112 h8 yf7a ff24 fs12 fc0 sc0 ls0 ws0">5<span class="_ _36"> </span><span class="ff5 fs4">ecall<span class="_ _93"> </span>#<span class="_ _11"> </span>Invokes<span class="_ _e"> </span>the<span class="_ _e"> </span>operating<span class="_ _e"> </span>system</span></div><div class="t m0 x112 h8 y1403 ff24 fs12 fc0 sc0 ls0 ws0">6<span class="_ _36"> </span><span class="ff5 fs4">lw<span class="_ _3f"> </span>ra,<span class="_ _11"> </span>12(sp)<span class="_ _3f"> </span>#<span class="_ _e"> </span>Restores<span class="_ _e"> </span>the<span class="_ _e"> </span>return<span class="_ _11"> </span>address</span></div><div class="t m0 x112 h8 y1404 ff24 fs12 fc0 sc0 ls0 ws0">7<span class="_ _36"> </span><span class="ff5 fs4">addi<span class="_ _11"> </span>sp,<span class="_ _e"> </span>sp,<span class="_ _e"> </span>16<span class="_ _3f"> </span>#<span class="_ _e"> </span>Deallocates<span class="_ _11"> </span>the<span class="_ _e"> </span>stack<span class="_ _e"> </span>frame</span></div><div class="t m0 x112 h8 y1405 ff24 fs12 fc0 sc0 ls0 ws0">8<span class="_ _36"> </span><span class="ff5 fs4">ret<span class="_ _8f"> </span>#<span class="_ _11"> </span>Returns</span></div><div class="t m0 x32 h7 yc ff5 fs4 fc0 sc0 ls0 ws0">http://riscv-<span class="_ _4"></span>programming.org<span class="_ _2"> </span><span class="ff3">(V<span class="_ _7"></span>ersion:<span class="_ _3"> </span>August<span class="_ _2"> </span>26,<span class="_ _d"> </span>2021)<span class="_ _62"> </span>105</span></div><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:139.954000px;bottom:36.395000px;width:148.940000px;height:13.948000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
