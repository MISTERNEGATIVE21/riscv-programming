<div id="pf64" class="pf w0 h0" data-page-no="64"><div class="pc pc64 w0 h0"><img class="bi x15 y4ff w1c h9e" alt="" src="bg64.png"/><div class="t m0 x15 hc y10da ff7 fs8 fc0 sc0 ls0 ws0">Chapter<span class="_ _19"> </span>8</div><div class="t m0 x15 h9 y10db ff7 fs5 fc0 sc0 ls0 ws0">Implemen<span class="_ _7"></span>ting<span class="_ _f"> </span>routines</div><div class="t m0 x15 hd y10dc ff7 fs3 fc0 sc0 ls0 ws0">8.1<span class="_ _32"> </span>The<span class="_ _31"> </span>program<span class="_ _31"> </span>memory<span class="_ _16"> </span>la<span class="_ _8"></span>y<span class="_ _8"></span>out</div><div class="t m0 x15 h7 y10dd ff3 fs4 fc0 sc0 ls0 ws0">A<span class="_ _25"> </span><span class="ff6">stored-program<span class="_ _25"> </span></span>computer<span class="_ _25"> </span>architecture<span class="_ _25"> </span>is<span class="_ _25"> </span>a<span class="_ _25"> </span>computer<span class="_ _25"> </span>architecture<span class="_ _25"> </span>that<span class="_ _25"> </span>stores</div><div class="t m0 x15 h7 y10de ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>oth<span class="_ _3"> </span>data<span class="_ _3"> </span>and<span class="_ _a"> </span>co<span class="_ _4"></span>de<span class="_ _3"> </span>on<span class="_ _a"> </span>memory<span class="_ _7"></span>.<span class="_ _0"> </span>A<span class="_ _a"> </span><span class="ff6">V<span class="_ _7"></span>on<span class="_ _25"> </span>Neumann<span class="_ _31"> </span>arc<span class="_ _8"></span>hitecture<span class="_ _a"> </span><span class="ff3">is<span class="_ _a"> </span>a<span class="_ _3"> </span>computer</span></span></div><div class="t m0 x15 h7 y10df ff3 fs4 fc0 sc0 ls0 ws0">arc<span class="_ _1"></span>hitecture<span class="_ _5"> </span>that<span class="_ _2"> </span>stores<span class="_ _5"> </span>b<span class="_ _4"></span>oth<span class="_ _5"> </span>the<span class="_ _2"> </span>data<span class="_ _5"> </span>and<span class="_ _2"> </span>the<span class="_ _2"> </span>code<span class="_ _2"> </span>at<span class="_ _2"> </span>the<span class="_ _5"> </span>same<span class="_ _2"> </span>address<span class="_ _5"> </span>space.<span class="_ _a"> </span>Most</div><div class="t m0 x15 h7 y10e0 ff3 fs4 fc0 sc0 ls0 ws0">mo<span class="_ _4"></span>dern<span class="_ _5"> </span>computer<span class="_ _2"> </span>architectures<span class="_ _5"> </span>are<span class="_ _2"> </span>V<span class="_ _7"></span>on<span class="_ _2"> </span>Neumann<span class="_ _2"> </span>architectures.</div><div class="t m0 xd h7 y10e1 ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _b"> </span>8.1<span class="_ _b"> </span>shows<span class="_ _b"> </span>a<span class="_ _b"> </span>common<span class="_ _b"> </span>wa<span class="_ _8"></span>y<span class="_ _3"> </span>of<span class="_ _b"> </span>organizing<span class="_ _b"> </span>programs<span class="_ _3"> </span>on<span class="_ _b"> </span>the<span class="_ _b"> </span>memory<span class="_ _b"> </span>of<span class="_ _3"> </span>V<span class="_ _7"></span>on</div><div class="t m0 x15 h7 y10e2 ff3 fs4 fc0 sc0 ls0 ws0">Neumann<span class="_ _3"> </span>architectures.<span class="_ _83"> </span>The<span class="_ _3"> </span><span class="ff6">co<span class="_ _4"></span>de<span class="_ _25"> </span>space<span class="_ _25"> </span>is<span class="_ _9"> </span>a<span class="_ _9"> </span>memory<span class="_ _25"> </span>space<span class="_ _9"> </span>that<span class="_ _25"> </span>stores<span class="_ _9"> </span>the</span></div><div class="t m0 x15 h7 y10e3 ff6 fs4 fc0 sc0 ls0 ws0">program<span class="_ _b"> </span>code <span class="ff3">and<span class="_ _2"> </span>is<span class="_ _5"> </span>usually<span class="_ _2"> </span>placed<span class="_ _2"> </span>ﬁrst,<span class="_ _5"> </span>in<span class="_ _2"> </span>the<span class="_ _5"> </span>low<span class="_ _8"></span>est<span class="_ _2"> </span>addresses.<span class="_ _a"> </span>The<span class="_ _5"> </span><span class="ff6">static<span class="_ _b"> </span>data</span></span></div><div class="t m0 x15 h7 y10e4 ff6 fs4 fc0 sc0 ls0 ws0">space<span class="_ _a"> </span>is<span class="_ _25"> </span>a<span class="_ _25"> </span>memory<span class="_ _25"> </span>space<span class="_ _25"> </span>that<span class="_ _a"> </span>stores<span class="_ _25"> </span>the<span class="_ _25"> </span>program<span class="_ _25"> </span>static<span class="_ _25"> </span>data<span class="_ _3"> </span><span class="ff3">(<span class="ff8">e.g.</span>,<span class="_ _3"> </span>global</span></div><div class="t m0 x15 h7 y10e5 ff3 fs4 fc0 sc0 ls0 ws0">v<span class="_ _8"></span>ariables)<span class="_ _25"> </span>and<span class="_ _9"> </span>is<span class="_ _25"> </span>placed<span class="_ _9"> </span>after<span class="_ _25"> </span>the<span class="_ _9"> </span>co<span class="_ _4"></span>de.<span class="_ _2b"> </span>The<span class="_ _25"> </span><span class="ff6">heap<span class="_ _12"> </span>space<span class="_ _31"> </span>is<span class="_ _16"> </span>a<span class="_ _16"> </span>memory<span class="_ _16"> </span>space</span></div><div class="t m0 x15 h7 y10e6 ff6 fs4 fc0 sc0 ls0 ws0">managed<span class="_ _25"> </span>b<span class="_ _1"></span>y<span class="_ _25"> </span>the<span class="_ _25"> </span>memory<span class="_ _25"> </span>allo<span class="_ _4"></span>cation<span class="_ _25"> </span>library</div><div class="t m0 xe9 h11 y10e7 ffc fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc h7 y10e6 ff3 fs4 fc0 sc0 ls0 ws0">and<span class="_ _3"> </span>is<span class="_ _3"> </span>allocated<span class="_ _3"> </span>after<span class="_ _3"> </span>the<span class="_ _3"> </span>static</div><div class="t m0 x15 h7 y10e8 ff3 fs4 fc0 sc0 ls0 ws0">data.<span class="_ _2b"> </span>The<span class="_ _25"> </span>heap<span class="_ _9"> </span>starts<span class="_ _25"> </span>small<span class="_ _9"> </span>and,<span class="_ _31"> </span>whenev<span class="_ _1"></span>er<span class="_ _25"> </span>the<span class="_ _9"> </span>memory<span class="_ _25"> </span>allo<span class="_ _4"></span>cation<span class="_ _25"> </span>library<span class="_ _25"> </span>needs</div><div class="t m0 x15 h7 y10e9 ff3 fs4 fc0 sc0 ls0 ws0">more<span class="_ _2"> </span>space,<span class="_ _b"> </span>it<span class="_ _5"> </span>inv<span class="_ _8"></span>okes<span class="_ _2"> </span>the<span class="_ _2"> </span>op<span class="_ _4"></span>erating<span class="_ _2"> </span>system<span class="_ _2"> </span>to<span class="_ _2"> </span>grow<span class="_ _2"> </span>the<span class="_ _2"> </span>heap<span class="_ _b"> </span>area,<span class="_ _5"> </span>which<span class="_ _2"> </span>do<span class="_ _4"></span>es<span class="_ _2"> </span>it<span class="_ _2"> </span>by</div><div class="t m0 x15 h7 y10ea ff3 fs4 fc0 sc0 ls0 ws0">increasing<span class="_ _b"> </span>the<span class="_ _3"> </span>“program<span class="_ _b"> </span>break”<span class="_ _3"> </span>address</div><div class="t m0 xa2 h11 y10eb ffc fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xd0 h7 y10ea ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _26"> </span>Finally<span class="_ _7"></span>,<span class="_ _b"> </span>the<span class="_ _3"> </span><span class="ff6">stac<span class="_ _8"></span>k<span class="_ _25"> </span>space<span class="_ _a"> </span>is<span class="_ _a"> </span>a<span class="_ _25"> </span>memory</span></div><div class="t m0 x15 h7 y10ec ff6 fs4 fc0 sc0 ls0 ws0">space<span class="_ _31"> </span>that<span class="_ _16"> </span>stores<span class="_ _16"> </span>the<span class="_ _31"> </span>program<span class="_ _16"> </span>stack<span class="_ _a"> </span><span class="ff3">and<span class="_ _25"> </span>is<span class="_ _25"> </span>usually<span class="_ _9"> </span>placed<span class="_ _25"> </span>at<span class="_ _25"> </span>the<span class="_ _25"> </span>end<span class="_ _9"> </span>(high</span></div><div class="t m0 x15 h7 y10ed ff3 fs4 fc0 sc0 ls0 ws0">addresses)<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>memory<span class="_ _7"></span>.</div><div class="c xeb y10ee w1d h9f"><div class="t m0 x0 ha0 y10ef ff98 fs38 fc0 sc0 ls0 ws0">0x0000</div><div class="t m2 xcd ha1 y10f0 ff99 fs38 fc0 sc0 ls0 ws0">Addresses</div><div class="t m0 x108 ha2 y10f1 ff98 fs39 fc0 sc0 ls0 ws0">Code</div><div class="t m0 x131 ha2 y10f2 ff98 fs39 fc0 sc0 ls0 ws0">Static Data</div><div class="t m0 x108 ha2 y10f3 ff98 fs39 fc0 sc0 ls0 ws0">Stack</div><div class="t m0 xf7 ha1 y10f4 ff99 fs38 fc0 sc0 ls0 ws0">Main Memory</div><div class="t m0 x1a ha0 y10f5 ff98 fs38 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>op of </div><div class="t m0 x1a ha0 y10f6 ff98 fs38 fc0 sc0 ls0 ws0">the stack</div><div class="t m0 x108 ha2 y10f7 ff98 fs39 fc0 sc0 ls0 ws0">Heap</div><div class="t m0 x131 ha2 y10f8 ff98 fs39 fc0 sc0 ls0 ws0">Free space</div><div class="t m0 x1a ha0 y10f9 ff98 fs38 fc0 sc0 ls0 ws0">Program </div><div class="t m0 x1a ha0 y10fa ff98 fs38 fc0 sc0 ls0 ws0">break</div></div><div class="t m0 x18 h7 y10fb ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _2"> </span>8.1:<span class="_ _3"> </span>Common<span class="_ _2"> </span>program<span class="_ _2"> </span>memory<span class="_ _2"> </span>lay<span class="_ _8"></span>out.</div><div class="t m0 x15 hd y10fc ff7 fs3 fc0 sc0 ls0 ws0">8.2<span class="_ _32"> </span>The<span class="_ _31"> </span>program<span class="_ _31"> </span>stac<span class="_ _1"></span>k</div><div class="t m0 x15 h7 y10fd ff3 fs4 fc0 sc0 ls0 ws0">An<span class="_ _3"> </span><span class="ff6">active<span class="_ _25"> </span>routine<span class="_ _9"> </span>is<span class="_ _9"> </span>a<span class="_ _9"> </span>routine<span class="_ _9"> </span>that<span class="_ _9"> </span>was<span class="_ _25"> </span>in<span class="_ _1"></span>v<span class="_ _8"></span>oked<span class="_ _25"> </span>but<span class="_ _9"> </span>did<span class="_ _9"> </span>not<span class="_ _9"> </span>return<span class="_ _9"> </span>yet<span class="ff3">.</span></span></div><div class="t m0 x15 h7 y10fe ff3 fs4 fc0 sc0 ls0 ws0">Notice<span class="_ _b"> </span>that<span class="_ _2"> </span>there<span class="_ _b"> </span>ma<span class="_ _8"></span>y<span class="_ _b"> </span>be<span class="_ _b"> </span>m<span class="_ _1"></span>ultiple<span class="_ _b"> </span>activ<span class="_ _8"></span>e<span class="_ _b"> </span>routines<span class="_ _2"> </span>at<span class="_ _b"> </span>a<span class="_ _2"> </span>given<span class="_ _2"> </span>p<span class="_ _4"></span>oin<span class="_ _8"></span>t<span class="_ _b"> </span>of<span class="_ _b"> </span>the<span class="_ _2"> </span>execution.</div><div class="t m0 x3d h1e y10ff ff12 fse fc0 sc0 ls0 ws0">1</div><div class="t m0 xd h1f y802 ff13 fsf fc0 sc0 ls0 ws0">The<span class="_ _2"> </span>memory<span class="_ _2"> </span>allocation<span class="_ _2"> </span>library<span class="_ _2"> </span>allows<span class="_ _2"> </span>the<span class="_ _2"> </span>program<span class="_ _2"> </span>to<span class="_ _2"> </span>dynamically<span class="_ _2"> </span>allocate<span class="_ _2"> </span>(and<span class="_ _2"> </span>free)<span class="_ _2"> </span>data<span class="_ _2"> </span>on</div><div class="t m0 x15 h1f y5f4 ff13 fsf fc0 sc0 ls0 ws0">the<span class="_ _2"> </span>heap.<span class="_ _12"> </span>Data<span class="_ _b"> </span>allocated<span class="_ _2"> </span>using<span class="_ _b"> </span>the<span class="_ _2"> </span><span class="ff28">malloc<span class="_ _b"> </span></span>routine,<span class="_ _b"> </span>for<span class="_ _2"> </span>example,<span class="_ _b"> </span>is<span class="_ _2"> </span>allo<span class="_ _4"></span>cated<span class="_ _2"> </span>into<span class="_ _2"> </span>the<span class="_ _b"> </span>heap.<span class="_ _16"> </span>The</div><div class="t m0 x15 h1f y537 ff13 fsf fc0 sc0 ls0 ws0">memory<span class="_ _2"> </span>allo<span class="_ _4"></span>cation<span class="_ _2"> </span>library<span class="_ _2"> </span>is<span class="_ _2"> </span>resp<span class="_ _4"></span>onsible<span class="_ _2"> </span>for<span class="_ _2"> </span>keeping<span class="_ _2"> </span>track<span class="_ _5"> </span>of<span class="_ _b"> </span>whic<span class="_ _8"></span>h<span class="_ _2"> </span>addresses<span class="_ _b"> </span>within<span class="_ _2"> </span>the<span class="_ _2"> </span>heap<span class="_ _2"> </span>are</div><div class="t m0 x15 h1f y538 ff13 fsf fc0 sc0 ls0 ws0">free<span class="_ _37"> </span>or<span class="_ _37"> </span>allo<span class="_ _4"></span>cated.</div><div class="t m0 x3d h1e y180 ff12 fse fc0 sc0 ls0 ws0">2</div><div class="t m0 xd h1f y48 ff13 fsf fc0 sc0 ls0 ws0">The<span class="_ _37"> </span>program<span class="_ _37"> </span>break<span class="_ _37"> </span>deﬁnes<span class="_ _37"> </span>the<span class="_ _5"> </span>end<span class="_ _37"> </span>of<span class="_ _37"> </span>the<span class="_ _37"> </span>heap.</div><div class="t m0 x1c h7 yc ff3 fs4 fc0 sc0 ls0 ws0">87</div><a class="l" href="#pf64" data-dest-detail='[100,"XYZ",90.709,377.576,null]'><div class="d m1" style="border-style:none;position:absolute;left:136.690000px;bottom:503.554000px;width:14.722000px;height:10.849000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf64" data-dest-detail='[100,"XYZ",105.952,118.229,null]'><div class="d m1" style="border-style:none;position:absolute;left:309.144000px;bottom:443.779000px;width:6.462000px;height:12.039000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf64" data-dest-detail='[100,"XYZ",105.952,80.331,null]'><div class="d m1" style="border-style:none;position:absolute;left:265.587000px;bottom:407.913000px;width:6.462000px;height:12.039000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
