<div id="pf65" class="pf w0 h0" data-page-no="65"><div class="pc pc65 w0 h0"><img class="bi x18 y514 w1c h9e" alt="" src="bg65.png"/><div class="t m0 x18 hc y10ec ff6 fs8 fc0 sc0 ls0 ws0">Chapter<span class="_ _22"> </span>8</div><div class="t m0 x18 h9 y10ed ff6 fs5 fc0 sc0 ls0 ws0">Implemen<span class="_ _7"></span>ting<span class="_ _18"> </span>routines</div><div class="t m0 x18 hd y10ee ff6 fs3 fc0 sc0 ls0 ws0">8.1<span class="_ _36"> </span>The<span class="_ _e"> </span>program<span class="_ _e"> </span>memory<span class="_ _1f"> </span>la<span class="_ _8"></span>y<span class="_ _8"></span>out</div><div class="t m0 x18 h7 y10ef ff3 fs4 fc0 sc0 ls0 ws0">A<span class="_ _f"> </span><span class="ff7">stored-program<span class="_ _f"> </span></span>computer<span class="_ _f"> </span>architecture<span class="_ _c"> </span>is<span class="_ _11"> </span>a<span class="_ _f"> </span>computer<span class="_ _f"> </span>architecture<span class="_ _c"> </span>that<span class="_ _f"> </span>stores</div><div class="t m0 x18 h7 y10f0 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>oth<span class="_ _3"> </span>data<span class="_ _3"> </span>and<span class="_ _c"> </span>co<span class="_ _4"></span>de<span class="_ _3"> </span>on<span class="_ _3"> </span>memory<span class="_ _7"></span>.<span class="_ _22"> </span>A<span class="_ _c"> </span><span class="ff7">V<span class="_ _2c"></span>on<span class="_ _11"> </span>Neumann<span class="_ _11"> </span>architecture<span class="_ _3"> </span><span class="ff3">is<span class="_ _3"> </span>a<span class="_ _c"> </span>computer</span></span></div><div class="t m0 x18 h7 y10f1 ff3 fs4 fc0 sc0 ls0 ws0">arc<span class="_ _1"></span>hitecture<span class="_ _5"> </span>that<span class="_ _2"> </span>stores<span class="_ _5"> </span>b<span class="_ _4"></span>oth<span class="_ _5"> </span>the<span class="_ _2"> </span>data<span class="_ _5"> </span>and<span class="_ _2"> </span>the<span class="_ _2"> </span>code<span class="_ _2"> </span>at<span class="_ _2"> </span>the<span class="_ _5"> </span>same<span class="_ _2"> </span>address<span class="_ _5"> </span>space.<span class="_ _c"> </span>Most</div><div class="t m0 x18 h7 y10f2 ff3 fs4 fc0 sc0 ls0 ws0">mo<span class="_ _4"></span>dern<span class="_ _5"> </span>computer<span class="_ _2"> </span>architectures<span class="_ _5"> </span>are<span class="_ _2"> </span>V<span class="_ _7"></span>on<span class="_ _2"> </span>Neumann<span class="_ _2"> </span>architectures.</div><div class="t m0 xd h7 y10f3 ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _a"> </span>8.1<span class="_ _a"> </span>shows<span class="_ _d"> </span>a<span class="_ _a"> </span>common<span class="_ _a"> </span>wa<span class="_ _8"></span>y<span class="_ _a"> </span>of<span class="_ _a"> </span>organizing<span class="_ _3"> </span>programs<span class="_ _a"> </span>on<span class="_ _a"> </span>the<span class="_ _a"> </span>memory<span class="_ _a"> </span>of<span class="_ _a"> </span>V<span class="_ _7"></span>on</div><div class="t m0 x18 h7 y10f4 ff3 fs4 fc0 sc0 ls0 ws0">Neumann<span class="_ _3"> </span>architectures.<span class="_ _b"> </span>The<span class="_ _3"> </span><span class="ff7">co<span class="_ _4"></span>de<span class="_ _c"> </span>space<span class="_ _11"> </span>is<span class="_ _f"> </span>a<span class="_ _11"> </span>memory<span class="_ _f"> </span>space<span class="_ _f"> </span>that<span class="_ _11"> </span>stores<span class="_ _f"> </span>the</span></div><div class="t m0 x18 h7 y10f5 ff7 fs4 fc0 sc0 ls0 ws0">program<span class="_ _d"> </span>co<span class="_ _4"></span>de <span class="ff3">and<span class="_ _5"> </span>is<span class="_ _5"> </span>usually<span class="_ _2"> </span>placed<span class="_ _2"> </span>ﬁrst,<span class="_ _5"> </span>in<span class="_ _2"> </span>the<span class="_ _5"> </span>low<span class="_ _8"></span>est<span class="_ _2"> </span>addresses.<span class="_ _c"> </span>The<span class="_ _5"> </span><span class="ff7">static<span class="_ _d"> </span>data</span></span></div><div class="t m0 x18 h7 y10f6 ff7 fs4 fc0 sc0 ls0 ws0">space<span class="_ _c"> </span>is<span class="_ _f"> </span>a<span class="_ _f"> </span>memory<span class="_ _f"> </span>space<span class="_ _c"> </span>that<span class="_ _f"> </span>stores<span class="_ _f"> </span>the<span class="_ _f"> </span>program<span class="_ _c"> </span>static<span class="_ _f"> </span>data<span class="_ _3"> </span><span class="ff3">(<span class="ff8">e.g.</span>,<span class="_ _3"> </span>global</span></div><div class="t m0 x18 h7 y10f7 ff3 fs4 fc0 sc0 ls0 ws0">v<span class="_ _8"></span>ariables)<span class="_ _f"> </span>and<span class="_ _11"> </span>is<span class="_ _f"> </span>placed<span class="_ _f"> </span>after<span class="_ _11"> </span>the<span class="_ _f"> </span>co<span class="_ _4"></span>de.<span class="_ _31"> </span>The<span class="_ _11"> </span><span class="ff7">heap<span class="_ _1f"> </span>space<span class="_ _1f"> </span>is<span class="_ _1f"> </span>a<span class="_ _1f"> </span>memory<span class="_ _1f"> </span>space</span></div><div class="t m0 x18 h7 y10f8 ff7 fs4 fc0 sc0 ls0 ws0">managed<span class="_ _f"> </span>b<span class="_ _1"></span>y<span class="_ _f"> </span>the<span class="_ _f"> </span>memory<span class="_ _f"> </span>allo<span class="_ _4"></span>cation<span class="_ _c"> </span>library</div><div class="t m0 xea h11 y10f9 ffc fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc h7 y10f8 ff3 fs4 fc0 sc0 ls0 ws0">and<span class="_ _3"> </span>is<span class="_ _a"> </span>allo<span class="_ _4"></span>cated<span class="_ _3"> </span>after<span class="_ _3"> </span>the<span class="_ _a"> </span>static</div><div class="t m0 x18 h7 y10fa ff3 fs4 fc0 sc0 ls0 ws0">data.<span class="_ _31"> </span>The<span class="_ _f"> </span>heap<span class="_ _11"> </span>starts<span class="_ _f"> </span>small<span class="_ _f"> </span>and,<span class="_ _e"> </span>whenever<span class="_ _c"> </span>the<span class="_ _11"> </span>memory<span class="_ _f"> </span>allo<span class="_ _4"></span>cation<span class="_ _f"> </span>library<span class="_ _f"> </span>needs</div><div class="t m0 x18 h7 y10fb ff3 fs4 fc0 sc0 ls0 ws0">more<span class="_ _2"> </span>space,<span class="_ _d"> </span>it<span class="_ _2"> </span>inv<span class="_ _8"></span>okes<span class="_ _5"> </span>the<span class="_ _d"> </span>op<span class="_ _4"></span>erating<span class="_ _5"> </span>system<span class="_ _d"> </span>to<span class="_ _2"> </span>grow<span class="_ _2"> </span>the<span class="_ _2"> </span>heap<span class="_ _2"> </span>area,<span class="_ _d"> </span>which<span class="_ _5"> </span>do<span class="_ _4"></span>es<span class="_ _2"> </span>it<span class="_ _2"> </span>by</div><div class="t m0 x18 h7 y10fc ff3 fs4 fc0 sc0 ls0 ws0">increasing<span class="_ _a"> </span>the<span class="_ _a"> </span>“program<span class="_ _3"> </span>break”<span class="_ _a"> </span>address</div><div class="t m0 xa3 h11 y10fd ffc fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xd0 h7 y10fc ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _2d"> </span>Finally<span class="_ _7"></span>,<span class="_ _a"> </span>the<span class="_ _3"> </span><span class="ff7">stac<span class="_ _1"></span>k<span class="_ _c"> </span>space<span class="_ _c"> </span>is<span class="_ _c"> </span>a<span class="_ _f"> </span>memory</span></div><div class="t m0 x18 h7 y10fe ff7 fs4 fc0 sc0 ls0 ws0">space<span class="_ _e"> </span>that<span class="_ _1f"> </span>stores<span class="_ _1f"> </span>the<span class="_ _e"> </span>program<span class="_ _1f"> </span>stack<span class="_ _c"> </span><span class="ff3">and<span class="_ _f"> </span>is<span class="_ _f"> </span>usually<span class="_ _f"> </span>placed<span class="_ _11"> </span>at<span class="_ _f"> </span>the<span class="_ _f"> </span>end<span class="_ _f"> </span>(high</span></div><div class="t m0 x18 h7 y10ff ff3 fs4 fc0 sc0 ls0 ws0">addresses)<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>memory<span class="_ _7"></span>.</div><div class="c xec y1100 w1d h9f"><div class="t m0 x0 ha0 y1101 ff98 fs38 fc0 sc0 ls0 ws0">0x0000</div><div class="t m2 xcd ha1 y1102 ff99 fs38 fc0 sc0 ls0 ws0">Addresses</div><div class="t m0 x10a ha2 y1103 ff98 fs39 fc0 sc0 ls0 ws0">Code</div><div class="t m0 x131 ha2 y1104 ff98 fs39 fc0 sc0 ls0 ws0">Static Data</div><div class="t m0 x10a ha2 y1105 ff98 fs39 fc0 sc0 ls0 ws0">Stack</div><div class="t m0 xf8 ha1 y1106 ff99 fs38 fc0 sc0 ls0 ws0">Main Memory</div><div class="t m0 x16 ha0 y1107 ff98 fs38 fc0 sc0 ls0 ws0">T<span class="_ _7"></span>op of </div><div class="t m0 x16 ha0 y1108 ff98 fs38 fc0 sc0 ls0 ws0">the stack</div><div class="t m0 x10a ha2 y1109 ff98 fs39 fc0 sc0 ls0 ws0">Heap</div><div class="t m0 x131 ha2 y110a ff98 fs39 fc0 sc0 ls0 ws0">Free space</div><div class="t m0 x16 ha0 y110b ff98 fs38 fc0 sc0 ls0 ws0">Program </div><div class="t m0 x16 ha0 y110c ff98 fs38 fc0 sc0 ls0 ws0">break</div></div><div class="t m0 x17 h7 y110d ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _2"> </span>8.1:<span class="_ _3"> </span>Common<span class="_ _2"> </span>program<span class="_ _2"> </span>memory<span class="_ _2"> </span>lay<span class="_ _8"></span>out.</div><div class="t m0 x18 hd y110e ff6 fs3 fc0 sc0 ls0 ws0">8.2<span class="_ _36"> </span>The<span class="_ _e"> </span>program<span class="_ _e"> </span>stac<span class="_ _1"></span>k</div><div class="t m0 x18 h7 y110f ff3 fs4 fc0 sc0 ls0 ws0">An<span class="_ _3"> </span><span class="ff7">active<span class="_ _f"> </span>routine<span class="_ _11"> </span>is<span class="_ _11"> </span>a<span class="_ _f"> </span>routine<span class="_ _11"> </span>that<span class="_ _11"> </span>was<span class="_ _f"> </span>in<span class="_ _1"></span>v<span class="_ _8"></span>oked<span class="_ _f"> </span>but<span class="_ _11"> </span>did<span class="_ _11"> </span>not<span class="_ _11"> </span>return<span class="_ _f"> </span>yet<span class="ff3">.</span></span></div><div class="t m0 x18 h7 y1110 ff3 fs4 fc0 sc0 ls0 ws0">Notice<span class="_ _d"> </span>that<span class="_ _d"> </span>there<span class="_ _d"> </span>ma<span class="_ _1"></span>y<span class="_ _d"> </span>b<span class="_ _4"></span>e<span class="_ _2"> </span>multiple<span class="_ _2"> </span>active<span class="_ _2"> </span>routines<span class="_ _d"> </span>at<span class="_ _d"> </span>a<span class="_ _d"> </span>given<span class="_ _2"> </span>p<span class="_ _4"></span>oin<span class="_ _8"></span>t<span class="_ _d"> </span>of<span class="_ _d"> </span>the<span class="_ _d"> </span>execution.</div><div class="t m0 x3e h1e y1111 ff12 fse fc0 sc0 ls0 ws0">1</div><div class="t m0 xd h1f y817 ff13 fsf fc0 sc0 ls0 ws0">The<span class="_ _2"> </span>memory<span class="_ _2"> </span>allocation<span class="_ _2"> </span>library<span class="_ _2"> </span>allows<span class="_ _2"> </span>the<span class="_ _2"> </span>program<span class="_ _2"> </span>to<span class="_ _2"> </span>dynamically<span class="_ _2"> </span>allocate<span class="_ _2"> </span>(and<span class="_ _2"> </span>free)<span class="_ _2"> </span>data<span class="_ _2"> </span>on</div><div class="t m0 x18 h1f y609 ff13 fsf fc0 sc0 ls0 ws0">the<span class="_ _2"> </span>heap.<span class="_ _1b"> </span>Data<span class="_ _d"> </span>allocated<span class="_ _d"> </span>using<span class="_ _d"> </span>the<span class="_ _d"> </span><span class="ff28">malloc<span class="_ _d"> </span></span>routine,<span class="_ _d"> </span>for<span class="_ _d"> </span>example,<span class="_ _d"> </span>is<span class="_ _d"> </span>allo<span class="_ _4"></span>cated<span class="_ _2"> </span>into<span class="_ _2"> </span>the<span class="_ _d"> </span>heap.<span class="_ _1b"> </span>The</div><div class="t m0 x18 h1f y54c ff13 fsf fc0 sc0 ls0 ws0">memory<span class="_ _2"> </span>allo<span class="_ _4"></span>cation<span class="_ _2"> </span>library<span class="_ _2"> </span>is<span class="_ _2"> </span>resp<span class="_ _4"></span>onsible<span class="_ _2"> </span>for<span class="_ _2"> </span>keeping<span class="_ _2"> </span>track<span class="_ _5"> </span>of<span class="_ _d"> </span>which<span class="_ _5"> </span>addresses<span class="_ _d"> </span>within<span class="_ _2"> </span>the<span class="_ _2"> </span>heap<span class="_ _d"> </span>are</div><div class="t m0 x18 h1f y54d ff13 fsf fc0 sc0 ls0 ws0">free<span class="_ _38"> </span>or<span class="_ _38"> </span>allo<span class="_ _4"></span>cated.</div><div class="t m0 x3e h1e y193 ff12 fse fc0 sc0 ls0 ws0">2</div><div class="t m0 xd h1f y61 ff13 fsf fc0 sc0 ls0 ws0">The<span class="_ _38"> </span>program<span class="_ _38"> </span>break<span class="_ _38"> </span>deﬁnes<span class="_ _5"> </span>the<span class="_ _38"> </span>end<span class="_ _38"> </span>of<span class="_ _38"> </span>the<span class="_ _5"> </span>heap.</div><div class="t m0 x1b h7 yc ff3 fs4 fc0 sc0 ls0 ws0">87</div><a class="l" href="#pf65" data-dest-detail='[101,"XYZ",90.709,377.576,null]'><div class="d m1" style="border-style:none;position:absolute;left:136.690000px;bottom:503.554000px;width:14.722000px;height:10.849000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf65" data-dest-detail='[101,"XYZ",105.952,118.229,null]'><div class="d m1" style="border-style:none;position:absolute;left:309.144000px;bottom:443.779000px;width:6.462000px;height:12.039000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf65" data-dest-detail='[101,"XYZ",105.952,80.331,null]'><div class="d m1" style="border-style:none;position:absolute;left:265.587000px;bottom:407.913000px;width:6.462000px;height:12.039000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
